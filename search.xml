<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Docker ç³»åˆ—&lt;ä¸€&gt; Docker å®‰è£…</title>
      <link href="/docker/introduction/"/>
      <url>/docker/introduction/</url>
      
        <content type="html"><![CDATA[<h2 id="Docker-æ˜¯ä»€ä¹ˆ"><a href="#Docker-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Docker æ˜¯ä»€ä¹ˆ"></a>Docker æ˜¯ä»€ä¹ˆ</h2><p><a href="https://github.com/moby/moby" target="_blank" rel="noopener">Github Docker</a></p><p>æˆ‘ä»¬å¸¸å¸¸è¯´ï¼Œâ€œåœ¨æˆ‘ç”µè„‘ä¸Šè·‘çš„å¥½å¥½çš„å•Šï¼æ€ä¹ˆä½ è¿™å°±ä¸è¡Œäº†ï¼Ÿâ€</p><p>ç”±äºå„å¼å„æ ·çš„ç¯å¢ƒé…ç½®ï¼Œæ€»æ˜¯èƒ½å¯¼è‡´æˆ‘ä»¬è¾›è¾›è‹¦è‹¦å†™å‡ºæ¥çš„ä»£ç ï¼Œé‡åˆ°å„ç§é—®é¢˜ã€‚</p><p>è™šæ‹Ÿæœºæ˜¯ä¸ªä¸é”™çš„è§£å†³æ–¹æ¡ˆã€‚ç„¶è€Œè™šæ‹Ÿæœºæ˜¯ä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œéœ€è¦ä¸ºå®ƒå¼€è¾ŸæŒ‡å®šçš„å†…å­˜å’Œç£ç›˜ï¼Œè¿™äº›ç³»ç»Ÿèµ„æºå¹¶ä¸ä¼šå› ä¸ºä½ çš„æœåŠ¡æ²¡æœ‰å ç”¨è€Œé‡Šæ”¾ï¼ŒåŒæ—¶ï¼Œä¹Ÿå› ä¸ºæ˜¯ä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œå¯åŠ¨å¿…ç„¶å¾ˆæ…¢ã€‚</p><p>åæ¥ linux å¼€å‘å‡ºäº† LXC(Linux Containers) æŠ€æœ¯ï¼Œæ‰€è°“çš„å†…æ ¸å®¹å™¨è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚å®ƒé€šè¿‡ linux å†…æ ¸æä¾›çš„ cgroups å’Œ namespace  ç‰¹æ€§ï¼Œèƒ½å¾ˆå¥½çš„å®ç°å®¹å™¨è™šæ‹ŸåŒ–ã€‚</p><p>é‚£ä¹ˆ cgroups å’Œ namespace åˆæ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿè¿™é‡Œå…ˆä¸è¯´ã€‚</p><p>Docker çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼ŒLXC ä½œä¸ºåº•å±‚æ¶æ„çš„ä¸€ä¸ªæ¨¡å—ï¼Œç”¨æ¥åˆ›å»ºå®¹å™¨ï¼Œç°åœ¨ç”¨çš„åˆ™æ˜¯è‡ªå·±å¼€å‘çš„ <code>libcontainer</code> ã€‚æ— è®ºæ˜¯ LXC è¿˜æ˜¯ libcontainer ï¼Œéƒ½ç¦»ä¸å¼€ cgroup å’Œ namespaceã€‚</p><p>Docker çš„ä¸»æ—¨æ˜¯ BUILDï¼ŒSHIPï¼ŒRUN ï¼Œå³æ„å»ºé•œåƒï¼Œè£…è¿›ä»“åº“ï¼Œå¯åŠ¨é•œåƒã€‚é€šå¸¸å¯¹åº”ä¸‰ä¸ªå‘½ä»¤ï¼š</p><pre class=" language-bash"><code class="language-bash">docker build docker pushdocker run</code></pre><p>Docker ç›¸æ¯”ä¼ ç»Ÿçš„è™šæœºï¼Œèƒ½ç”¨æ›´å°‘çš„<strong>èµ„æº</strong>ã€æ›´å°çš„<strong>ä½“ç§¯</strong>ã€æ›´æ–¹ä¾¿çš„<strong>æ“ä½œ</strong>ä»¥åŠæ›´å¿«çš„<strong>é€Ÿåº¦</strong>å¯åŠ¨æˆ‘ä»¬çš„æœåŠ¡ã€‚</p><h2 id="Docker-å•æœºç‰ˆå®‰è£…-Linux-ç‰ˆ"><a href="#Docker-å•æœºç‰ˆå®‰è£…-Linux-ç‰ˆ" class="headerlink" title="Docker å•æœºç‰ˆå®‰è£…(Linux ç‰ˆ)"></a>Docker å•æœºç‰ˆå®‰è£…(Linux ç‰ˆ)</h2><p>å†…æ ¸ç‰ˆæœ¬åŠç¡¬ä»¶å¹³å°(hardware-platform)</p><pre class=" language-bash"><code class="language-bash">âœ  ~ <span class="token function">uname</span> -ir4.18.0-147.5.1.el8_1.x86_64 x86_64</code></pre><p>æ“ä½œç³»ç»Ÿå‘è¡Œç‰ˆæœ¬</p><pre class=" language-bash"><code class="language-bash">âœ  ~ lsb_release -aLSB Version:    :core-4.1-amd64:core-4.1-noarchDistributor ID: CentOSDescription:    CentOS Linux release 8.1.1911 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>Release:        8.1.1911Codename:       Core</code></pre><p>Docker æä¾›ç¤¾åŒºç‰ˆå’Œ pro ç‰ˆæœ¬ï¼Œåˆ†åˆ«å«åš CE(Community Edition) å’Œ EE(Enterprise Edition)ï¼Œæˆ‘ä»¬è‚¯å®šé€‰ CEï¼Œæ¯•ç«Ÿ EE å¯æ˜¯è¦æ”¶è´¹çš„ã€‚</p><h3 id="0-å¸è½½-Docker"><a href="#0-å¸è½½-Docker" class="headerlink" title="0. å¸è½½ Docker"></a>0. å¸è½½ Docker</h3><p>å¦‚æœä¹‹å‰æ²¡æœ‰å®‰è£…è¿‡ Docker ï¼Œè¿™ä¸€æ­¥å¯ç›´æ¥å¿½ç•¥ã€‚æˆ‘ä¼šå…ˆå¸è½½ï¼Œå†é‡æ–°å®‰è£…ä¸€æ¬¡ã€‚</p><p>psï¼šå¦‚æœåªæœ‰ yum ï¼Œéœ€è¦å°†ä¸‹è¿°å‘½ä»¤çš„ dnf æ”¹æˆ yum</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å®˜æ–¹ç»™çš„åˆ é™¤æ–¹æ¡ˆ</span><span class="token function">sudo</span> dnf remove docker \                  docker-client \                  docker-client-latest \                  docker-common \                  docker-latest \                  docker-latest-logrotate \                  docker-logrotate \                  docker-ce</code></pre><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å†çœ‹ä¸‹è¿˜æœ‰æ²¡æœ‰æœªåˆ é™¤çš„ï¼š</p><pre class=" language-bash"><code class="language-bash">âœ  ~ <span class="token function">sudo</span> dnf list installed  <span class="token operator">|</span> <span class="token function">grep</span> dockerRepository epel is listed <span class="token function">more</span> than once <span class="token keyword">in</span> the configurationdocker-ce-cli.x86_64                        1:19.03.8-3.el7                                  @docker-ce-stable</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿˜æœ‰ cli (å½“ç„¶ä½ å¯ä»¥ä¸åˆ é™¤)ï¼Œè¿™é‡Œæˆ‘æŠŠå®ƒä¹Ÿåˆ æ‰ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> dnf -y remove docker-ce-cli</code></pre><p>å¦‚æœä½ æƒ³åˆ é™¤çš„ååˆ†å½»åº•ï¼Œä½ ç”šè‡³å¯ä»¥è¿™æ ·åšï¼ˆ<strong>è¯·åŠ¡å¿…ä¿è¯ä½ çŸ¥é“ä½ åœ¨å¹²ä»€ä¹ˆ</strong>ï¼‰</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># è¿™ä¼šæŠŠä½ ä¹‹å‰ä¸‹è½½çš„é•œåƒã€å®¹å™¨ã€ç½‘ç»œã€å·ç­‰ç­‰ï¼Œä¸€èµ·å¹²æ‰ï¼Œè¯·åŠ¡å¿…å°å¿ƒï¼ï¼ï¼</span><span class="token function">sudo</span> <span class="token function">rm</span> -rf /var/lib/docker<span class="token comment" spellcheck="true"># æœ‰å…³ docker çš„ä¸€äº›é…ç½®ï¼Œå¦‚ registry mirrorï¼Œ ç™»å½•ä¿¡æ¯ç­‰</span><span class="token function">sudo</span> <span class="token function">rm</span> -fr /etc/docker<span class="token function">sudo</span> <span class="token function">rm</span> -fr ~/.docker</code></pre><p>åˆ°è¿™é‡Œï¼Œ ä½ æœºå™¨ä¸Šæœ‰å…³ docker çš„ä¸œè¥¿å°±éƒ½åˆ é™¤å®Œæ¯•äº†ã€‚</p><h3 id="1-è®¾ç½®-docker-æº-éå¿…é¡»"><a href="#1-è®¾ç½®-docker-æº-éå¿…é¡»" class="headerlink" title="1. è®¾ç½® docker æº(éå¿…é¡»)"></a>1. è®¾ç½® docker æº(éå¿…é¡»)</h3><p>æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦è®¾ç½®æºï¼Œå› ä¸ºè¿™èƒ½è®©æˆ‘ä»¬å®‰è£…çš„æ›´åŠ å¿«é€Ÿã€‚</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># yum ç”¨æˆ·è¯·å®‰è£… yum-utils ï¼Œ å¯ä»¥æä¾› yum-config-manager</span><span class="token function">sudo</span> yum <span class="token function">install</span> -y yum-utils</code></pre><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ <a href="http://mirrors.aliyun.com/docker-ce/linux/centos/" target="_blank" rel="noopener">é˜¿é‡Œäº‘  docker-ce.repo</a> </p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> dnf config-manager \--add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo<span class="token comment" spellcheck="true"># yum ç”¨æˆ·è¿™æ ·æ“ä½œï¼š</span><span class="token function">sudo</span> yum-config-manager \ --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo <span class="token function">sudo</span> dnf makecache <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> yum makecache <span class="token comment" spellcheck="true"># æŸ¥çœ‹å®‰è£…çš„æº</span> dnf repolist  <span class="token comment" spellcheck="true"># æˆ–è€… </span> yum repolist</code></pre><h3 id="2-å®‰è£…-Docker"><a href="#2-å®‰è£…-Docker" class="headerlink" title="2. å®‰è£… Docker"></a>2. å®‰è£… Docker</h3><p>Docker å®˜æ–¹æä¾›äº†ä¸‰ç§å®‰è£…æ–¹å¼ï¼š</p><ul><li>é€šè¿‡ docker repo å®‰è£…(<strong>æ¨è</strong>)</li><li>ä¸‹è½½ RPM package å®‰è£…</li><li>é€šè¿‡è„šæœ¬å®‰è£…</li></ul><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ç¬¬ä¸€ç§å®‰è£…æ–¹å¼ï¼Œåä¸¤ç§è¯·å‚è€ƒ <a href="https://docs.docker.com/engine/install/centos/#install-from-a-package" target="_blank" rel="noopener">è¿™é‡Œ</a></p><hr><blockquote><p>æŸ¥çœ‹ Dokcer ç‰ˆæœ¬</p></blockquote><pre class=" language-bash"><code class="language-bash">âœ  ~ dnf list docker-ce --showduplicates <span class="token operator">|</span> <span class="token function">sort</span> -r <span class="token operator">|</span> <span class="token function">head</span> -n 3docker-ce.x86_64            3:19.03.8-3.el7                     docker-ce-stabledocker-ce.x86_64            3:19.03.7-3.el7                     docker-ce-stableâœ  ~ dnf list docker-ce-cli --showduplicates <span class="token operator">|</span> <span class="token function">sort</span> -r <span class="token operator">|</span> <span class="token function">head</span> -n 3docker-ce-cli.x86_64              1:19.03.8-3.el7               docker-ce-stabledocker-ce-cli.x86_64              1:19.03.7-3.el7               docker-ce-stable</code></pre><hr><blockquote><p>å®‰è£… Docker çš„æŒ‡å®šç‰ˆæœ¬</p></blockquote><p>æˆ‘ä»¬å…ˆæŒ‰ç…§å®˜ç½‘ç»™çš„æ­¥éª¤èµ°ä¸€éï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># è¿™é‡Œæ³¨æ„ä¸‹ docker ce å’Œ cli çš„ç‰ˆæœ¬ï¼Œå»å†’å· : å’Œä¸­åˆ’çº¿ - ä¹‹é—´çš„éƒ¨åˆ†ï¼Œ æˆ‘è¿™é‡Œé€‰çš„ 19.03.8</span><span class="token function">sudo</span> dnf -y <span class="token function">install</span> docker-ce-19.03.8 docker-ce-cli-19.03.8 containerd.io<span class="token punctuation">..</span>.Installed:docker-ce-3:19.03.8-3.el7.x86_64  docker-ce-cli-1:19.03.8-3.el7.x86_64   libcgroup-0.41-19.el8.x86_64</code></pre><p>ä½¿ç”¨äº†é˜¿é‡Œäº‘çš„ repo åï¼Œå®‰è£…ä¸€ä¸‹å­å¿«ä¹èµ·æ¥ï¼Œå¾ˆå¼€å¿ƒã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å®‰è£…äº†</p><ul><li>docker-ce-3:19.03.8-3.el7.x86_64</li><li>docker-ce-cli-1:19.03.8-3.el7.x86_64</li><li>libcgroup-0.41-19.el8.x86_64</li></ul><hr><h3 id="3-Docker-å¼€æœºè‡ªå¯åŠ¨"><a href="#3-Docker-å¼€æœºè‡ªå¯åŠ¨" class="headerlink" title="3. Docker å¼€æœºè‡ªå¯åŠ¨"></a>3. Docker å¼€æœºè‡ªå¯åŠ¨</h3><p>è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬è¿è¡Œ <code>docker version</code> ï¼Œä¼šæç¤º docker daemon æ— æ³•è¿æ¥ã€‚å› ä¸º Docker æ˜¯ CS æ¶æ„ï¼Œdocker daemon æ­¤æ—¶è¿˜æœªå¯åŠ¨ã€‚</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å¯åŠ¨ docker daemon</span><span class="token function">sudo</span> systemctl start docker<span class="token function">sudo</span> systemctl status docker <span class="token comment" spellcheck="true"># æ­¤æ—¶å¯ä»¥çœ‹åˆ° docker å¤„äº active(running) çŠ¶æ€</span><span class="token comment" spellcheck="true"># è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</span><span class="token function">sudo</span> systemctl <span class="token function">enable</span> docker</code></pre><hr><blockquote><p>Docker éªŒè¯</p></blockquote><pre><code>sudo docker run hello-world</code></pre><p>è¾“å‡ºäº†ä¸€å¤§å †ä¸œè¥¿ï¼Œå¯æ˜¯æˆ‘ä»¬è¿˜æ˜¯çœ‹åˆ°äº† Hello from Docker! å­—æ ·ï¼Œè¯´æ˜æˆ‘ä»¬ Docker å·²ç»å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚</p><p><code>docker run</code> è¿™ä¸ªå‘½ä»¤ï¼Œäº‹å®ä¸Šåšäº†ä¸¤ä¸ªåŠ¨ä½œ</p><ul><li>docker pull ï¼š å‘ç°æ²¡æœ‰ hello-world é•œåƒæ—¶ï¼Œå…ˆ pull é•œåƒï¼Œç„¶åå† run</li><li>docker run ï¼š è¿è¡Œ hello-world é•œåƒ</li></ul><hr><h3 id="4-é-root-è´¦å·ä½¿ç”¨-Docker"><a href="#4-é-root-è´¦å·ä½¿ç”¨-Docker" class="headerlink" title="4. é root è´¦å·ä½¿ç”¨ Docker"></a>4. é root è´¦å·ä½¿ç”¨ Docker</h3><p>docker ä¼šåˆ›å»º docker groupï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè‡ªå·±åŠ å…¥åˆ°è¯¥ç”¨æˆ·ç»„ï¼Œä»¥é¿å…é€šè¿‡ root æ¥ä½¿ç”¨ docker</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å½“å‰æ‰€åœ¨ç»„</span><span class="token function">groups</span>dylan wheel nginx<span class="token comment" spellcheck="true"># æŸ¥çœ‹ docker ç”¨æˆ·ç»„æ˜¯å¦å·²å­˜åœ¨</span><span class="token function">sudo</span> <span class="token function">cat</span> /etc/group <span class="token operator">|</span> <span class="token function">grep</span> docker<span class="token comment" spellcheck="true"># æŠŠå½“å‰ç”¨æˆ·åŠ å…¥ docker ç»„</span><span class="token function">sudo</span> <span class="token function">usermod</span> -aG docker <span class="token variable">$USER</span><span class="token comment" spellcheck="true"># æ›´æ–°ç”¨æˆ·ç»„</span>newgrp docker<span class="token comment" spellcheck="true"># å†æ¬¡æŸ¥çœ‹ï¼Œå·²ç»è®¡å…¥äº† docker ç”¨æˆ·ç»„</span><span class="token function">groups</span>docker wheel nginx dylan</code></pre><p>é€šè¿‡ <code>docker version</code> æŸ¥çœ‹ï¼Œç‰ˆæœ¬ä¸º <code>19.03.8</code> ï¼Œå®Œç¾ã€‚</p><pre class=" language-bash"><code class="language-bash">âœ  ~ docker versionClient: Docker Engine - Community Version:           19.03.8Server: Docker Engine - Community Engine:  Version:          19.03.8</code></pre><p>è‡³æ­¤ï¼ŒDocker å®‰è£…å°±ç»“æŸäº†ã€‚</p><h3 id="5-é•œåƒåŠ é€Ÿ"><a href="#5-é•œåƒåŠ é€Ÿ" class="headerlink" title="5. é•œåƒåŠ é€Ÿ"></a>5. é•œåƒåŠ é€Ÿ</h3><p>å¦‚æœä½ ä½¿ç”¨é˜¿é‡Œäº‘ï¼Œå¯ä»¥åœ¨ <a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors" target="_blank" rel="noopener">è¿™é‡Œ</a> æ‰¾åˆ°ä½ çš„é•œåƒåŠ é€Ÿä¸“å±åœ°å€ï¼š</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200418023257.png-growing" alt="docker image åŠ é€Ÿå™¨"></p><p>å…¶ä»–é•œåƒåŠ é€Ÿåœ°å€ï¼š</p><ul><li>ä¸ƒç‰›äº‘ï¼š <a href="https://reg-mirror.qiniu.com" target="_blank" rel="noopener">https://reg-mirror.qiniu.com</a></li><li>ä¸­ç§‘å¤§ï¼š <a href="https://docker.mirrors.ustc.edu.cn" target="_blank" rel="noopener">https://docker.mirrors.ustc.edu.cn</a></li><li>ç½‘æ˜“äº‘ï¼š <a href="https://hub-mirror.c.163.com" target="_blank" rel="noopener">https://hub-mirror.c.163.com</a></li><li>è…¾è®¯äº‘ï¼š <a href="https://mirror.ccs.tencentyun.com" target="_blank" rel="noopener">https://mirror.ccs.tencentyun.com</a></li></ul><h2 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h2><p><a href="http://mirrors.aliyun.com/" target="_blank" rel="noopener">é˜¿é‡Œäº‘å¼€æºé•œåƒç«™</a> ï¼š è¿™ä¸ªå¯ä»¥è¯´å¾ˆè‰¯å¿ƒäº†ï¼ŒåŸºæœ¬ä¸Šæ¶µç›–äº†å›½å¤–çš„å¾ˆå¤šè½¯ä»¶ï¼Œæ›´æ–°ä¹Ÿå¾ˆåŠæ—¶ï¼Œdeserve itã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> middlewares </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Middlewares -- Redis&lt;ä¸‰&gt;</title>
      <link href="/redis/lock/"/>
      <url>/redis/lock/</url>
      
        <content type="html"><![CDATA[<h2 id="Redis-Lock"><a href="#Redis-Lock" class="headerlink" title="Redis Lock"></a>Redis Lock</h2><p>å½“æˆ‘ä»¬æƒ³é€šè¿‡ redis æ¶‰åŠä¸€ä¸ªåˆ†å¸ƒå¼é”æ—¶ï¼Œç¬¬ä¸€æ—¶é—´å¿…ç„¶æ˜¯æƒ³åˆ° strings <code>set</code> å‘½ä»¤ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token keyword">set</span> r_lock random_value PX 10000 NX    </code></pre><ul><li>r_lock ï¼š key ï¼Œ é”åç§°ï¼Œå¯ä»¥æ˜¯ä»»ä½•ä¸€ä¸ªå€¼</li><li>random_value ï¼š å®¢æˆ·ç«¯è®¾ç½®é”çš„æ—¶å€™ç»™å®šçš„ä¸€ä¸ª unique çš„å€¼</li><li>PX ï¼š è¿‡æœŸæ—¶é—´ ï¼Œ æ¯«ç§’ï¼Œ è¿™é‡Œä¸º 10 s</li><li>NX ï¼š not exist ï¼Œå³å½“ key r_log ä¸å­˜åœ¨æ—¶æ‰ä¼šæˆåŠŸ</li></ul><p>å½“ client è·å–é”æ—¶ï¼Œå°è¯•è¯¥å‘½ä»¤ï¼Œå¦‚æœæˆåŠŸè¡¨æ˜è·å¾—é”ã€‚</p><hr><p>è¿™æ ·å®ç°æœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ</p><ol><li><p>client  A è·å¾—é”åï¼Œ ç”±äºä¸šåŠ¡å¤„ç†æ—¶é—´è¿‡é•¿æˆ–å…¶ä»–åŸå› ï¼ŒæœªåŠæ—¶é‡Šæ”¾é”ï¼Œè¶…æ—¶åè¢«è‡ªåŠ¨é‡Šæ”¾ï¼Œclient B è·å–åˆ°é”ï¼Œæ­¤æ—¶ A ä¸šåŠ¡å¤„ç†å®Œæˆï¼Œé‡Šæ”¾é”ï¼Œ æ‰§è¡Œ <code>del  key r_lock</code> , client B çš„é”è¢«åˆ é™¤â€¦</p></li><li><p>client è·å¾—é”åï¼Œç›´æ¥æŒ‚æ‰ â€¦</p></li><li><p>client A è·å–é”é‡Šæ”¾åï¼Œå…¶ä»–ç­‰å¾…çš„ client ä¸èƒ½åŠæ—¶çŸ¥é“è¿™ä¸ªä¿¡æ¯ï¼Œä»–ä»¬ä»ç„¶å†ç­‰å¾…ä¸€ä¸ªå›ºå®šçš„è½®è¯¢æ—¶é—´</p></li><li><p>å¯¹åŒä¸€ä¸ªçº¿ç¨‹è€Œè¨€ï¼Œåº”è¯¥æœ‰é‡å…¥çš„æœºåˆ¶</p></li><li><p>client A è·å–é”ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ 15s ï¼Œä½†æ˜¯å®é™…ä¸šåŠ¡å¤„ç†æ—¶é—´ä¸º 20sã€‚è™½ç„¶ client A ä¸€åˆ‡æ­£å¸¸ï¼Œä½†æ˜¯åœ¨ 15s åï¼Œé”ä»ç„¶è¢«é‡Šæ”¾æ‰äº†â€¦</p></li><li><p>redis cluster æ¨¡å¼ä¸‹ï¼Œclient c1 ä» redis server A å¤„è·å¾—é”ï¼ŒA å®•æœºï¼Œæ•°æ®è¿˜æœªåŒæ­¥ç»™ slave_Aï¼Œ slave_A è¢«é€‰ä¸º masterï¼Œå½“ client c2 å°è¯•è·å–é”æ—¶ï¼ŒæˆåŠŸè·å¾—é”â€¦</p></li></ol><hr><p>å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é€šè¿‡ random_value å¯ä»¥è§£å†³ã€‚æ¯ä¸ªå°è¯•é‡Šæ”¾é”çš„åŠ¨ä½œï¼Œéƒ½éœ€è¦å…ˆæ ¡éªŒè®¾ç½®çš„ value å€¼ï¼Œå¦‚æœä¸€è‡´ï¼Œæ‰å…è®¸ <code>del</code> æ“ä½œã€‚æ‰€ä»¥å½“ A å°è¯•é‡Šæ”¾é”çš„æ—¶å€™ï¼Œå› ä¸º value æ—©å·²æ”¹å˜ï¼Œå®ƒå°±æ— æ³•åˆ é™¤å±äº B çš„é”äº†ã€‚è¿™ä¸ªåˆ é™¤åŠ¨ä½œï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ lua è„šæœ¬æ¥æè¿°ï¼š</p><pre class=" language-lua"><code class="language-lua"><span class="token keyword">if</span> redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">"get"</span><span class="token punctuation">,</span> KEYS<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> ARGV<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token keyword">then</span>    <span class="token keyword">return</span> redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">"del"</span><span class="token punctuation">,</span> KEYS<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token keyword">end</span></code></pre><p>å¯¹äºé—®é¢˜äºŒï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–æªæ–½ï¼Œåˆ™ä¼šå½¢æˆæ­»é”ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™é”åŠ ä¸Šè¿‡æœŸæ—¶é—´ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å³ä¾¿ client æ‰çº¿ï¼Œé”æ—¶é—´åˆ°æœŸåï¼Œä¼šè¢« redis åˆ é™¤ï¼Œå…¶ä»– client å¯ä»¥ç»§ç»­è·å–é”ï¼Œè¿™é‡Œé€šè¿‡  <code>set ... PX 10000</code> æ¥è®¾ç½®è¿‡æœŸæ—¶é—´</p><p>å¯¹äºé—®é¢˜ä¸‰ï¼Œå¯ä»¥ç†è§£ä¸ºå¯¹å–é”æœºåˆ¶çš„ä¼˜åŒ–ï¼Œåœ¨ redisson ä¸­ï¼Œé€šè¿‡ pub/sub æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚redisson åœ¨ç¬¬ä¸€æ¬¡å°è¯•è·å–é”çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰è·å–åˆ°ï¼Œå°±ä¼šç›‘å¬ <code>redisson_lock__channel:{r_lock}</code> è¿™ä¸ª channelã€‚</p><p>è·å–åˆ°é”çš„ client åœ¨ç”¨å®Œé”åï¼Œä¼š publish ä¸€æ¡æ¶ˆæ¯ <code>PUBLISH redisson_lock__channel:{_lock_} 1</code> ï¼Œ ç­‰å¾…çš„ client æ”¶åˆ°æ¶ˆæ¯åï¼Œå°±å¯ä»¥ç»§ç»­ç«äº‰ï¼Œè€Œä¸ç”¨ç­‰åˆ°ä¸‹ä¸€æ¬¡çš„è½®è¯¢åˆ°æ¥æ‰å¼€å§‹</p><p>å¯¹äºé—®é¢˜å››ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªç±»ä¼¼ JAVA <code>ReentrantLock</code> , åœ¨ redisson çš„å®ç°ä¸­ï¼Œå¹¶éé€šè¿‡ <code>set</code> åŸè¯­è€Œæ˜¯ <code>hset</code> ï¼Œ field æ˜¯å½“å‰çº¿ç¨‹çš„ id ï¼Œè¿™æ ·çš„è¯ï¼Œå½“é€šè¿‡ä¸€ä¸ªçº¿ç¨‹æ¥è·å–é”çš„æ—¶å€™ï¼Œæˆ‘å°±ç»™ field çš„ value åŠ ä¸€ï¼Œè€Œé‡Šæ”¾é”çš„æ—¶å€™ï¼Œä¸€ç›´å‡ä¸€ï¼Œç›´åˆ°ä¸º 0 æ—¶ï¼Œåˆ é™¤è¯¥ key å³å¯ã€‚</p><p>å¯¹äºé—®é¢˜äº”ï¼Œ åœ¨ redisson ä¸­ï¼Œé€šè¿‡å¼€å¯ä¸€ä¸ª Timer æ¥å¤„ç†è¿‡æœŸé—®é¢˜ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> RFuture<span class="token operator">&lt;</span>Long<span class="token operator">></span> <span class="token function">tryAcquireAsync</span><span class="token punctuation">(</span><span class="token keyword">long</span> leaseTime<span class="token punctuation">,</span> TimeUnit unit<span class="token punctuation">,</span> <span class="token keyword">long</span> threadId<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>leaseTime <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token function">tryLockInnerAsync</span><span class="token punctuation">(</span>leaseTime<span class="token punctuation">,</span> unit<span class="token punctuation">,</span> threadId<span class="token punctuation">,</span> RedisCommands<span class="token punctuation">.</span>EVAL_LONG<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        RFuture<span class="token operator">&lt;</span>Long<span class="token operator">></span> ttlRemainingFuture <span class="token operator">=</span> <span class="token function">tryLockInnerAsync</span><span class="token punctuation">(</span>commandExecutor<span class="token punctuation">.</span><span class="token function">getConnectionManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCfg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLockWatchdogTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span> threadId<span class="token punctuation">,</span> RedisCommands<span class="token punctuation">.</span>EVAL_LONG<span class="token punctuation">)</span><span class="token punctuation">;</span>        ttlRemainingFuture<span class="token punctuation">.</span><span class="token function">onComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ttlRemaining<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true">// lock acquired</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>ttlRemaining <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// è¯¥æ–¹æ³•æœ€ç»ˆä¼šå¼€å¯ä¸€ä¸ªå®šæ—¶ Timer ç”¨æ¥å¤„ç† key è¿‡æœŸé—®é¢˜</span>                <span class="token function">scheduleExpirationRenewal</span><span class="token punctuation">(</span>threadId<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ttlRemainingFuture<span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“ <font color="red"><strong>leaseTime ä¸ä¸º -1</strong></font> æ—¶ ,ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰§è¡Œ lock() æ–¹æ³•æ—¶ï¼Œè®¾ç½®äº†è¶…æ—¶æ—¶é—´ï¼Œå¦‚ <code>lock.lock(15, TimeUnit.SECONDS);</code> æ—¶ï¼Œredisson ä¸ä¼šå¯¹ key å»¶æ—¶ã€‚</p><p>ä¸è®¾ç½®æ—¶ï¼Œåˆ™ä¼šæœ€ç»ˆæ‰§è¡Œå¦‚ä¸‹æ–¹æ³•ï¼š</p><pre class=" language-java"><code class="language-java">Timeout task <span class="token operator">=</span> commandExecutor<span class="token punctuation">.</span><span class="token function">getConnectionManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newTimeout</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TimerTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span>Timeout timeout<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// ...</span>                RFuture<span class="token operator">&lt;</span>Boolean<span class="token operator">></span> future <span class="token operator">=</span> <span class="token function">renewExpirationAsync</span><span class="token punctuation">(</span>threadId<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// ...</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span> internalLockLeaseTime <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>internalLockLeaseTime</code>(å¯é…ç½® <code>cfg.setLockWatchdogTimeout(45 * 1000L);</code> ) é»˜è®¤ä¸º 30sï¼Œ è¿™é‡Œå– 1/3 å³ 10s (æ­¤æ—¶åˆ™ä¸º 15s)ï¼Œå³æ¯ 10s( 15s ) æ‰§è¡Œä¸€æ¬¡ï¼Œç›´åˆ°å½“å‰çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</p><p>å¯¹äºæœ€åä¸€ä¸ªé—®é¢˜ï¼Œredis ç»™å‡ºäº†ä¸€ä¸ªå«åš <strong>redLock</strong> çš„ç®—æ³•ï¼Œå‚è§ <a href="http://redis.cn/topics/distlock.html" target="_blank" rel="noopener">è¿™é‡Œ</a> ï¼Œ åœ¨ redisson ä¸­ï¼Œå¯¹åº”çš„å®ç°ä¸º <code>redLock</code> ã€‚ </p><p>è¯¥ç®—æ³•è®¤ä¸ºï¼Œä¸ºäº†é¿å…é—®é¢˜å…­ï¼Œæˆ‘ä»¬æ¯æ¬¡è·å–é”çš„æ—¶å€™ï¼Œéƒ½éœ€è¦è·å–é›†ç¾¤ä¸­è¶…è¿‡ä¸€åŠ master çš„é”ï¼Œä¹Ÿå°±æ˜¯éœ€è¦åœ¨è¶…è¿‡ä¸€åŠçš„ master ä¸Šç”³è¯·é”ï¼Œåªæœ‰è¶…è¿‡åŠæ•°ï¼Œæœ¬æ¬¡è·å–é”çš„åŠ¨ä½œæ‰è®¤ä¸ºæˆåŠŸã€‚</p><p>ä¸è¿‡è¿™ç§åšæ³•å®ç°èµ·æ¥å¾ˆéº»çƒ¦ï¼Œ è™½ç„¶ redisson ç»™å‡ºäº†å®ç°ï¼Œä½†å®é™…ä½¿ç”¨ä¾æ—§ç¹çã€‚å¦‚æœæ— æ³•å®¹å¿è¿™æ ·çš„æå°æ¦‚ç‡äº‹ä»¶ï¼Œå¯ä»¥é€‚å½“è€ƒè™‘ä¸‹ zk æˆ–å…¶ä»–æ›´åŠ å¯é çš„åˆ†å¸ƒå¼é”ã€‚</p><h2 id="LRU"><a href="#LRU" class="headerlink" title="LRU"></a>LRU</h2><p>å³ least recently usedï¼Œ æœ€è¿‘æœ€å°‘ä½¿ç”¨ã€‚å¸¸ç”¨çš„ä¸­é—´ä»¶ï¼ŒåŸºæœ¬éƒ½ä¼šæœ‰è‡ªå·±çš„ LRU ç®—æ³•ï¼Œç”¨æ¥å›æ”¶å†…å­˜ã€‚</p><p>redis ä¸­å¯ä»¥é€šè¿‡</p><blockquote><p>maxmemory 100m</p></blockquote><p>è¿™ä¸ªé…ç½®æ¥é™åˆ¶å†…å­˜çš„ä½¿ç”¨ï¼Œåœ¨ 64 ä½ç³»ç»Ÿï¼Œé»˜è®¤ä¸º 0 ï¼Œå³ä¸é™åˆ¶å†…å­˜ï¼Œåœ¨ 32 ä½ç³»ç»Ÿä¸º 3G</p><hr><p>å½“è¾¾åˆ°æŒ‡å®šçš„å†…å­˜é™åˆ¶å¤§å°æ—¶ï¼Œredis é€šè¿‡ä¸åŒçš„ç­–ç•¥åšå‡ºä¸åŒçš„å›æ”¶è¡Œä¸ºï¼Œè¯¥ç­–ç•¥å¯ä»¥é€šè¿‡</p><blockquote><p>maxmemory-policy </p></blockquote><p>æ¥é…ç½®ï¼Œ redis æä¾›äº†ä»¥ä¸‹å¯é€‰é¡¹ï¼š</p><ul><li>noevictionï¼šä¸é©±é€ï¼Œå³ä¸å›æ”¶ã€‚æ­¤æ—¶ redis ä¼šå¯¹å¢åŠ å†…å­˜çš„æ“ä½œè¿”å›é”™è¯¯ï¼Œdel ç­‰æ“ä½œèƒ½æ­£å¸¸æ‰§è¡Œ</li><li>allkeys-lruï¼šå¯¹æ‰€æœ‰çš„ key è¿›è¡Œ LRU</li><li>volatile-lruï¼šåªé’ˆå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ key è¿›è¡Œ LRU</li><li>allkeys-randomï¼šéšæœºæ¸…é™¤æ‰€æœ‰ key é›†åˆä¸­çš„éƒ¨åˆ†</li><li>volatile-randomï¼šéšæœºæ¸…é™¤è®¾ç½®äº†è¿‡æœŸæ—¶é—´ key ä¸­çš„éƒ¨åˆ†</li><li>volatile-ttlï¼šæ¸…é™¤è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ key é›†åˆä¸­ TTL (å­˜æ´»æ—¶é—´) è¾ƒçŸ­çš„éƒ¨åˆ†</li></ul><p>ä¸º key è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¹Ÿä¼šæ¶ˆè€—å†…å­˜ï¼Œæ‰€ä»¥ä½¿ç”¨ <code>allkeys-lru</code> ä¼šæ›´åŠ é«˜æ•ˆ</p><hr><p>redis ä¸­çš„ LRU ä¸æ˜¯å®Œæ•´çš„ LRU ï¼Œå®ƒå¹¶ä¸ä¼šæ ¹æ®ç­–ç•¥å–æ‰«ææ‰€æœ‰çš„ key ï¼Œè€Œæ˜¯æ‰«ææ ·æœ¬æ•°é‡çš„ key ï¼Œè¿›è¡Œ LRUã€‚æ ·æœ¬æ•°é‡å¯ä»¥è¿›è¡Œé…ç½®ï¼š</p><blockquote><p>maxmemory-samples 5   # 5 æ˜¯ redis é»˜è®¤å€¼</p></blockquote><p>è¿™æ ·åšè™½ç„¶ä¸èƒ½çœŸæ­£åšåˆ° LRU ï¼Œä½†æ˜¯èƒ½å‡å°‘å†…å­˜çš„æ¶ˆè€—</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>config set maxmemory-samples 10</code> æ¥åœ¨è¿è¡Œæ—¶è°ƒæ•´è¯¥å€¼å¤§å°ã€‚ 10 ä¸ªæ ·æœ¬ï¼Œæ ¹æ® redis ç»™å‡ºçš„æ•°æ®ï¼Œå·²ç»ååˆ†æ¥è¿‘çœŸå®çš„ LRU</p><hr><p>ç°åœ¨æˆ‘ä»¬å®é™…æ“ä½œä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash">âœ  scripts-redis ./run.sh cliConnecting to redis server<span class="token punctuation">..</span>.Connected to 7000127.0.0.1:7000<span class="token operator">></span>127.0.0.1:7000<span class="token operator">></span>127.0.0.1:7000<span class="token operator">></span> CONFIG GET maxmemory-policy1<span class="token punctuation">)</span> <span class="token string">"maxmemory-policy"</span>2<span class="token punctuation">)</span> <span class="token string">"noeviction"</span>127.0.0.1:7000<span class="token operator">></span> CONFIG <span class="token keyword">set</span> maxmemory-policy allkeys-lruOK127.0.0.1:7000<span class="token operator">></span> CONFIG GET maxmemory-policy1<span class="token punctuation">)</span> <span class="token string">"maxmemory-policy"</span>2<span class="token punctuation">)</span> <span class="token string">"allkeys-lru"</span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶é›†ç¾¤çš„ <code>maxmemory-policy</code> å·²ç»å˜æˆäº† <code>allkeys-lru</code></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ redis æä¾›çš„ lru test å·¥å…·æ¥æµ‹è¯•ï¼š</p><pre class=" language-bash"><code class="language-bash">redis-cli -a 123456 -p 7000 --lru-test 1000000</code></pre><p>æœ¬æ¥æƒ³è´´ä¸‹è·‘å®Œåçš„æ—¥å¿—ï¼Œç»“æœâ€¦</p><pre class=" language-bash"><code class="language-bash">âœ  scripts-redis <span class="token function">sudo</span> <span class="token function">grep</span> <span class="token string">"Out of memory"</span> /var/log/messages<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> dylan:Apr 15 12:12:11 iZbp10xxkuq2vc7q4vabqtZ kernel: Out of memory: Killed process 16397 <span class="token punctuation">(</span>redis-cli<span class="token punctuation">)</span> total-vm:452400kB, anon-rss:431280kB, file-rss:0kB, shmem-rss:0kB</code></pre><p>å—¯ï¼Œ1G å†…å­˜ï¼Œé™¤å»å…¶ä»–è¿›ç¨‹å ç”¨ï¼Œå®é™…åªæœ‰ 450M å·¦å³å¯ç”¨â€¦ æˆ‘ä¸è·‘äº†ï¼</p><p>æœ‰å…´è¶£å¯ä»¥è‡ªå·±è·‘ä¸€æŠŠï¼Œçœ‹çœ‹å¤§æ¦‚çš„ miss æ˜¯å¤šå°‘</p><h2 id="Expires"><a href="#Expires" class="headerlink" title="Expires"></a>Expires</h2><p>redis å¸¸ç”¨çš„å…³äºè¿‡æœŸçš„å‘½ä»¤</p><ul><li><p>expire key seconds ï¼šè®¾ç½®æŒ‡å®š ç§’ åè¿‡æœŸï¼š expire key 10</p></li><li><p>pexpire key milliseconds ï¼š è®¾ç½®æŒ‡å®š æ¯«ç§’ åè¿‡æœŸï¼š expire key 10000</p></li><li><p>expireat key seconds-timestamp ï¼š è®¾ç½®æŒ‡å®š æ—¶é—´æˆ³ åè¿‡æœŸï¼Œæ—¶é—´æˆ³ä»¥ç§’è®¡ç®— ï¼š expireat key 1586868680</p></li><li><p>pexpiread key milliseconds-timestamp ï¼š è®¾ç½®æŒ‡å®š æ—¶é—´æˆ³ åè¿‡æœŸï¼Œæ—¶é—´æˆ³ä»¥æ¯«ç§’è®¡ç®— ï¼š  expireat key 1586868680000</p></li><li><p>persist key ï¼š å–å‡ºä¸€ä¸ª key çš„è¿‡æœŸæ—¶é—´ ï¼š persist key</p></li><li><p>TTL / PTTL key ï¼š æŸ¥çœ‹ key çš„è¿‡æœŸæ—¶é—´</p><ul><li>-1 ï¼š key å­˜åœ¨ä¸”æœªè®¾ç½®è¿‡æœŸæ—¶é—´</li><li>-2 ï¼š key ä¸å­˜åœ¨æˆ–å·²è¿‡æœŸ</li></ul></li></ul><hr><p>redis ä»€ä¹ˆæ—¶å€™ä¼šå»å›æ”¶ key ï¼Ÿ</p><ul><li>æ¯ä¸€æ¬¡è®¿é—® key çš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­ key æ˜¯å¦è¿‡æœŸï¼Œè¿‡æœŸå°±åˆ é™¤ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„ <strong>æƒ°æ€§åˆ é™¤</strong></li><li>redis å¯åŠ¨æ—¶ä¼šåˆ›å»ºä¸€ä¸ª cron ï¼Œå®šæœŸæ¸…ç†éƒ¨åˆ†è¿‡æœŸçš„ key ï¼Œé»˜è®¤ 10æ¬¡/s ã€‚ä¹Ÿå°±æ˜¯å¸¸è¯´çš„<strong>å®šæœŸåˆ é™¤</strong><ul><li>redis ä¼šéšæœºæŠ½å– 10 ä¸ª key (æ ¹æ®é…ç½®çš„ <code>maxmemory-samples</code> ç¡®å®š)</li><li>åˆ é™¤å…¶ä¸­è¿‡æœŸçš„ key</li><li>å¦‚æœè¿‡æœŸçš„ key è¶…è¿‡æ ·æœ¬çš„ 25% ï¼Œåˆ™é‡å¤æ­¥éª¤ 1ï¼Œç›´åˆ°å°äº 25%</li></ul></li></ul><h2 id="One-More-Thing"><a href="#One-More-Thing" class="headerlink" title="One More Thing"></a>One More Thing</h2><p>å‡ ç§å¸¸è§çš„ç¼“å­˜ç®—æ³•</p><ul><li>LRU ï¼š least recently used ï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼Œåˆ™ä¼šè¢«æ·˜æ±°</li><li>LFU ï¼š least frequently used ï¼Œæœ€ä¸ç»å¸¸ä½¿ç”¨ï¼Œåˆ™ä¼šè¢«æ·˜æ±°</li><li>FIFO ï¼š first in first out ï¼Œ å…ˆè¿›å…ˆå‡ºï¼Œå³æœ€å…ˆè¿›ç¼“å­˜ï¼Œæœ€å…ˆè¢«æ·˜æ±°</li></ul><p>æˆ‘ä»¬å‡è®¾ä¸€ä¸ªå®šé•¿ä¸º 3 çš„é˜Ÿåˆ—ï¼Œä¾æ¬¡å­˜å…¥æ•°æ® 1ï¼Œ2ï¼Œ3 ï¼Œæ­¤æ—¶é˜Ÿåˆ—å¦‚ä¸‹ï¼š</p><pre><code>head &lt;- 3 &lt;- 2 &lt;- 1 &lt;- tail</code></pre><p>  ç„¶åæœ‰ client ä¾æ¬¡è®¿é—®äº† 1ï¼Œ1ï¼Œ3ï¼Œ3ï¼Œ2 ï¼Œæ­¤æ—¶é˜Ÿåˆ—çš„é¡ºåºå°±å˜æˆäº†ï¼š</p><pre><code>head &lt;- 2 &lt;- 3 &lt;- 1 &lt;- tail # LRU ç»„ç»‡æ•°æ®æ–¹å¼head &lt;- 3 &lt;- 1 &lt;- 2 &lt;- tail # LFU ç»„ç»‡æ•°æ®æ–¹å¼</code></pre><p>æ­¤æ—¶æŒ‰ç…§ LRU ï¼Œåˆ™ä¼šæ·˜æ±°æ•°æ® 1 ï¼Œ è€ŒæŒ‰ç…§ LFU ï¼Œå› ä¸ºè¿™æ®µæ—¶é—´å†…ï¼Œ æ•°æ® 2 åªè¢«è®¿é—®äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¼šæ·˜æ±°æ•°æ® 2</p><hr><p>å…³äº redis çš„éƒ¨åˆ†å°±å¯ä»¥æš‚æ—¶å‘Šä¸€æ®µè½äº†  â€‹ â€‹ <span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f605.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f605.png?v8">ğŸ˜…</span> </p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="http://redis.cn/topics/lru-cache.html" target="_blank" rel="noopener">Redis CN LRU</a></p><h2 id="Read-More"><a href="#Read-More" class="headerlink" title="Read More"></a>Read More</h2><p><a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-buffer-pool.html" target="_blank" rel="noopener">MySQL LRU å®ç°</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> middlewares </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Middlewares -- Redis&lt;äºŒ&gt;</title>
      <link href="/redis/cluster/"/>
      <url>/redis/cluster/</url>
      
        <content type="html"><![CDATA[<h1 id="Redis-Cluster"><a href="#Redis-Cluster" class="headerlink" title="Redis Cluster"></a>Redis Cluster</h1><p>å…³äº redis é›†ç¾¤ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§æ¨¡å¼</p><ul><li>ä¸»ä»å¤åˆ¶æ¨¡å¼(Master-Slave) ï¼š è¯¥æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„äº‹åŠ¡æ“ä½œï¼Œéƒ½ä¼šå¼‚æ­¥åŒæ­¥åˆ°å…¶ä»– slave ä¸Šï¼Œæ¯å° redis éƒ½å­˜å‚¨ç›¸åŒæ•°æ®</li><li>å“¨å…µæ¨¡å¼(Sentinel) ï¼š é€šè¿‡å¢åŠ  sentinel é›†ç¾¤ï¼Œç®¡ç† master-slave ä¸‹çš„èŠ‚ç‚¹ï¼Œå¯ä»¥åœ¨ master å®•æœºæ—¶ï¼Œé€‰ä¸¾æ–°çš„ master èŠ‚ç‚¹</li><li>Jedis sharding ï¼šåœ¨å®¢æˆ·ç«¯ï¼Œå¯¹ key è¿›è¡Œ hash ï¼Œæ•£åˆ—åˆ°ä¸åŒçš„ redis å®ä¾‹ä¸Š</li><li>ç›¸å…³ä¸­é—´ä»¶å¦‚ codis ï¼Œ twemproxy ç­‰</li></ul><p>åœ¨ redis 3.0 ç‰ˆæœ¬åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œå®˜æ–¹æä¾›äº† redis cluster åŠŸèƒ½ã€‚</p><h2 id="redis-cluster-ç®€ä»‹"><a href="#redis-cluster-ç®€ä»‹" class="headerlink" title="redis cluster ç®€ä»‹"></a>redis cluster ç®€ä»‹</h2><p>redis cluster ä¸»è¦åŸºäº CRC16 ç®—æ³•å¯¹ key è¿›è¡Œ hash ï¼Œç„¶åæ•£åˆ—åˆ°ä¸åŒæ•£åˆ—æ§½ã€‚</p><p>redis cluster æ€»å…±æä¾› 16384 ä¸ªhash æ§½(slot) ï¼Œç†è®ºä¸Šï¼Œé›†ç¾¤çš„æœ€å¤§èŠ‚ç‚¹æ•°é‡æœ€å¤§ä¹æ„ä¸º 16384 ä¸ªã€‚ä¸è¿‡ redis å®˜æ–¹ç»™å‡ºçš„å»ºè®®æ˜¯ä¸è¦è¶…è¿‡ 1000 çš„é‡çº§ã€‚</p><p>æ¯ä¸ª redis instance ä¼šè´Ÿè´£è¿™ä¸ªæ•£åˆ—æ§½ä¸­çš„ä¸€éƒ¨åˆ†ã€‚</p><p><strong>æ–°å¢</strong>æˆ–<strong>åˆ é™¤</strong>èŠ‚ç‚¹ï¼Œå¯¹äº redis cluster è€Œè¨€å°±æ˜¯å¯¹ slot è¿›è¡Œ reshardï¼Œredis cluster ä¿è¯ slot å¹³æ»‘ç§»åŠ¨</p><h3 id="1-key-hash-è®¡ç®—"><a href="#1-key-hash-è®¡ç®—" class="headerlink" title="1. key hash è®¡ç®—"></a>1. key hash è®¡ç®—</h3><p>redis cluster ä¼šå¯¹å¤§æ‹¬å· <strong>{}</strong> ä¸­çš„å€¼è®¡ç®— hash å€¼è¿›è¡Œæ•£åˆ—ã€‚</p><ul><li>åªè®¡ç®—ç¬¬ä¸€æ¬¡å‡ºç°  <strong>{}</strong> çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è®¡ç®—æ•´ä¸ª key çš„ hash å€¼ï¼Œ å¦‚ <ul><li><code>key{key1}{key2}</code> ï¼š å€¼è®¡ç®— key1 çš„hash</li><li><code>keykey</code> ï¼š è®¡ç®—æ•´ä¸ª keykey çš„ hash</li></ul></li><li>å¦‚æœåªæœ‰ <strong>{</strong> ï¼Œæ²¡æœ‰ <strong>}</strong> ï¼Œæˆ–è€… <strong>{}</strong> ä¸­æ²¡æœ‰å†…å®¹ï¼Œåˆ™è®¡ç®—æ•´ä¸ª key çš„ hash å€¼ï¼Œ å¦‚<ul><li><code>key{12</code> ï¼š è®¡ç®—æ•´ä¸ª hash</li><li><code>key{}key</code> ï¼š è®¡ç®—æ•´ä¸ª hashï¼Œè¿™æ„å‘³ç€æ‰€æœ‰ä»¥ <code>{}</code> å¼€å¤´çš„ key ï¼Œéƒ½æ˜¯æ•´ä¸ªè®¡ç®— hash</li></ul></li></ul><p>æºç å¦‚ä¸‹ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">keyHashSlot</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">,</span> <span class="token keyword">int</span> keylen<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> s<span class="token punctuation">,</span> e<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* start-end indexes of { and } */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> s <span class="token operator">&lt;</span> keylen<span class="token punctuation">;</span> s<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'{'</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* No '{' ? Hash the whole key. This is the base case. */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> keylen<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">crc16</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>keylen<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3FFF</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* '{' found? Check if we have the corresponding '}'. */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>e <span class="token operator">=</span> s<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> e <span class="token operator">&lt;</span> keylen<span class="token punctuation">;</span> e<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'}'</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* No '}' or nothing between {} ? Hash the whole key. */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">==</span> keylen <span class="token operator">||</span> e <span class="token operator">==</span> s<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">crc16</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>keylen<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3FFF</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* If we are here there is both a { and a } on its right. Hash     * what is in the middle between { and }. */</span>    <span class="token keyword">return</span> <span class="token function">crc16</span><span class="token punctuation">(</span>key<span class="token operator">+</span>s<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>e<span class="token operator">-</span>s<span class="token number">-1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3FFF</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="2-é›†ç¾¤æ‹“æ‰‘ç»“æ„"><a href="#2-é›†ç¾¤æ‹“æ‰‘ç»“æ„" class="headerlink" title="2. é›†ç¾¤æ‹“æ‰‘ç»“æ„"></a>2. é›†ç¾¤æ‹“æ‰‘ç»“æ„</h3><p>redis cluster æ˜¯ä¸€ä¸ªç½‘çŠ¶æ‹“æ‰‘ç»“æ„ï¼Œæ¯ä¸ª redis instance ï¼Œéƒ½ä¼šä¸å…¶ä»– redis instance å»ºç«‹è¿æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœé›†ç¾¤ä¸­æœ‰ n ä¸ªèŠ‚ç‚¹ï¼Œåˆ™æ€»å…±ä¼šæœ‰ n(n-1) ä¸ªè¿æ¥ï¼Œè¿™äº› TCP è¿æ¥ä¼šè¢«æ°¸ä¹…ä¿å­˜ï¼Œå¹¶éæŒ‰éœ€åˆ›å»ºã€‚</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200414155611.png-growing" alt="redis cluster struct"></p><h3 id="3-é›†ç¾¤å·¥ä½œ"><a href="#3-é›†ç¾¤å·¥ä½œ" class="headerlink" title="3. é›†ç¾¤å·¥ä½œ"></a>3. é›†ç¾¤å·¥ä½œ</h3><p>client å‘é€è¯·æ±‚ ï¼Œé›†ç¾¤ä¸­æŸä¸ªèŠ‚ç‚¹æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šæŸ¥æ‰¾å†…éƒ¨ slot , node id æ˜ å°„ï¼Œå¦‚æœæ˜¯è‡ªå·±ï¼Œæ‰§è¡Œå‘½ä»¤è¿”å›ç»“æœï¼Œå¦‚æœæ˜¯å…¶ä»–èŠ‚ç‚¹ï¼Œåˆ™ä¼šç»™ client è¿”å›ä¸€ä¸ª <code>MOVED slot_id target_ip:port</code> çš„é”™è¯¯ã€‚å®¢æˆ·ç«¯éœ€è¦æ ¹æ®è¿”å›çš„èŠ‚ç‚¹ä¿¡æ¯ï¼Œå†æ¬¡æ‰§è¡Œå‘½ä»¤ã€‚</p><p>æ³¨æ„ï¼Œå¦‚æœåœ¨æ­¤æœŸé—´ï¼Œç›®æ ‡èŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œslot å‘ç”Ÿäº†è½¬ç§»ï¼Œåˆ™ client ä»éœ€è¦æ ¹æ®è¿”å›çš„ ip:port å†æ¬¡æŸ¥è¯¢</p><h2 id="redis-cluster-æ­å»º"><a href="#redis-cluster-æ­å»º" class="headerlink" title="redis cluster æ­å»º"></a>redis cluster æ­å»º</h2><h3 id="1-å®‰è£…-redis"><a href="#1-å®‰è£…-redis" class="headerlink" title="1. å®‰è£… redis"></a>1. å®‰è£… redis</h3><pre class=" language-bash"><code class="language-bash"><span class="token function">wget</span> https://github.com/antirez/redis/archive/5.0.7.tar.gz<span class="token function">tar</span> -xvf ./5.0.7.tar.gz</code></pre><p>ä¸‹è½½å¹¶è§£å‹åï¼Œä½ å¯ä»¥ <code>make</code> ä¸€æŠŠï¼Œä½†ä½ é€šè¿‡ä¸Šé¢ä¸‹è½½åï¼Œå…¶å®åœ¨ <code>src</code> åŒ…é‡Œå·²ç»æœ‰å¯ä»¥ä½¿ç”¨çš„ redis server ç­‰å„ä¸ªå·¥å…·ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><p><a href="https://github.com/antirez/redis" target="_blank" rel="noopener">Redis Github</a> ä¸Šçš„å®‰è£…æ­¥éª¤å¾ˆè¯¦ç»†ï¼Œè¿™é‡Œä¸å†èµ˜è¿°</p><p>ps: æˆ‘æ˜¯å› ä¸º make ä¹‹åè·‘ make test æ—¶ï¼Œä¸€ç›´æŒ‚æ‰ï¼Œå› ä¸ºæˆ‘å†…å­˜å®åœ¨å¤ªå°â€¦ æ‰€ä»¥å°±ç›´æ¥ç”¨äº†</p><h3 id="2-ç¼–è¾‘é…ç½®æ–‡ä»¶"><a href="#2-ç¼–è¾‘é…ç½®æ–‡ä»¶" class="headerlink" title="2. ç¼–è¾‘é…ç½®æ–‡ä»¶"></a>2. ç¼–è¾‘é…ç½®æ–‡ä»¶</h3><pre><code># è¯¥é›†ç¾¤é˜¶æ®µçš„ç«¯å£port 7000# æ˜¯å¦åå°å¯åŠ¨daemonize yes# æˆ‘æ²¡æœ‰å†…å­˜ï¼Œè¿™é‡Œè®¾ç½® 50mmaxmemory 50m# ä¸ºæ¯ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹æŒ‡å®šä¸€ä¸ª pid_filepidfile /home/dylan/tmp/scripts-redis/cluster/pid/pid_7000.pid#åœ¨bindæŒ‡ä»¤åæ·»åŠ æœ¬æœºçš„ipbind 127.0.0.1####################################### file #######################loglevel noticelogfile /home/dylan/tmp/scripts-redis/cluster/log/log_7000.logdbfilename "dump.rdb"dir "/home/dylan/tmp/scripts-redis/cluster/data/7000"#################################### cluster ####################################cluster-enabled yes # å¯ç”¨é›†ç¾¤æ¨¡å¼# é›†ç¾¤çš„é…ç½®ï¼Œé…ç½®æ–‡ä»¶é¦–æ¬¡å¯åŠ¨è‡ªåŠ¨ç”Ÿæˆ , ä¸èƒ½äººå·¥ç¼–è¾‘ï¼Œæ˜¯é›†ç¾¤èŠ‚ç‚¹è‡ªåŠ¨ç»´æŠ¤çš„æ–‡ä»¶cluster-config-file "/home/dylan/tmp/scripts-redis/cluster/config/nodes_7000.conf"cluster-node-timeout 5000# é…ç½®åï¼Œé€šè¿‡ cli è¿æ¥éœ€è¦é€šè¿‡ -a 123456 è¿æ¥requirepass "123456"masterauth "123456"</code></pre><h3 id="3-å¤åˆ¶å¤šä»½é…ç½®æ–‡ä»¶å¹¶ä¿®æ”¹å¯¹åº”å€¼"><a href="#3-å¤åˆ¶å¤šä»½é…ç½®æ–‡ä»¶å¹¶ä¿®æ”¹å¯¹åº”å€¼" class="headerlink" title="3. å¤åˆ¶å¤šä»½é…ç½®æ–‡ä»¶å¹¶ä¿®æ”¹å¯¹åº”å€¼"></a>3. å¤åˆ¶å¤šä»½é…ç½®æ–‡ä»¶å¹¶ä¿®æ”¹å¯¹åº”å€¼</h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200414195430.png-growing" alt="redis cluster folder"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œå°† redis.conf é…ç½®æ–‡ä»¶ copy 6 ä»½(å› ä¸º redis è¦æ±‚æœ€å°‘ 3 master ï¼Œæˆ‘ä»¬è¦æ¯ä¸ª master ä¸€ä¸ª slave ï¼Œé‚£ä¹ˆè¿™é‡Œå°±éœ€è¦ 6 ä¸ªå®ä¾‹)ï¼Œç„¶åå»ºå¥½ conf æ–‡ä»¶é‡Œé…ç½®çš„å„ä¸ªç›®å½•</p><h3 id="4-å¯åŠ¨-redis-å®ä¾‹"><a href="#4-å¯åŠ¨-redis-å®ä¾‹" class="headerlink" title="4. å¯åŠ¨ redis å®ä¾‹"></a>4. å¯åŠ¨ redis å®ä¾‹</h3><p><code>redis-server redis.conf</code> ï¼Œè¿™ä¸ªå‘½ä»¤æƒ³å¿…å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ï¼Œè¿™é‡Œå°±ä¸å†å•°å—¦ã€‚è¿™é‡Œæˆ‘ä»¬åªéœ€è¦ä¾æ¬¡å¯åŠ¨ 6 ä¸ªå®ä¾‹å³å¯ã€‚</p><p>æˆ‘ä¸ªäººå†™äº†ä¸ªå°è„šæœ¬ï¼Œåé¢ä¼šè´´ä¸Šæ¥ã€‚</p><h3 id="5-åˆ›å»ºé›†ç¾¤"><a href="#5-åˆ›å»ºé›†ç¾¤" class="headerlink" title="5. åˆ›å»ºé›†ç¾¤"></a>5. åˆ›å»ºé›†ç¾¤</h3><p>redis æä¾›äº† <code>cluster create</code> å‘½ä»¤å¸®åŠ©æˆ‘ä»¬åˆ›å»º redis cluster </p><pre class=" language-bash"><code class="language-bash">redis-cli -a 123456 --cluster create 127.0.0.1:7000 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 --cluster-replicas 1</code></pre><p>æ‰§è¡Œè¯¥å‘½ä»¤åï¼Œä¼šæœ‰å¦‚ä¸‹è¾“å‡ºï¼š</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200414200359.png-growing" alt="redis create cluster"></p><p>é€šè¿‡ redis è¾“å‡ºçš„ä¿¡æ¯èƒ½çœ‹åˆ°ï¼Œç°åœ¨æ˜¯ 3 master 3 slaveï¼Œæ¯ä¸ª master ä¸€ä¸ª slave èŠ‚ç‚¹</p><h3 id="6-æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯"><a href="#6-æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯" class="headerlink" title="6. æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯"></a>6. æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯</h3><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æ³¨æ„ -c å‚æ•°ï¼Œè¡¨ç¤ºä»¥é›†ç¾¤æ–¹å¼ç™»å…¥</span>redis-cli -a 123456 -c -p 7000</code></pre><p>cluster ç›¸å…³çš„å‘½ä»¤ï¼Œè¯·å‚è€ƒ <a href="http://redis.cn/commands.html#cluster" target="_blank" rel="noopener">è¿™é‡Œ</a></p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ set å‡ ä¸ªæ•°æ®ï¼š</p><pre class=" language-bash"><code class="language-bash">127.0.0.1:7000<span class="token operator">></span> <span class="token keyword">set</span> a a-<span class="token operator">></span> Redirected to slot <span class="token punctuation">[</span>15495<span class="token punctuation">]</span> located at 127.0.0.1:7002OK127.0.0.1:7002<span class="token operator">></span> <span class="token keyword">set</span> b b-<span class="token operator">></span> Redirected to slot <span class="token punctuation">[</span>3300<span class="token punctuation">]</span> located at 127.0.0.1:7000OK127.0.0.1:7000<span class="token operator">></span> keys *1<span class="token punctuation">)</span> <span class="token string">"b"</span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€æ¬¡ set a æ—¶ï¼Œ è¢«è·¯ç”±åˆ°äº† 7002 èŠ‚ç‚¹ï¼Œç¬¬äºŒæ¬¡ set b æ—¶ï¼Œè·¯ç”±åˆ°äº† 7000 ä¹Ÿå°±æ˜¯è‡ªå·±è¿™å„¿ï¼Œé€šè¿‡ keys * (è¯·ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨è¯¥å‘½ä»¤) æŸ¥çœ‹æ—¶ï¼Œ åªæœ‰ key b (kbâ€¦) ï¼Œ key a ä¸ä¼šæ˜¾ç¤ºï¼Œå› ä¸ºå®ƒåœ¨ 7002 èŠ‚ç‚¹é‚£å„¿</p><h3 id="æ–°å¢-åˆ é™¤èŠ‚ç‚¹"><a href="#æ–°å¢-åˆ é™¤èŠ‚ç‚¹" class="headerlink" title="æ–°å¢ / åˆ é™¤èŠ‚ç‚¹"></a>æ–°å¢ / åˆ é™¤èŠ‚ç‚¹</h3><pre class=" language-bash"><code class="language-bash">redis-cli --cluster <span class="token function">help</span></code></pre><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200415174628.png-growing" alt="redis-cli cluster help"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ <code>add-node / del-node</code> å¯ä»¥æ·»åŠ  / åˆ é™¤èŠ‚ç‚¹</p><pre class=" language-bash"><code class="language-bash">redis-cli -a 123456 -p 7000 --cluster add-node 127.0.0.1:7006 127.0.0.1:7000 --cluster-slave</code></pre><p>æˆ‘ä»¬æŠŠ 7006 æ·»åŠ åˆ°é›†ç¾¤ä½œä¸º slave</p><pre class=" language-bash"><code class="language-bash">redis-cli -a 123456 -p 7000 --cluster info</code></pre><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200415181449.png-growing-growing" alt="redis cluster add slave"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œ 7001 èŠ‚ç‚¹ä¸Šå·²ç»æœ‰ä¸¤ä¸ª slave äº†ã€‚</p><p>é€šè¿‡åœ¨é›†ç¾¤å†…éƒ¨æ‰§è¡Œ <code>cluster nodes</code> å‘½ä»¤ï¼Œèƒ½çœ‹åˆ°æ›´è¯¦ç»†çš„æ•°æ®ï¼Œè¿™é‡Œä¸è´´äº†ï¼Œåªæ˜ç¡®ä¸‹ 7003 çš„ slave èŠ‚ç‚¹ä¸º 7004</p><p>æˆ‘ä»¬ç°åœ¨è®© 7003(åªæœ‰ä¸€ä¸ªä»èŠ‚ç‚¹çš„ master èŠ‚ç‚¹) å®•æœºï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p><pre class=" language-bash"><code class="language-bash"> ./run.sh stop ./cluster/conf/redis.7003.conf</code></pre><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200415175936.png-growing" alt="redis cluster after down"></p><p>ä¼šå‘ç°ï¼Œä¹‹å‰ 7003 çš„ slave èŠ‚ç‚¹ 7004 ï¼Œ è¢«é€‰ä¸ºäº†æ–°çš„ä¸»èŠ‚ç‚¹ï¼Œè€Œ 7001 èŠ‚ç‚¹çš„ä¸¤ä¸ª slave èŠ‚ç‚¹ï¼Œåˆ†ç»™äº† 7004 ä¸€ä¸ªï¼Œæ‰€ä»¥ç°åœ¨æ¯ä¸ªä¸»èŠ‚ç‚¹åˆéƒ½æœ‰ä¸€ä¸ª slave èŠ‚ç‚¹ã€‚</p><p>è¿™æ˜¯ redis çš„ <strong>å¤‡ä»½è¿ç§»ç®—æ³•</strong> ä¸»å¯¼å®Œæˆçš„ã€‚å…³äºè¯¥éƒ¨åˆ†çš„å†…å®¹è¯·å‚è€ƒ <a href="http://redis.cn/topics/cluster-spec.html" target="_blank" rel="noopener">è¿™é‡Œ</a></p><h3 id="å°è„šæœ¬"><a href="#å°è„šæœ¬" class="headerlink" title="å°è„šæœ¬"></a>å°è„šæœ¬</h3><p>æ²¡æœ‰åšå¤šå°‘é‡æ„ï¼Œå°†å°±ç€ç”¨â€¦</p><p><code>./run.sh start all</code> ï¼š åˆ†åˆ«ä»¥ conf ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶å¯åŠ¨ redis å®ä¾‹</p><p><code>./run.sh stop all</code> ï¼š åœæ­¢æ‰€æœ‰ conf ç›®å½•ä¸‹é…ç½®æ–‡ä»¶äº§ç”Ÿçš„ redis å®ä¾‹</p><p><code>./run.sh cluster</code> ï¼š åœ¨å¯åŠ¨æ‰€æœ‰ redis å®ä¾‹åï¼Œé€šè¿‡ cluster å‘½ä»¤åˆ›å»ºé›†ç¾¤ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹ ip:port</p><p><code>./run.sh status</code> ï¼š æŸ¥çœ‹ redis å®ä¾‹ï¼Œè¿™é‡Œæ²¡æœ‰æä¾›æŸ¥çœ‹å•ä¸ª redis å®ä¾‹ status çš„æ–¹æ³•</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#!/usr/bin/env bash</span>workdir<span class="token operator">=</span><span class="token string">"/home/dylan/tmp/redis-5.0.8/src"</span>scriptdir<span class="token operator">=</span><span class="token string">"/home/dylan/tmp/scripts-redis"</span>conffile<span class="token operator">=</span><span class="token variable">$2</span><span class="token comment" spellcheck="true"># *********</span>cluster_dir<span class="token operator">=</span><span class="token string">"<span class="token variable">${scriptdir}</span>/cluster"</span>cluster_pid_dir<span class="token operator">=</span><span class="token string">"<span class="token variable">${cluster_dir}</span>/pid"</span>cluster_conf_dir<span class="token operator">=</span><span class="token string">"<span class="token variable">${cluster_dir}</span>/conf"</span><span class="token comment" spellcheck="true"># $1 is redis config file name looks like ./conf/redis.1234.conf</span><span class="token comment" spellcheck="true"># return pid file name looks like pid_1234.pid</span><span class="token keyword">function</span> get_redis_pid_file<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        rport<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">"."</span> <span class="token string">'{print <span class="token variable"><span class="token variable">$(</span>NF-1<span class="token variable">)</span></span>}'</span><span class="token punctuation">)</span>        <span class="token keyword">echo</span> -e <span class="token string">"<span class="token variable">${cluster_pid_dir}</span>/pid_<span class="token variable">$rport</span>.pid"</span><span class="token punctuation">}</span><span class="token keyword">function</span> get_redis_conf_file<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        conf<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">"/"</span> <span class="token string">'{print <span class="token variable">$NF</span>}'</span><span class="token punctuation">)</span>        <span class="token keyword">echo</span> -e <span class="token string">"<span class="token variable">${cluster_conf_dir}</span>/<span class="token variable">$conf</span>"</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true"># $1 should be redis config file name looks like redis.1234.conf</span><span class="token keyword">function</span> redis_start<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true"># conf file looks like redis.port.conf</span>        <span class="token comment" spellcheck="true"># pid file looks like pid_port.pid</span>        redis_conf_path<span class="token operator">=</span><span class="token variable">$1</span>        redis_conf<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>get_redis_conf_file $<span class="token punctuation">{</span>redis_conf_path<span class="token punctuation">}</span><span class="token variable">)</span></span>        redis_conf_path_forshow<span class="token operator">=</span><span class="token string">"Redis with config $(echo <span class="token variable">${redis_conf}</span> | awk -F"</span>/<span class="token string">" '{print <span class="token variable">$NF</span>}')"</span>        pidfile<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>get_redis_pid_file $<span class="token punctuation">{</span>redis_conf_path<span class="token punctuation">}</span><span class="token variable">)</span></span>        <span class="token keyword">if</span> <span class="token punctuation">[</span> -f <span class="token variable">$pidfile</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                <span class="token keyword">if</span> <span class="token function">kill</span> -0 <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> $pidfile<span class="token variable">`</span></span> <span class="token operator">></span> /dev/null 2<span class="token operator">></span><span class="token operator">&amp;</span>1<span class="token punctuation">;</span> <span class="token keyword">then</span>                        <span class="token keyword">echo</span> REDIS already running as process <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> $pidfile<span class="token variable">`</span></span><span class="token keyword">.</span>                        <span class="token keyword">return</span>                <span class="token keyword">fi</span>        <span class="token keyword">fi</span>        <span class="token comment" spellcheck="true"># é…ç½®ä¸­å·²ç»é…ç½®äº† daemonize yes</span>        <span class="token comment" spellcheck="true"># nohup ${workdir}/redis-server $conffile > $logfile 2>&amp;1 &lt; /dev/null &amp;</span>        <span class="token variable">${workdir}</span>/redis-server <span class="token variable">$redis_conf</span>        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> -eq 0 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                <span class="token function">sleep</span> 1                <span class="token keyword">if</span> <span class="token punctuation">[</span> -f <span class="token variable">$pidfile</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                        pid<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> $pidfile<span class="token variable">)</span></span>                        <span class="token keyword">if</span> <span class="token function">ps</span> -p <span class="token variable">$pid</span> <span class="token operator">></span> /dev/null 2<span class="token operator">></span><span class="token operator">&amp;</span>1<span class="token punctuation">;</span> <span class="token keyword">then</span>                                <span class="token keyword">echo</span> <span class="token variable">${redis_conf_path_forshow}</span> STARTED                        <span class="token keyword">else</span>                                <span class="token keyword">echo</span> <span class="token variable">${redis_conf_path_forshow}</span> FAILED TO START                                <span class="token keyword">exit</span> 1                        <span class="token keyword">fi</span>                <span class="token keyword">else</span>                        <span class="token keyword">echo</span> <span class="token variable">${redis_conf_path_forshow}</span> start failed                        <span class="token keyword">exit</span> 1                <span class="token keyword">fi</span>        <span class="token keyword">else</span>                <span class="token keyword">echo</span> <span class="token variable">${redis_conf_path_forshow}</span> DID NOT START                <span class="token keyword">exit</span> 1        <span class="token keyword">fi</span><span class="token punctuation">}</span><span class="token keyword">case</span> <span class="token variable">$1</span> <span class="token keyword">in</span>        start<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># å¦‚æœ $2 ä¸º all ï¼Œåˆ™å¯åŠ¨æ‰€æœ‰</span>                <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"all"</span> <span class="token operator">==</span> <span class="token string">"<span class="token variable">$conffile</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                        <span class="token keyword">echo</span> <span class="token string">"Run all files in <span class="token variable">$cluster_conf</span>"</span>                        <span class="token keyword">for</span> rfile <span class="token keyword">in</span> <span class="token variable">${cluster_conf_dir}</span>/*.conf                        <span class="token keyword">do</span>                                redis_start <span class="token variable">$rfile</span>                                <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> -ne 0 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                                        <span class="token keyword">exit</span> 1                                <span class="token keyword">fi</span>                        <span class="token keyword">done</span>                <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token operator">!</span> -f <span class="token string">"<span class="token variable">$conffile</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span> <span class="token comment" spellcheck="true"># è¾“å…¥çš„æ–‡ä»¶ä¸å­˜åœ¨</span>                        <span class="token keyword">echo</span> Can not <span class="token function">find</span> <span class="token variable">$conffile</span><span class="token keyword">.</span>                        <span class="token keyword">exit</span> 1                <span class="token keyword">elif</span> <span class="token punctuation">[</span> -s <span class="token variable">$conffile</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                        redis_start <span class="token variable">$conffile</span>                <span class="token keyword">else</span>                        <span class="token keyword">echo</span> <span class="token string">"Usage <span class="token variable">$0</span> start (all|redis_config_file)"</span>                        <span class="token keyword">exit</span> 1                <span class="token keyword">fi</span>                <span class="token keyword">exit</span> 0                <span class="token punctuation">;</span><span class="token punctuation">;</span>        stop<span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"all"</span> <span class="token operator">==</span> <span class="token string">"<span class="token variable">$conffile</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                        <span class="token keyword">echo</span> Stopping all<span class="token punctuation">..</span>.                        <span class="token keyword">for</span> rfile <span class="token keyword">in</span> <span class="token variable">${cluster_conf_dir}</span>/*.conf                        <span class="token keyword">do</span>                                pid<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>get_redis_pid_file $rfile<span class="token variable">)</span></span>                                <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> -f <span class="token string">"<span class="token variable">$pid</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                                        <span class="token keyword">echo</span>                                        <span class="token keyword">echo</span> Redis with config <span class="token string">"<span class="token variable">$rfile</span>"</span> already stopped                                        <span class="token keyword">continue</span>                                <span class="token keyword">fi</span>                                <span class="token function">kill</span> <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> $pid<span class="token variable">`</span></span>                                <span class="token function">sleep</span> 1                                <span class="token keyword">echo</span>                                <span class="token keyword">echo</span> Redis with config <span class="token variable">$rfile</span> STOPPED                        <span class="token keyword">done</span>                <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token operator">!</span> -f <span class="token string">"<span class="token variable">$conffile</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                        <span class="token keyword">echo</span> Can not <span class="token function">find</span> <span class="token variable">$conffile</span><span class="token keyword">.</span>                        <span class="token keyword">exit</span> 1                <span class="token keyword">elif</span> <span class="token punctuation">[</span> -f <span class="token variable">$conffile</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                        pid<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>get_redis_pid_file $conffile<span class="token variable">)</span></span>                        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> -f <span class="token variable">$pid</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                                <span class="token keyword">echo</span>                                <span class="token keyword">echo</span> Redis with config <span class="token variable">$conffile</span> already STOPPED                                <span class="token keyword">exit</span> 0                        <span class="token keyword">fi</span>                        <span class="token function">kill</span> <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> $pid<span class="token variable">`</span></span>                        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> -ne 0 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                                <span class="token keyword">echo</span> Kill <span class="token variable">$pid</span> failed                                <span class="token keyword">exit</span> 1                        <span class="token keyword">fi</span>                        <span class="token function">sleep</span> 1                        <span class="token keyword">echo</span> STOPPED                <span class="token keyword">else</span>                        <span class="token keyword">echo</span> <span class="token string">"Usage <span class="token variable">$0</span> stop (all|redis_config_file)"</span>                        <span class="token keyword">exit</span> 1                <span class="token keyword">fi</span>                <span class="token punctuation">;</span><span class="token punctuation">;</span>        cli<span class="token punctuation">)</span>                <span class="token keyword">echo</span> <span class="token string">"Connecting to redis server..."</span>                count<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ls</span> $<span class="token punctuation">{</span>cluster_conf_dir/*.conf<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token function">wc</span> -l<span class="token variable">`</span></span>                <span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token variable"><span class="token variable">`</span><span class="token function">seq</span> 1 $count<span class="token variable">`</span></span>                <span class="token keyword">do</span>                        conf<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> $<span class="token punctuation">{</span>cluster_conf_dir/*.conf<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token function">sort</span> --random-sort <span class="token operator">|</span> <span class="token function">head</span> -n 1<span class="token variable">)</span></span>                        <span class="token comment" spellcheck="true"># check if running</span>                        pid<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>get_redis_pid_file $conf<span class="token variable">)</span></span>                        port<span class="token operator">=</span>`echo <span class="token string">"<span class="token variable">$conf</span>"</span> <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">"."</span> <span class="token string">'{print <span class="token variable"><span class="token variable">$(</span>NF-1<span class="token variable">)</span></span>}'</span><span class="token variable"><span class="token variable">`</span>                        <span class="token keyword">if</span> <span class="token punctuation">[</span> -f $pid <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ps</span> -p <span class="token variable">`</span></span><span class="token function">cat</span> <span class="token variable">$pid</span>` <span class="token operator">></span> /dev/null 2<span class="token operator">></span><span class="token operator">&amp;</span>1<span class="token punctuation">;</span> <span class="token keyword">then</span>                                <span class="token keyword">echo</span> <span class="token string">"Connected to <span class="token variable">$port</span>"</span>                                <span class="token variable">${workdir}</span>/redis-cli -a 123456 -c -p `echo <span class="token string">"<span class="token variable">$conf</span>"</span> <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">"."</span> <span class="token string">'{print <span class="token variable"><span class="token variable">$(</span>NF-1<span class="token variable">)</span></span>}'</span>`                                <span class="token keyword">exit</span> 0                        <span class="token keyword">fi</span>                        <span class="token keyword">echo</span> <span class="token string">"Redis not running at port <span class="token variable">$port</span>"</span>                <span class="token keyword">done</span>                <span class="token keyword">echo</span> <span class="token string">"All Redis not running"</span>                <span class="token keyword">exit</span> 1                <span class="token punctuation">;</span><span class="token punctuation">;</span>        status<span class="token punctuation">)</span>                <span class="token keyword">echo</span> <span class="token string">"Checking status..."</span>                <span class="token keyword">echo</span> Found <span class="token variable"><span class="token variable">`</span><span class="token function">ls</span> $<span class="token punctuation">{</span>cluster_conf_dir<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token function">wc</span> -l<span class="token variable">`</span></span> config files                <span class="token keyword">echo</span>                <span class="token keyword">for</span> rfile <span class="token keyword">in</span> <span class="token variable">${cluster_conf_dir}</span>/*.conf                <span class="token keyword">do</span>                        pid<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>get_redis_pid_file $rfile<span class="token variable">)</span></span>                        <span class="token keyword">if</span> <span class="token punctuation">[</span> -f <span class="token variable">$pid</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                                <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> -s <span class="token variable">${pid}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>                                        <span class="token keyword">echo</span> <span class="token function">file</span> <span class="token variable">$pid</span> is empty. skip<span class="token punctuation">..</span>.                                        <span class="token keyword">echo</span> <span class="token string">"Please check <span class="token variable">$pid</span>."</span>                                        <span class="token keyword">echo</span>                                        <span class="token keyword">continue</span>                                <span class="token keyword">fi</span>                                <span class="token keyword">if</span> <span class="token function">ps</span> -p <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> $pid<span class="token variable">`</span></span> <span class="token operator">></span> /dev/null 2<span class="token operator">></span><span class="token operator">&amp;</span>1<span class="token punctuation">;</span><span class="token keyword">then</span>                                        <span class="token keyword">echo</span> REDIS <span class="token variable">$pid</span> with pid <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> $pid<span class="token variable">`</span></span> is running                                        <span class="token function">sleep</span> 0.5                                <span class="token keyword">else</span>                                        <span class="token keyword">echo</span> <span class="token string">"Not running with pid <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> $pid<span class="token variable">`</span></span>, Please check it"</span>                                        <span class="token keyword">exit</span> 1                                <span class="token keyword">fi</span>                        <span class="token keyword">else</span>                                <span class="token keyword">echo</span> <span class="token string">"Not running with config file <span class="token variable">$rfile</span>. No pid file exists."</span>                        <span class="token keyword">fi</span>                <span class="token keyword">done</span>                <span class="token punctuation">;</span><span class="token punctuation">;</span>        cluster<span class="token punctuation">)</span>                <span class="token keyword">echo</span> <span class="token string">"Start clusting..."</span>                <span class="token variable">${workdir}</span>/redis-cli -a 123456 --cluster create 127.0.0.1:7000 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 --cluster-replicas 1                <span class="token keyword">exit</span> 0                <span class="token punctuation">;</span><span class="token punctuation">;</span>        test<span class="token punctuation">)</span>                <span class="token keyword">echo</span>                <span class="token keyword">echo</span> <span class="token string">"Test Success"</span>                <span class="token keyword">exit</span> 0                <span class="token punctuation">;</span><span class="token punctuation">;</span>        *<span class="token punctuation">)</span>                <span class="token keyword">echo</span>                <span class="token keyword">echo</span> -n <span class="token string">"Usage: "</span>                <span class="token keyword">echo</span> -n <span class="token string">"<span class="token variable">$0</span> status or "</span>                <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$0</span> {start|stop} conf_file_path"</span> <span class="token operator">></span><span class="token operator">&amp;</span>2                <span class="token punctuation">;</span><span class="token punctuation">;</span>esac</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> middlewares </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Middlewares -- Redis&lt;ä¸€&gt;</title>
      <link href="/redis/introduction/"/>
      <url>/redis/introduction/</url>
      
        <content type="html"><![CDATA[<h1 id="Redis-lt-gt"><a href="#Redis-lt-gt" class="headerlink" title="Redis <->"></a>Redis &lt;-&gt;</h1><h2 id="åŸºç¡€å‘½ä»¤"><a href="#åŸºç¡€å‘½ä»¤" class="headerlink" title="åŸºç¡€å‘½ä»¤"></a>åŸºç¡€å‘½ä»¤</h2><h3 id="1-Strings"><a href="#1-Strings" class="headerlink" title="1. Strings"></a>1. Strings</h3><p>redis å¯¹æ­¤æè¿°ä¸º <strong>binary-safe</strong> stringsã€‚å¯ä»¥çœ‹å‡ºï¼Œ strings ç±»å‹åœ¨ redis ä¸­æ˜¯ä»¥ <strong>äºŒè¿›åˆ¶</strong> å½¢å¼å­˜å‚¨ï¼Œè¿™æ„å‘³ç€ redis strings å¯ä»¥ç”¨æ¥å­˜å‚¨ä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œç”šè‡³æ˜¯ä¸€å¼ å›¾ç‰‡ã€‚ä¸€ä¸ª string value æœ€å¤§å¯ä»¥ä¸º <strong>512M</strong></p><p>redis ä½¿ç”¨ sds(simple dynamic string) struct æ¥å­˜å‚¨ strings æ•°æ®ã€‚</p><pre class=" language-c"><code class="language-c"><span class="token keyword">struct</span> sdshdr <span class="token punctuation">{</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> len<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å·²å­˜å‚¨çš„ string é•¿åº¦</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> free<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å‰©ä½™çš„å­˜å‚¨ç©ºé—´</span>    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å­˜å‚¨çš„å­—ç¬¦ä¸²</span><span class="token punctuation">}</span></code></pre><p>åˆå§‹åŒ–æ—¶ï¼Œfree ä¸º 0ï¼Œ å½“ <code>append key value</code> æ—¶ï¼Œ redis ä¼šå¯¹è¯¥å­˜å‚¨ç©ºé—´æ‰©å®¹ï¼Œ<strong>æ‰©å®¹å¤§å° = new_value.length * 2</strong> ï¼Œä½†æœ€å¤§ä¸èƒ½è¶…è¿‡ 1M (redis ä¸­å®šä¹‰ä¸º <code>SDS_MAX_PREALLOC</code>)ã€‚</p><p>è¿™æ ·ï¼Œ redis å°±èƒ½ååˆ†æ–¹ä¾¿çš„è·å– string é•¿åº¦(O(1))ï¼Œå‡å°‘å†…å­˜æ‰©å®¹ã€‚</p><p>åŒæ ·ï¼Œè¿™ç§ç­–ç•¥ä¼šé¢„åˆ†é…å†…å­˜ï¼Œäº§ç”Ÿä¸å¿…è¦çš„å†…å­˜æµªè´¹ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ç»å¸¸ append huge strings æ—¶ï¼Œå°±ä¼šäº§ç”Ÿå¾ˆå¤šä¸å¿…è¦çš„æµªè´¹ã€‚</p><p>redis åœ¨ 3.2 ç‰ˆæœ¬åï¼Œå¯¹æ­¤åšäº†ä¼˜åŒ–ï¼Œä¼šæ ¹æ® string çš„é•¿åº¦ï¼Œé€‰æ‹©ä¸åŒçš„ SDS type</p><pre class=" language-c"><code class="language-c"><span class="token keyword">static</span> <span class="token keyword">inline</span> <span class="token keyword">char</span> <span class="token function">sdsReqType</span><span class="token punctuation">(</span>size_t string_size<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>string_size <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// 32</span>        <span class="token keyword">return</span> SDS_TYPE_5<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>string_size <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 256</span>        <span class="token keyword">return</span> SDS_TYPE_8<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>string_size <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 65536 å³ 64 * 1024 = 64k</span>        <span class="token keyword">return</span> SDS_TYPE_16<span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">if</span> (LONG_MAX == LLONG_MAX)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>string_size <span class="token operator">&lt;</span> <span class="token number">1ll</span><span class="token operator">&lt;&lt;</span><span class="token number">32</span><span class="token punctuation">)</span>         <span class="token keyword">return</span> SDS_TYPE_32<span class="token punctuation">;</span>    <span class="token keyword">return</span> SDS_TYPE_64<span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">else</span></span>    <span class="token keyword">return</span> SDS_TYPE_32<span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">endif</span></span><span class="token punctuation">}</span></code></pre><p>strings æŒ‡ä»¤ï¼š</p><blockquote><p>inrc / decr / incrby / decrby ï¼šåŸå­é€’å¢/é€’å‡ </p></blockquote><p>å¯ä»¥ç”¨æ¥ç»Ÿè®¡è®¿é—®é‡ / ç‚¹èµé‡ / è½¬å‘é‡ ç­‰å„ç§ç†Ÿè·¯</p><pre class=" language-bash"><code class="language-bash">127.0.0.1:6379<span class="token operator">></span> <span class="token keyword">set</span> counter 18OK<span class="token comment" spellcheck="true"># åŸå­é€’å¢</span>127.0.0.1:6379<span class="token operator">></span> INCR counter<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 19<span class="token comment" spellcheck="true"># åŸå­é€’å‡</span>127.0.0.1:6379<span class="token operator">></span> DECR counter<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 18<span class="token comment" spellcheck="true"># æ­¥é•¿é€’å¢</span>127.0.0.1:6379<span class="token operator">></span> INCRBY counter 18<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 36<span class="token comment" spellcheck="true"># æ­¥é•¿é€’å‡</span>127.0.0.1:6379<span class="token operator">></span> DECRBY counter 18<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 18127.0.0.1:6379<span class="token operator">></span> get counter<span class="token string">"18"</span></code></pre><hr><blockquote><p>get / set / getset / append ï¼š è·å– / è®¾ç½® / è®¾ç½®åŒæ—¶è¿”å›å€¼ /  è¿½åŠ </p><p>mget / mset ï¼š æ‰¹é‡è·å– / è®¾ç½®</p></blockquote><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ä»¥ key value å½¢å¼ set</span>127.0.0.1:6379<span class="token operator">></span> MSET k1 v1 k2 v2 k3 v3OK127.0.0.1:6379<span class="token operator">></span> MGET k1 k2 k31<span class="token punctuation">)</span> <span class="token string">"v1"</span>2<span class="token punctuation">)</span> <span class="token string">"v2"</span>3<span class="token punctuation">)</span> <span class="token string">"v3"</span></code></pre><hr><blockquote><p>setex ï¼š è®¾ç½® value å’Œè¿‡æœŸæ—¶é—´</p></blockquote><pre class=" language-bash"><code class="language-bash">127.0.0.1:6379<span class="token operator">></span> SETEX exp1 10 expv1OK<span class="token comment" spellcheck="true"># è·å–è¿‡æœŸæ—¶é—´ï¼Œ è¿˜æœ‰ 7 ç§’</span>127.0.0.1:6379<span class="token operator">></span> ttl exp1<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 7127.0.0.1:6379<span class="token operator">></span> get exp1<span class="token string">"expv1"</span><span class="token comment" spellcheck="true"># æ­¤æ—¶æŸ¥è¯¢æ—¶å·²è¿‡æœŸ</span>127.0.0.1:6379<span class="token operator">></span> get exp1<span class="token punctuation">(</span>nil<span class="token punctuation">)</span></code></pre><hr><blockquote><p>setnx / strlen ï¼š set not existsï¼Œå³æ²¡æœ‰æ—¶ï¼Œæ‰ç”Ÿæ•ˆ / è·å– value é•¿åº¦</p></blockquote><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æ—  nx è¿™ä¸ª key æ—¶ï¼Œ è®¾ç½®æˆåŠŸ</span>127.0.0.1:6379<span class="token operator">></span> SETNX nx nxv<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 1127.0.0.1:6379<span class="token operator">></span> get nx<span class="token string">"nxv"</span><span class="token comment" spellcheck="true"># æœ‰ nx è¿™ä¸ª key æ—¶ï¼Œ è®¾ç½®å¤±è´¥</span>127.0.0.1:6379<span class="token operator">></span> SETNX nx nxvvvvvv<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 0127.0.0.1:6379<span class="token operator">></span> get nx<span class="token string">"nxv"</span><span class="token comment" spellcheck="true"># è·å– key ä¸º nx çš„ value é•¿åº¦</span>127.0.0.1:6379<span class="token operator">></span> STRLEN nx<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 3127.0.0.1:6379<span class="token operator">></span> get nx<span class="token string">"nxv"</span></code></pre><hr><p>æ›´å¤š strings ç›¸å…³å‘½ä»¤å‚è§ <a href="https://redis.io/commands#string" target="_blank" rel="noopener">è¿™é‡Œ</a></p><h3 id="2-Lists"><a href="#2-Lists" class="headerlink" title="2. Lists"></a>2. Lists</h3><p>redis çš„ list æ˜¯ <strong>linkedList</strong> ï¼Œ æ˜¯æ ¹æ®æ’å…¥é¡ºå¯»æ’åˆ—çš„ string å…ƒç´ çš„é›†åˆï¼Œ ä¸€ä¸ª list æœ€å¤§é•¿åº¦ä¸º <strong>2<sup>32</sup> -1</strong> ã€‚</p><p>list èŠ‚ç‚¹ / è¿­ä»£å™¨ / list å®šä¹‰å¦‚ä¸‹ï¼š</p><pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> listNode <span class="token punctuation">{</span>    <span class="token keyword">struct</span> listNode <span class="token operator">*</span>prev<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å¤´èŠ‚ç‚¹</span>    <span class="token keyword">struct</span> listNode <span class="token operator">*</span>next<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å°¾èŠ‚ç‚¹</span>    <span class="token keyword">void</span> <span class="token operator">*</span>value<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å€¼ï¼Œ void * è¡¨æ˜ value å¯ä»¥æ˜¯ä»»æ„ç±»å‹</span><span class="token punctuation">}</span> listNode<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> listIter <span class="token punctuation">{</span>    listNode <span class="token operator">*</span>next<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span>    <span class="token keyword">int</span> direction<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// éå†æ–¹å‘</span><span class="token punctuation">}</span> listIter<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> list <span class="token punctuation">{</span>    listNode <span class="token operator">*</span>head<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å¤´èŠ‚ç‚¹</span>    listNode <span class="token operator">*</span>tail<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å°¾èŠ‚ç‚¹</span>    <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>dup<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å¤åˆ¶èŠ‚ç‚¹ func</span>    <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>free<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// é‡Šæ”¾èŠ‚ç‚¹ func</span>    <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>match<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ¯”è¾ƒä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦ç›¸ç­‰</span>    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> len<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// é“¾è¡¨é•¿åº¦</span><span class="token punctuation">}</span> list<span class="token punctuation">;</span></code></pre><p>ç”±æ­¤å¯è§ï¼Œ redis ä¸­çš„ list æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚åŒæ—¶ä¼šä¿å­˜å¤´å°¾èŠ‚ç‚¹å’Œé•¿åº¦ï¼Œæ‰€ä»¥è·å–ä»–ä»¬çš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸º O(1)</p><p>æ‰€ä»¥ï¼Œ LPUSHï¼ŒRPUSHï¼Œ RPOPï¼Œ LPOP ï¼ŒRPOPLPUSH ï¼Œ LLEN ç­‰æ“ä½œéƒ½ååˆ†é«˜æ•ˆ</p><p>Lists æŒ‡ä»¤ï¼š</p><blockquote><p>LPUSH / RPUSH ï¼š ä»å¤´éƒ¨ / å°¾éƒ¨æ’å…¥å…ƒç´ </p></blockquote><pre class=" language-bash"><code class="language-bash">127.0.0.1:6379<span class="token operator">></span> LPUSH list l1 l2<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 2127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"l2"</span>2<span class="token punctuation">)</span> <span class="token string">"l1"</span>127.0.0.1:6379<span class="token operator">></span> RPUSH list r1 r2<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 4127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"l2"</span>2<span class="token punctuation">)</span> <span class="token string">"l1"</span>3<span class="token punctuation">)</span> <span class="token string">"r1"</span>4<span class="token punctuation">)</span> <span class="token string">"r2"</span>127.0.0.1:6379<span class="token operator">></span> del list</code></pre><hr><blockquote><p>LRANGE ï¼š ä»åˆ—è¡¨ä¸­æ‹¿å‡ºä¸€ä¸ª range ã€‚</p></blockquote><ul><li>æ³¨æ„è¿™ä¸ª range æ˜¯ <strong>é—­åˆ</strong> çš„ï¼Œæ¯”å¦‚ä½ æ‰§è¡Œ <code>lrange list 0 1</code> ï¼Œå³ [0, 1] è€Œé [0, 1) ã€‚ </li><li>è´Ÿæ•°è¡¨ç¤ºå€’æ•°ï¼Œ å¦‚ [0, -1] ï¼Œè¡¨ç¤ºä» 0 åˆ°æœ€åä¸€ä¸ªæ•°ï¼Œå³è¯¥ list çš„å…¨éƒ¨å…ƒç´ </li></ul><pre class=" language-bash"><code class="language-bash">127.0.0.1:6379<span class="token operator">></span> RPUSH list v1 v2 v3<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 3127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"v1"</span>2<span class="token punctuation">)</span> <span class="token string">"v2"</span>3<span class="token punctuation">)</span> <span class="token string">"v3"</span>127.0.0.1:6379<span class="token operator">></span> del list</code></pre><p>æˆ‘ä»¬ç»“åˆ LPUSH + LRANGE ï¼Œå¯ä»¥ç®€å•çš„å®ç° timeline åŠŸèƒ½</p><hr><blockquote><p> LTRIMï¼šä»å¤´éƒ¨æˆªå–æŒ‡å®šé•¿åº¦ slice å¹¶å­˜å…¥è¯¥ key ä¸­</p></blockquote><pre class=" language-bash"><code class="language-bash">127.0.0.1:6379<span class="token operator">></span> lpush list v1 v2 v3<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 3127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"v3"</span>2<span class="token punctuation">)</span> <span class="token string">"v2"</span>3<span class="token punctuation">)</span> <span class="token string">"v1"</span><span class="token comment" spellcheck="true"># è¿™é‡Œä»å¤´æˆªå– [0, 1] é•¿åº¦çš„ slice å¹¶å­˜å…¥åˆ° list ä¸­</span>127.0.0.1:6379<span class="token operator">></span> LTRIM list 0 1OK127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"v3"</span>2<span class="token punctuation">)</span> <span class="token string">"v2"</span>127.0.0.1:6379<span class="token operator">></span> del list</code></pre><p>LPUSH + LTRIM çš„ç»„åˆï¼Œå¯ä»¥å®ç°ä¸€ä¸ªç®€å•çš„å®šé•¿ list ï¼Œè¯¥ list ç»´æŠ¤æŒ‡å®šé•¿åº¦çš„æœ€æ–°å…ƒç´ </p><hr><blockquote><p>LINSERT : åœ¨æŒ‡å®šå…ƒç´ å‰/åæ’å…¥åŸè‰²</p></blockquote><pre class=" language-bash"><code class="language-bash">127.0.0.1:6379<span class="token operator">></span> lpush list val<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 1127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"val"</span><span class="token comment" spellcheck="true"># val å‰æ’å…¥</span>127.0.0.1:6379<span class="token operator">></span> linsert list before val val-before<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 2127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"val-before"</span>2<span class="token punctuation">)</span> <span class="token string">"val"</span><span class="token comment" spellcheck="true"># val åæ’å…¥</span>127.0.0.1:6379<span class="token operator">></span> LINSERT list after val val-after<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 3127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"val-before"</span>2<span class="token punctuation">)</span> <span class="token string">"val"</span>3<span class="token punctuation">)</span> <span class="token string">"val-after"</span><span class="token comment" spellcheck="true"># åœ¨ä¸€ä¸ªä¸å­˜åœ¨çš„å…ƒç´ å‰æ’å…¥ï¼Œè¿”å› -1 ï¼Œ æ’å…¥å¤±è´¥</span>127.0.0.1:6379<span class="token operator">></span> LINSERT list before noexist noexist<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> -1127.0.0.1:6379<span class="token operator">></span> lrange list 0 -11<span class="token punctuation">)</span> <span class="token string">"val-before"</span>2<span class="token punctuation">)</span> <span class="token string">"val"</span>3<span class="token punctuation">)</span> <span class="token string">"val-after"</span>127.0.0.1:6379<span class="token operator">></span> del list</code></pre><hr><blockquote><p>LPOP / RPOP</p></blockquote><p>æ‹¿åˆ°å¹¶åˆ é™¤ å¤´éƒ¨ / å°¾éƒ¨ å…ƒç´ </p><pre class=" language-bash"><code class="language-bash">127.0.0.1:6379<span class="token operator">></span> rpush list <span class="token function">head</span> middle <span class="token function">tail</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 3127.0.0.1:6379<span class="token operator">></span> lrange list 0 -11<span class="token punctuation">)</span> <span class="token string">"head"</span>2<span class="token punctuation">)</span> <span class="token string">"middle"</span>3<span class="token punctuation">)</span> <span class="token string">"tail"</span>127.0.0.1:6379<span class="token operator">></span> LPOP list<span class="token string">"head"</span>127.0.0.1:6379<span class="token operator">></span> RPOP list<span class="token string">"tail"</span>127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"middle"</span>127.0.0.1:6379<span class="token operator">></span> del list</code></pre><hr><blockquote><p>LREM key count element ï¼š åˆ é™¤å…ƒç´ </p></blockquote><ul><li>count &gt; 0 æ—¶ï¼Œ <strong>ä»å¤´åˆ°å°¾</strong> åˆ é™¤ä¸ element ç›¸ç­‰çš„å…ƒç´ ï¼Œ åˆ é™¤ count ä¸ª</li><li>count &lt; 0 æ—¶ï¼Œ <strong>ä»å°¾åˆ°å¤´</strong> åˆ é™¤ä¸ element ç›¸ç­‰çš„å…ƒç´ ï¼Œ åˆ é™¤ count ä¸ª</li><li>count = 0 æ—¶ï¼Œ åˆ é™¤æ‰€æœ‰ä¸ element ç›¸ç­‰çš„å…ƒç´ </li></ul><pre class=" language-bash"><code class="language-bash">127.0.0.1:6379<span class="token operator">></span> RPUSH list 1 2 1 2 1 2<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 6<span class="token comment" spellcheck="true"># ä»å¤´åˆ°å°¾éå†ï¼Œåˆ é™¤ä¸€ä¸ªå…ƒç´  2</span>127.0.0.1:6379<span class="token operator">></span> LREM list 1 2<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 1127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"1"</span> 2<span class="token punctuation">)</span> <span class="token string">"1"</span> 3<span class="token punctuation">)</span> <span class="token string">"2"</span> 4<span class="token punctuation">)</span> <span class="token string">"1"</span> 5<span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token comment" spellcheck="true"># ä»å°¾åˆ°å¤´éå†ï¼Œ åˆ é™¤ä¸€ä¸ªå…ƒç´  2</span>127.0.0.1:6379<span class="token operator">></span> LREM list -1 2<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 1127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"1"</span> 2<span class="token punctuation">)</span> <span class="token string">"1"</span> 3<span class="token punctuation">)</span> <span class="token string">"2"</span> 4<span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token comment" spellcheck="true"># åˆ é™¤æ‰€æœ‰ä¸º 1 çš„å…ƒç´ </span>127.0.0.1:6379<span class="token operator">></span> LREM list 0 1<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 3127.0.0.1:6379<span class="token operator">></span> LRANGE list 0 -11<span class="token punctuation">)</span> <span class="token string">"2"</span></code></pre><hr><blockquote><p>RPOPLPUSH  source dest </p></blockquote><p>å–å‡º source å°¾èŠ‚ç‚¹æ”¾åˆ° dest çš„å¤´èŠ‚ç‚¹</p><ul><li>å¦‚æœ source ä¸å­˜åœ¨ï¼Œè¿”å› nil ï¼Œ ä¸æ‰§è¡Œä»»ä½•æ“ä½œ</li><li>å¦‚æœ dest ä¸å­˜åœ¨ï¼Œåˆ›å»º destï¼Œå¹¶æ‰§è¡Œæ“ä½œ</li><li>å¦‚æœ source tail å…ƒç´  å’Œ dest head å…ƒç´ ä¸€è‡´ï¼Œä¾æ—§ä¼š push</li><li>å¦‚æœ source å’Œ dest æ˜¯åŒä¸€ä¸ª list ï¼Œè¿™ä¸ª list å°±å˜æˆäº†ä¸€ä¸ª circular list</li></ul><pre class=" language-bash"><code class="language-bash">127.0.0.1:6379<span class="token operator">></span> LRANGE <span class="token function">source</span> 0 -11<span class="token punctuation">)</span> <span class="token string">"s"</span> 2<span class="token punctuation">)</span> <span class="token string">"s"</span><span class="token comment" spellcheck="true"># source(è¿™é‡ŒæŒ‡ noexist) ä¸å­˜åœ¨ï¼Œ è¿”å› nil</span>127.0.0.1:6379<span class="token operator">></span> RPOPLPUSH noexist <span class="token function">source</span><span class="token punctuation">(</span>nil<span class="token punctuation">)</span>127.0.0.1:6379<span class="token operator">></span> LRANGE <span class="token function">source</span> 0 -11<span class="token punctuation">)</span> <span class="token string">"s"</span> 2<span class="token punctuation">)</span> <span class="token string">"s"</span><span class="token comment" spellcheck="true"># åªæœ‰ source</span>127.0.0.1:6379<span class="token operator">></span> keys *1<span class="token punctuation">)</span> <span class="token string">"source"</span><span class="token comment" spellcheck="true"># dest ä¸å­˜åœ¨ï¼Œä½†æ˜¯ä¼šè¢«åˆ›å»º</span>127.0.0.1:6379<span class="token operator">></span> RPOPLPUSH <span class="token function">source</span> dest<span class="token string">"s"</span>127.0.0.1:6379<span class="token operator">></span> LRANGE dest 0 -11<span class="token punctuation">)</span> <span class="token string">"s"</span><span class="token comment" spellcheck="true"># ç›¸åŒçš„ä¸¤ä¸ªå…ƒç´ ï¼Œä¸ä¼šè¢«è¦†ç›–</span>127.0.0.1:6379<span class="token operator">></span> RPOPLPUSH <span class="token function">source</span> dest<span class="token string">"s"</span>127.0.0.1:6379<span class="token operator">></span> LRANGE dest 0 -11<span class="token punctuation">)</span> <span class="token string">"s"</span> 2<span class="token punctuation">)</span> <span class="token string">"s"</span></code></pre><hr><blockquote><p>BLPOP key1 key2 key3â€¦ timeout</p></blockquote><p>LPOP çš„é˜»å¡ç‰ˆæœ¬ï¼Œå³ key1 , key2, key3 â€¦ ä»»ä¸€ç›‘å¬çš„ key ä¸­éƒ½æ²¡æœ‰å€¼æ—¶ï¼Œä¼šé˜»å¡åˆ° timeout ï¼Œtimeout ä¸º 0 è¡¨ç¤ºä¸€ç›´é˜»å¡</p><ul><li><p>key1 -&gt; key2 -&gt; key3 æŒ‰åºæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å€¼</p></li><li><p>å¤šä¸ª client ç›‘å¬åŒä¸€ä¸ª key æ—¶ï¼ŒæŒ‰ç›‘å¬æ—¶é—´çš„æ—©æ™šï¼Œä¾æ¬¡è¿”å›ç»™ client ï¼Œclient æ¥æ”¶åˆ°åï¼Œä¸‹æ¬¡ç›‘å¬éœ€è¦é‡æ–°æ’é˜Ÿ</p></li><li><p>multi æ“ä½œä¸€æ¬¡å¡å…¥å¤šä¸ªå€¼æ—¶ï¼Œä¼šå…ˆæ‰§è¡Œå®Œ multi æ“ä½œï¼Œç„¶åè¿”å›å¹¶åˆ é™¤å¤´èŠ‚ç‚¹</p><hr></li></ul><blockquote><p>BRPOP / BRPOPLPUSH</p></blockquote><p>BRPOP åŠŸèƒ½å‚è€ƒ BLPOPï¼Œ å³é˜»å¡ç‰ˆæœ¬çš„ RPOPï¼Œè·å–å¹¶åˆ é™¤å°¾èŠ‚ç‚¹</p><p>BRPOPLPUSH å³é˜»å¡ç‰ˆæœ¬çš„ RPOPLPUSH ï¼Œä» source è·å–å°¾èŠ‚ç‚¹å¹¶æ”¾åˆ° dest çš„å¤´éƒ¨</p><hr><p>æ›´å¤š lists çš„æ“ä½œå‘½ä»¤å‚è€ƒ <a href="https://redis.io/commands#list" target="_blank" rel="noopener">è¿™é‡Œ</a></p><h3 id="3-Sets"><a href="#3-Sets" class="headerlink" title="3. Sets"></a>3. Sets</h3><p>sets åº•å±‚ä¸»è¦åŸºäº hash è¡¨å’Œ inset æ•°æ®ç»“æ„å®ç°ã€‚</p><p><strong>æ— åºä¸”å»é‡</strong>çš„ set é›†åˆï¼Œæœ€å¤§å¯å­˜å‚¨ 2<sup>32</sup> -1 ä¸ªå…ƒç´ ã€‚</p><blockquote><p>SADD key ele1 ele2 ele3 â€¦</p><p>SCARD / SMEMBERS key</p><p>SISMEMBER key ele</p></blockquote><p>æ·»åŠ  / è·å– set å…ƒç´ æ•°é‡ / è·å– set æ‰€æœ‰å…ƒç´  / ç¡®å®šä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­</p><hr><blockquote><p>SDIFF key1 key2 key3 â€¦</p><p>SDIFFSTORE dest key1 key2</p></blockquote><ul><li>sdiff ï¼šè·å– key1 ä¸ key2ï¼Œ key3 çš„<strong>å·®é›†</strong>ï¼Œå³ key2 ä¸å­˜åœ¨ä¸ key2ï¼Œ key3 ä¸­çš„å…ƒç´ </li><li>sdiffstoreï¼šä¸ <code>LRPOPLPUSH</code> ç±»ä¼¼ï¼Œå°† sdiff çš„ç»“æœæ”¾åˆ° dest set ä¸­ï¼Œæ³¨æ„ï¼Œå¦‚æœ dest ä¸­æœ‰å…ƒç´ ï¼Œåˆ™å…ƒç´ ä¼šè¢«æ¸…ç©º</li></ul><hr><blockquote><p>SINTER key key1 key</p><p>SINTERSTORE dest key key1 key2</p></blockquote><p>ä¸ sdiff /sdiffstore ç±»ä¼¼ï¼Œè¿™ç»„å‘½ä»¤æ˜¯å– <strong>äº¤é›†</strong></p><hr><blockquote><p>SUNION key1 key2 key3 â€¦</p><p>SUNIONSTORE dest key1 key2 key3 â€¦</p></blockquote><p>åŒæ ·ï¼Œè¿™é‡Œå–å¹¶é›†</p><hr><blockquote><p>SMOVE source dest ele</p><p>SREM key ele1 ele2</p></blockquote><ul><li>ç§»åŠ¨ source ä¸­çš„ ele åˆ° dest é›†åˆä¸­</li><li>å°† key ä¸­å…ƒç´  ele1 ele2 åˆ é™¤</li></ul><hr><blockquote><p>SRANDMEMBER / SPOP</p></blockquote><ul><li><p>srandmember key count ï¼š ä» set ä¸­éšæœºå–å‡ºå…ƒç´ </p><ul><li>0 â‰¤ count â‰¤ set length ï¼šéšæœºè¿”å› count ä¸ªå…ƒç´ , <strong>æ— æ”¾å›éšæœº</strong></li><li>count &gt; set length ï¼š è¿”å›å…¨éƒ¨ set å…ƒç´ </li><li>count ä¸ºè´Ÿæ•°æ—¶ï¼Œ éšæœºè¿”å› count ä¸ªå…ƒç´ ï¼Œæ­¤æ—¶ä¸º <strong>æœ‰æ”¾å›éšæœº</strong> ï¼Œ è¿™ä¹Ÿæ„å‘³ç€ï¼Œ count å¯ä»¥ä¸ºä¸€ä¸ªç»å¯¹å€¼å¤§äº set length çš„è´Ÿæ•°ã€‚</li></ul></li><li><p>spop key count ï¼š spop çš„ count ä¸èƒ½ä¸ºè´Ÿæ•°ï¼Œå…¶ä»–è¡Œä¸ºä¸ srandmember ä¸€è‡´ï¼Œspop ä¼šåŒæ—¶åˆ é™¤å–å‡ºçš„å…ƒç´ </p><hr></li></ul><blockquote><p>SSCAN key cursor [MATCH pattern] count</p></blockquote><p>æ˜¯ä¸€ä¸ªåŸºäºæ¸¸æ ‡çš„è¿­ä»£å™¨ã€‚å®ƒä¼šè¿”å›æ¸¸æ ‡ä»¥åŠæŸ¥è¯¢åˆ°çš„å…ƒç´ ã€‚</p><p>è¯¥å‘½ä»¤ä¿è¯</p><ul><li>ä»å®Œæ•´éå†å¼€å§‹åˆ°ç»“æŸï¼Œæ‰€æœ‰å­˜åœ¨äº key ä¸­çš„å…ƒç´ éƒ½ä¼šè¢«è¿”å›</li><li>å¼€å§‹å‰è¢«ç§»é™¤ä¸”ç›´åˆ°ç»“æŸéƒ½æœªåŠ å…¥çš„å…ƒç´ ï¼Œä¸ä¼šè¢«è¿”å›</li><li>åŒä¸€ä¸ªå…ƒç´ å¯èƒ½è¢«è¿­ä»£å¤šæ¬¡</li><li>ä¸€ä¸ªå…ƒç´ åœ¨è¿­ä»£è¿‡ç¨‹ä¸­è¢«æ·»åŠ æˆ–åˆ é™¤ï¼Œä¸ä¿è¯ä¸€å®šè¿”å›æˆ–ä¸è¿”å›</li></ul><hr><p>æ›´å¤š Sets ç›¸å…³å‘½ä»¤å‚è§ <a href="https://redis.io/commands#set" target="_blank" rel="noopener">è¿™é‡Œ</a></p><h3 id="4-Sorted-sets"><a href="#4-Sorted-sets" class="headerlink" title="4. Sorted sets"></a>4. Sorted sets</h3><p>sorted sets åº•å±‚ä¸»è¦åŸºäº è·³è·ƒè¡¨ å®ç°ï¼Œå…³äºè·³è·ƒè¡¨ï¼Œä½œè€…è¡¨ç¤ºä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œéœ€è¦å…ˆå»åŠ å¼ºä¸€æ³¢å­¦ä¹ ï¼Œè¿™é‡Œä¸å†å±•å¼€ï¼Œå¯å‚è€ƒæ–‡æœ«çš„ reference ç³»åˆ—æ–‡ç« ã€‚</p><p>sorted sets ä¸ sets ååˆ†ç±»ä¼¼ï¼Œä½†æ˜¯ sorted sets ä¼šç»™æ¯ä¸ª element æ·»åŠ ä¸€ä¸ª scoreï¼Œç”¨æ¥ç»™å…ƒç´ æ’åºã€‚sorted sets ä¸å…è®¸ç›¸åŒçš„å…ƒç´ ï¼Œä½†è¿è¡Œç›¸åŒåˆ†æ•°çš„å…ƒç´ ã€‚å½“æŸ¥è¯¢å¤šä¸ªç›¸åŒåˆ†æ•°çš„å…ƒç´ æ—¶ï¼Œè¿”å›ç»“æœä¸ºå…ƒç´ çš„å­—å…¸æ’åº</p><blockquote><p>ZADD  key [XX|NX] [CH] [INCR] score ele â€¦</p></blockquote><p>æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ åˆ° sorted setã€‚</p><p>XX ï¼š ä»…æ›´æ–°å·²å­˜åœ¨çš„å…ƒç´ ï¼Œä¸æ·»åŠ æ–°å…ƒç´ </p><p>NX ï¼š åªæ·»åŠ æ–°æˆå‘˜ï¼Œä¸æ›´æ–°å·²å­˜åœ¨çš„å…ƒç´ </p><p>CH ï¼š è¿”å›å‘ç”Ÿå˜åŒ–çš„å…ƒç´ æ€»æ•°ï¼Œä¸æ·»åŠ åˆ™è¿”å›æ·»åŠ çš„å…ƒç´ æ€»æ•°</p><p>INCR ï¼š ç›¸å½“äº ZINCRBY ï¼Œä¸ºå…ƒç´ åˆ†æ•°åšé€’å¢æ“ä½œï¼Œä½¿ç”¨è¯¥é€‰é¡¹æ—¶ï¼Œä¸€æ¬¡åªèƒ½æ›´æ–°ä¸€ä¸ªå…ƒç´ </p><hr><blockquote><p>ZCARD key </p><p>ZCOUNT key min max</p><p>ZSCORE key ele</p></blockquote><ul><li>zcard key è¿”å› key æ‰€æœ‰å…ƒç´ æ•°é‡</li><li>zcount key min mzx è¿”å›æŒ‡å®š [min, max] åˆ†æ•°ä¸­çš„æ‰€æœ‰å…ƒç´ æ•°é‡</li><li>æŸ¥è¯¢ç»™å®šå…ƒç´ åˆ†æ•°</li></ul><hr><blockquote><p>ZLEXCOUNT key [min_ele [max_ele</p></blockquote><p>æŸ¥è¯¢ min ele å’Œ max ele ä¹‹é—´çš„å…ƒç´ ä¸ªæ•°ï¼ŒåŒ…å«æœ¬èº«ï¼Œæ˜¯é—­åŒºé—´ï¼</p><ul><li>æŸ¥è¯¢çš„å…ƒç´ å‰è¦åŠ  <strong>[</strong>  ï¼Œå¦‚ <code>zlexcount sset [min [max</code></li><li><code>-</code> (å‡å·) ï¼Œ <code>+</code> (åŠ å·) åˆ†åˆ«è¡¨ç¤ºæœ€å°åˆ†æ•°å’Œæœ€å¤§åˆ†æ•°å…ƒç´ ï¼Œ å¦‚ <code>zlexcount sset - +</code> ï¼Œåˆ™è¿”å› sset è¿™ä¸ª key ä¸­çš„æ‰€æœ‰å…ƒç´ ä¸ªæ•°</li></ul><hr><blockquote><p>ZINTERSTORE dest num key1 key2 [weights] [aggregate] </p></blockquote><p>å¯¹ key1 key2 å–äº¤é›†ï¼Œæ”¾å…¥ dest ä¸­ï¼Œè‹¥ dest å·²å­˜åœ¨ï¼Œåˆ™ä¼šæ¸…ç©º dest åæ”¾å…¥ç»“æœé›†</p><ul><li>num ï¼Œå¿…é¡»çº³å…¥äº¤é›†è®¡ç®—çš„ key çš„ä¸ªæ•°ï¼Œè¿™é‡Œ num åº”è¯¥ä¸º 2</li><li>weights ï¼š åœ¨å­˜å…¥ dest ä¹‹å‰ï¼Œä¼šæŒ‰ç…§ç»™å®šçš„ weights ä¸å…ƒç´  <strong>ç›¸ä¹˜</strong> ï¼Œé»˜è®¤ä¸º 1</li><li>aggregate ï¼š èšåˆæ–¹å¼ï¼Œ MAX ï¼Œ MIN ï¼Œ SUM ï¼Œé»˜è®¤ SUM</li></ul><pre class=" language-bash"><code class="language-bash">127.0.0.1:6379<span class="token operator">></span> ZADD a 1 1 1 2 1 3<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 3127.0.0.1:6379<span class="token operator">></span> ZADD b 2 2 2 3 2 4<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 3127.0.0.1:6379<span class="token operator">></span> ZADD c 3 3 3 4 3 5<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 3<span class="token comment" spellcheck="true"># å¯¹ a ä¸­äº¤é›†çš„å…ƒç´ (3) çš„åˆ†æ•°(1) * 10 = 10ï¼Œèšåˆæ–¹å¼ä¸ºå–æœ€å¤§å€¼</span><span class="token comment" spellcheck="true"># æ‰€ä»¥èšåˆç»“æœæ˜¯ ele=3 score=10</span>127.0.0.1:6379<span class="token operator">></span> ZINTERSTORE dest 3 a b c weights 10 1 1 aggregate MAX<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 1127.0.0.1:6379<span class="token operator">></span> ZRANGE dest 0 -1 withscores1<span class="token punctuation">)</span> <span class="token string">"3"</span>2<span class="token punctuation">)</span> <span class="token string">"10"</span></code></pre><hr><blockquote><p>ZPOPMAX / ZPOPMIN key [count]</p><p>ZRANGE / ZREVRANGE key start stop [withscores]</p><p>ZRANGEBYLEX / ZREVRANGEBYLEX  key [min [max [limit offset count]</p><p>ZRANGEBYSCORE</p></blockquote><ul><li><p>è·å–å¹¶åˆ é™¤ç»™å®š count ä¸ªå…ƒç´ ï¼ŒæŒ‰ç…§ score çš„æœ€å¤§å€¼ / æœ€å°å€¼æ’åº</p></li><li><p>æŒ‰ç…§åˆ†æ•°ä»å°åˆ°å¤§(zrevrange ä»å¤§åˆ°å°) æ’åºï¼Œscore ç›¸åŒåˆ™æŒ‰ç…§å­—å…¸åºæ’åˆ—</p></li><li><p>zrangebylex ï¼š æŒ‰å­—å…¸æ’åºï¼Œè·å– [min, max] ä¸­å…ƒç´ ï¼Œ<strong>ä¸è¦åœ¨ score ä¸ä¸€è‡´çš„ key ä¸­ä½¿ç”¨è¯¥æŒ‡ä»¤</strong>ï¼Œå› ä¸ºè·å–çš„ç»“æœä¼šä¸å‡†</p><ul><li>min , max å‚è€ƒ zlexcount è¯´æ˜ï¼Œ ä½¿ç”¨ <strong>(</strong>  è·å–å¼€åŒºé—´ç»“æœé›†</li><li>limit offset count ï¼š æ˜¯å¦åˆ†é¡µï¼Œ offset ï¼Œ count åˆ†åˆ«ä¸ºèµ·å§‹ä½ç½®å’Œè¿”å›ç»“æœæ•°é‡</li><li>ä»¥ ASCII å­—ç¬¦é›†æ’åºï¼Œæ‰€ä»¥å¯¹å¤§å°å†™æ•æ„Ÿï¼Œå¯¹ utf-8 å­—ç¬¦é›†ä¸å‹å¥½</li></ul></li></ul><hr><blockquote><p>ZRANK key element</p><p>ZREVRANK key element</p></blockquote><p>ä»å°åˆ°å¤§(zrevrank ä»å¤§åˆ°å°) è·å–æŒ‡å®š ele çš„ index</p><hr><blockquote><p>ZREM key ele1, ele2 â€¦</p><p>ZREMRANGEBYRANK key start stop â€¦</p><p>ZREMRANGEBYLEX key min max</p><p>ZREMRANGEBYSCORE key min max</p></blockquote><ul><li>åˆ é™¤æŒ‡å®šå…ƒç´ </li><li>æŒ‰ç…§ç»™å®šç´¢å¼•åˆ é™¤</li><li>æŒ‰ç…§ç»™å®šå…ƒç´ åŒºé—´ï¼ŒæŒ‰ç…§å­—å…¸åºåˆ é™¤</li><li>æŒ‰ç…§ç»™å®šåˆ†æ•°åŒºé—´åˆ é™¤</li></ul><hr><p>æ›´å¤š Sorted Sets ç›¸å…³å‘½ä»¤å‚è§ <a href="https://redis.io/commands#sorted_set" target="_blank" rel="noopener">è¿™é‡Œ</a></p><h3 id="5-Hashes"><a href="#5-Hashes" class="headerlink" title="5. Hashes"></a>5. Hashes</h3><p>hash åœ¨ redis åº•å±‚æ˜¯é€šè¿‡ dict æ•°æ®ç»“æ„æ¥å®ç°çš„ï¼Œå³å­—å…¸ï¼Œjava ä¸­çš„ map ï¼Œéƒ½æ˜¯ç±»ä¼¼çš„æ•°æ®ç»“æ„</p><pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> dictEntry <span class="token punctuation">{</span>    <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">;</span>    <span class="token keyword">union</span> <span class="token punctuation">{</span>        <span class="token keyword">void</span> <span class="token operator">*</span>val<span class="token punctuation">;</span>        uint64_t u64<span class="token punctuation">;</span>        int64_t s64<span class="token punctuation">;</span>        <span class="token keyword">double</span> d<span class="token punctuation">;</span>    <span class="token punctuation">}</span> v<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// hash å†²çªæ—¶ï¼Œè®°å½•ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span>    <span class="token keyword">struct</span> dictEntry <span class="token operator">*</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span> dictEntry<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> dictht <span class="token punctuation">{</span>    dictEntry <span class="token operator">*</span><span class="token operator">*</span>table<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> size<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sizemask<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> used<span class="token punctuation">;</span><span class="token punctuation">}</span> dictht<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> dict <span class="token punctuation">{</span>    dictType <span class="token operator">*</span>type<span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token operator">*</span>privdata<span class="token punctuation">;</span>    dictht ht<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å“ˆå¸Œè¡¨ï¼Œ æœ€å¤šå¯èƒ½ä¼šç»´æŠ¤ä¸¤å¼ å“ˆå¸Œè¡¨</span>    <span class="token keyword">long</span> rehashidx<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* rehashing not in progress if rehashidx == -1 */</span>    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> iterators<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* number of iterators currently running */</span><span class="token punctuation">}</span> dict<span class="token punctuation">;</span></code></pre><p>å½“å‡ºç° hash å†²çªæ—¶ï¼Œ redis ä¼šé€šè¿‡ä¸€ä¸ªé“¾è¡¨æ¥å¤„ç†ã€‚ </p><p>ä½ è¿˜å¯ä»¥åœ¨ <a href="https://juejin.im/post/5d71d3bee51d453b5f1a04f1#heading-7" target="_blank" rel="noopener">è¿™é‡Œ</a> çœ‹æ›´è¯¦å°½çš„è§£é‡Š</p><p>ä¸€ä¸ª hash æœ€å¤šå¯åŒ…å« 2<sup>32</sup> -1 ä¸ª k-v å¯¹</p><ul><li>HSET key field1 v1 field2 v2 â€¦ ï¼šæ–°å¢/æ›´æ–° kv</li><li>HSETNX key field value ï¼šnot existï¼Œå³ä¸å­˜åœ¨ field æ—¶æ’å…¥ï¼Œ key ä¸å­˜åœ¨ä¼šæ–°å»º</li><li>HGET key field ï¼šè·å– field çš„ value , field ä¸å­˜åœ¨æ—¶è¿”å› nil</li><li>HGETALL key ï¼šè·å– key ä¸­æ‰€æœ‰ kv</li><li>HDEL key field1 field2ï¼šåˆ é™¤æŒ‡å®š field</li><li>HEXISTS key field ï¼šfield æ˜¯å¦å­˜åœ¨</li><li>HINCRBY key field step ï¼š å¢åŠ  field å¯¹åº” value å€¼ï¼Œä¸å­˜åœ¨åˆ™æ–°å»ºè¯¥ fieldï¼Œ step ä½œä¸ºå€¼</li><li>HINCRBYFLOAT key field step ï¼šåŒä¸Šï¼Œå¢åŠ æˆ–æ–°å¢ float ç±»å‹</li><li>HLEN key ï¼šè·å– key çš„ field ä¸ªæ•°</li><li>HKEYS key ï¼š è·å– key ä¸­æ‰€æœ‰ field</li><li>HVALS key ï¼š è·å– key ä¸­æ‰€æœ‰ value</li><li>HSTRLEN key field ï¼šè·å– field å¯¹åº” value çš„é•¿åº¦</li><li>HMGET ï¼š è·å–å¤šä¸ª field å€¼ï¼Œfield ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› nil <code>hmget key field1 field1</code></li><li>HMSET ï¼š æ‰¹é‡æ–°å¢/æ›´æ–° fieldï¼Œ<code>hmset key field1 v1 field2 v2</code></li><li>HSCAN ï¼š </li></ul><hr><p>æ›´å¤š Hash ç›¸å…³å‘½ä»¤å‚è§ <a href="https://redis.io/commands#hash" target="_blank" rel="noopener">è¿™é‡Œ</a></p><h3 id="6-å…¶ä»–å‘½ä»¤"><a href="#6-å…¶ä»–å‘½ä»¤" class="headerlink" title="6. å…¶ä»–å‘½ä»¤"></a>6. å…¶ä»–å‘½ä»¤</h3><p>redis 5 æ–°æ·»åŠ äº†ä¸€ç§æ•°æ®ç»“æ„ <code>Stream</code> ï¼Œ å…³äºè¯¥æ•°æ®ç»“æ„ï¼Œå¯ä»¥å‚è§ <a href="http://redis.cn/topics/streams-intro.html" target="_blank" rel="noopener">è¿™é‡Œ</a></p><p>stream å¯ä»¥å®ç° consumer group çš„æ¦‚å¿µï¼Œæ¯ä¸ª client å¯ä»¥åªå…³æ³¨äºè‡ªå·±çš„ groupï¼Œå¹¶ä¸”åªèƒ½æŸ¥è¯¢åˆ°è¯¥ group ä¸‹çš„æ¶ˆæ¯ã€‚</p><p>stream çš„æŸäº›åŠŸèƒ½ä¸ redis çš„ pub/sub ç±»ä¼¼ï¼Œä¸è¿‡ pub/sub æ˜¯ <code>fire and forget</code> ä¸”ä»ä¸å­˜å‚¨ï¼Œ stream åˆ™ä¸æ˜¯å¦‚æ­¤ã€‚</p><p>bitmapï¼Œ geoï¼Œ hyperLogLog å‚è§ <a href="https://juejin.im/post/5aa72131518825556a7211af" target="_blank" rel="noopener">è¿™é‡Œ</a></p><p>æ›´å¤šå‘½ä»¤å‚è§  <a href="http://www.redis.cn/commands.html" target="_blank" rel="noopener">redis.cn</a>  or <a href="https://redis.io/commands" target="_blank" rel="noopener">redis</a></p><h2 id="pipeline"><a href="#pipeline" class="headerlink" title="pipeline"></a>pipeline</h2><p>å½“æˆ‘ä»¬éœ€è¦å¤šä¸ªæ“ä½œæ—¶ï¼Œ é€šå¸¸çš„åŠæ³•æ˜¯ï¼Œclient  â€“&gt; op1 â€“&gt; redis â€“&gt; client â€“&gt; op2 â€“&gt; redis â€¦</p><p>æ¯æ¬¡ op æ“ä½œï¼Œéƒ½éœ€è¦å…ˆå’Œ redis å»ºç«‹è¿æ¥ï¼Œè€Œåå†æ“ä½œã€‚è™½ç„¶è¿æ¥å»ºç«‹è€—æ—¶æçŸ­ï¼Œä½†å½“ç½‘ç»œä¸å¥½æ—¶ï¼Œä»ç„¶æ˜¯ä¸€ç¬”å¼€é”€ï¼Œè€Œ <strong>pipeline</strong> åˆ™å¯ä»¥å¾ˆå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>pipeline å’Œæˆ‘ä»¬å¸¸è¯´çš„ç®¡é“åŸºæœ¬ä¸€è‡´ï¼Œå®ƒèƒ½åœ¨ client å’Œ redis server ä¹‹é—´å»ºç«‹è¿æ¥é€šé“ï¼Œè€Œåæ¯æ¬¡æ“ä½œéƒ½åœ¨è¯¥é€šé“ä¸‹è¿›è¡Œï¼Œæ‰€æœ‰æ“ä½œå®Œæˆåï¼Œå†å…³é—­ pipeline</p><p>å½“æˆ‘ä»¬é€šè¿‡ pipeline æ“ä½œæ•°æ®æ—¶ï¼Œéœ€è¦æ³¨æ„æ“ä½œçš„ä¸ªæ•°ï¼Œå› ä¸º redis éœ€è¦è€—è´¹å†…å­˜æ¥ç»„ç»‡éœ€è¦è¿”å›çš„æ•°æ®ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ§åˆ¶ pipeline å†…çš„ op ä¸ªæ•°ï¼Œåˆ†æ‰¹å¤„ç†ã€‚</p><p>pipeline æ“ä½œæ˜¯éåŸå­æ€§çš„ï¼Œå¦‚æœè¦ä¿è¯å…¶åŸå­æ€§ï¼Œå¯ä»¥é€šè¿‡ <code>multi exec</code> æ¥ä¿è¯ </p><p>äº‹å®ä¸Šï¼Œ pipiline èƒ½å¤„ç†çš„äº‹æƒ…ï¼Œéƒ½å¯ä»¥é€šè¿‡è„šæœ¬æ¥å¤„ç†ï¼Œè„šæœ¬è¿˜èƒ½å¤Ÿå¤„ç†æœ‰ä¾èµ–å…³ç³»çš„æ•°æ®ã€‚lua script ç›¸æ¯” pipeline ï¼Œè¦æ›´çµæ´»ï¼ŒåŒæ—¶èƒ½å¤„ç†ç®€å•çš„ä¸šåŠ¡ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¸å»ºè®®åœ¨ script é‡Œå¤„ç†è€—æ—¶å¤§çš„ä¸šåŠ¡ã€‚</p><h2 id="PUBSUB"><a href="#PUBSUB" class="headerlink" title="PUBSUB"></a>PUBSUB</h2><p>åœ¨ redis ä¸­ï¼Œ é€šè¿‡å‡ ä¸ªç®€å•çš„å‘½ä»¤å°±å¯ä»¥å®ç° pub/sub ã€‚</p><p>æˆ‘ä»¬åœ¨ä¸€ä¸ª terminal ä¸­ä½¿ç”¨ <code>subscribe</code> å‘½ä»¤</p><pre class=" language-bash"><code class="language-bash">127.0.0.1:6379<span class="token operator">></span> SUBSCRIBE chan1 chan2Reading messages<span class="token punctuation">..</span>. <span class="token punctuation">(</span>press Ctrl-C to quit<span class="token punctuation">)</span>1<span class="token punctuation">)</span> <span class="token string">"subscribe"</span>2<span class="token punctuation">)</span> <span class="token string">"chan1"</span>3<span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 11<span class="token punctuation">)</span> <span class="token string">"subscribe"</span>2<span class="token punctuation">)</span> <span class="token string">"chan2"</span>3<span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> 2<span class="token comment" spellcheck="true"># publish chan1 "From chan1" å</span>1<span class="token punctuation">)</span> <span class="token string">"message"</span>2<span class="token punctuation">)</span> <span class="token string">"chan1"</span>3<span class="token punctuation">)</span> <span class="token string">"From chan1"</span></code></pre><p>è¯¥å‘½ä»¤ä¼šé˜»å¡ç›‘å¬ä¸¤ä¸ª channelï¼š chan1 å’Œ chan2 ï¼Œ å¦‚æœ channel ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºã€‚</p><p>æˆ‘ä»¬åŒæ ·å¯ä»¥ä½¿ç”¨ <code>psubscribe</code> å‘½ä»¤æ¥ä½¿ç”¨é€šé…ç¬¦ç›‘å¬ channelï¼Œ å¦‚ <code>psubscribe chan*</code></p><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ <code>unsubscribe</code> å’Œ <code>punsubscribe</code> (æ”¯æŒé€šé…ç¬¦) æ¥å–æ¶ˆè®¢é˜…</p><p>æˆ‘ä»¬åœ¨å¦ä¸€ä¸ª terminal é€šè¿‡ <code>publish chan1 value1</code> å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…æ–¹å°±èƒ½æ”¶åˆ°æ¶ˆæ¯</p><p>åœ¨ redis çš„ <code>server.h</code> ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªç”¨æ¥å­˜å‚¨ pubsub æ•°æ®çš„ key=channel , value=client çš„ dict</p><pre class=" language-c"><code class="language-c">dict <span class="token operator">*</span>pubsub_channels<span class="token punctuation">;</span></code></pre><ul><li><p>å½“æœ‰ client subscribe æ—¶ï¼Œ redis å°±ä¼šå¾€è¿™ä¸ª dict ä¸­æ·»åŠ  &lt;channel, client&gt; çš„ä¸€å †é”®å€¼å¯¹ï¼Œ å¤šä¸ª client æ³¨å†ŒåŒä¸€ä¸ª channel æ—¶ï¼Œ client çš„å­˜å‚¨å°±å˜æˆ dict ä¸­çš„ listã€‚</p></li><li><p>å½“æœ‰äºº publish å€¼åˆ° channel æ—¶ï¼Œ redis ä¼šå…ˆé€šè¿‡ channel æŸ¥è¯¢åˆ°å¯¹åº”çš„ client list ï¼Œç„¶åä¾æ¬¡å‘é€ç»™å„ä¸ª clientã€‚</p></li><li><p>é€€è®¢ channel æ—¶ï¼Œ åªéœ€è¦æ‰¾åˆ° channel ä¸‹çš„ client ï¼Œä» dict ä¸­å‰”é™¤å³å¯</p></li></ul><p><strong>å¦‚æœ publisher åœ¨ publish æ—¶æ²¡æœ‰ subscriber ç›‘å¬ï¼Œé‚£ä¹ˆè¯¥æ¡æ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚</strong></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://redis.io/" target="_blank" rel="noopener">redis å®˜ç½‘</a></li><li><a href="http://www.redis.cn/commands.html" target="_blank" rel="noopener">redis ä¸­æ–‡</a></li><li><a href="https://redisbook.readthedocs.io/en/latest/index.html" target="_blank" rel="noopener">redis è®¾è®¡ä¸å®ç° è€ç‰ˆ</a></li><li><a href="http://redisbook.com/" target="_blank" rel="noopener">redis è®¾è®¡ä¸å®ç° 3.0 ç‰ˆ</a></li><li><a href="https://juejin.im/post/5d71d3bee51d453b5f1a04f1" target="_blank" rel="noopener">æ·±å…¥äº†è§£ redis åº•å±‚æ•°æ®ç»“æ„</a></li><li><a href="https://juejin.im/post/5de3e841f265da05d03826ca" target="_blank" rel="noopener">å›¾è§£ redis äº”ç§æ•°æ®ç»“æ„åº•å±‚å®ç°</a></li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> middlewares </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PSSH æ‰¹é‡æ‰§è¡Œ</title>
      <link href="/tools/pssh/"/>
      <url>/tools/pssh/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å·¥ä½œï¼Œéœ€è¦é€šè¿‡è·³æ¿æœºå‘å¤šå° linux (å·²é€šè¿‡å…¬é’¥åšå…å¯†ç™»å½•)æ·»åŠ  cron taskã€‚</p><h2 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h2><ol><li><p>å®‰è£… <strong>pssh</strong> æ‰¹å¤„ç†å·¥å…·</p><ul><li><a href="https://code.google.com/archive/p/parallel-ssh/downloads" target="_blank" rel="noopener">Download</a></li></ul></li><li><p>è·å– <strong>/etc/hosts</strong> ä¸­çš„ <strong>ip</strong></p><pre><code> cat /etc/hosts | awk '{pring $1}' | grep 'your regex' &gt;&gt; hosts.txt </code></pre></li><li><p>æ£€æŸ¥å„å°æœºå™¨çš„ <strong>crontab</strong>           çŠ¶æ€ã€‚å¦‚æœæœ‰æœªæœåŠ¡æœªå¯åŠ¨çš„ï¼Œéœ€è¦é¦–å…ˆå¯åŠ¨</p><pre><code> /bin/systemctl status crond.service</code></pre></li><li><p>å°†éœ€è¦æ‰§è¡Œçš„ bash è„šæœ¬æ‰¹ä¸Šä¼ åˆ°å„æœºå™¨:</p><pre><code> pscp -h hosts.txt /home/dylan/alert.sh /home/dylan</code></pre></li><li><p>é€šè¿‡ <strong>pssh</strong> åˆ›å»º <strong>cron</strong> è„šæœ¬å¹¶å°† task å†™å…¥åˆ° crontab ä¸­:</p><pre><code> pssh -h hosts.txt -i 'cd ~;touch cron.cron;echo "* */2 * * * sh /home/dylan/your_bash.sh" &gt;&gt; cron.cron;crontab cron.cron'</code></pre></li><li><p>è‡³æ­¤å°±å®Œæˆäº†ã€‚å¦‚æœè¦æ‰¹å–æ¶ˆï¼Œåˆ™:</p><pre><code> pssh -h hosts.txt -i 'cd ~;sudo sed -i "/alert.sh/d" /var/spool/cron/dylan;rm cron.cron'</code></pre><p> è„šæœ¬è¯´æ˜ï¼šåˆ›å»ºçš„ <strong>crontab task</strong> å¯ä»¥åœ¨æ–‡ä»¶ <strong>/var/spool/cron/dylan</strong> (dylan ä¸ºç”¨æˆ·å) ä¸­æ‰¾åˆ°ï¼Œä¸Šè¿°è„šæœ¬é¦–å…ˆæ‰¾åˆ°å¯¹åº”çš„ task æ‰€åœ¨è¡Œï¼Œç„¶ååˆ é™¤ï¼Œ æœ€ååˆ é™¤åˆ›å»ºçš„è„šæœ¬</p></li></ol><h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p>è¯·è‡ªè¡Œ google * . *</p><hr><hr><hr><h1 id="pssh-ç®€ä»‹"><a href="#pssh-ç®€ä»‹" class="headerlink" title="pssh ç®€ä»‹"></a>pssh ç®€ä»‹</h1><h2 id="Ref-1"><a href="#Ref-1" class="headerlink" title="Ref"></a>Ref</h2><ul><li><a href="https://code.google.com/archive/p/parallel-ssh/" target="_blank" rel="noopener">google groups</a></li><li><a href="https://www.cnmysql.com/post/74/" target="_blank" rel="noopener">ä½¿ç”¨PSSHæ‰¹é‡SSHæ“ä½œLinuxæœåŠ¡å™¨</a></li><li><a href="https://my.oschina.net/guol/blog/59977" target="_blank" rel="noopener">PSSH æ‰¹é‡ç®¡ç†æœåŠ¡å™¨ - å¥½è„‘è¢‹å’Œçƒ‚ç¬”å¤´</a></li></ul><h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><ul><li><a href="https://code.google.com/archive/p/parallel-ssh/downloads" target="_blank" rel="noopener">Download</a></li></ul><h2 id="Note"><a href="#Note" class="headerlink" title="Note"></a>Note</h2><ul><li><p>åœ¨å…å¯†æƒ…å†µä¸‹</p><pre><code>pssh -i -h hosts.txt 'uptime'</code></pre></li><li><p>åœ¨å¯†ç æƒ…å†µä¸‹</p><pre><code>pssh -i -l root -a password -h hosts.txt 'uptime'</code></pre></li></ul><p>and others</p><h2 id="ç›¸å…³å‚æ•°è¯´æ˜"><a href="#ç›¸å…³å‚æ•°è¯´æ˜" class="headerlink" title="ç›¸å…³å‚æ•°è¯´æ˜"></a>ç›¸å…³å‚æ•°è¯´æ˜</h2><p>å…¶å®å¯ä»¥ç›´æ¥<code>pssh --help</code> &gt;.&lt;</p><ul><li>-h æ‰§è¡Œå‘½ä»¤çš„è¿œç¨‹ä¸»æœºåˆ—è¡¨ï¼Œæˆ–è€… -H user@ip:port  æ–‡ä»¶å†…å®¹æ ¼å¼[user@]host[:port]</li><li>-l è¿œç¨‹æœºå™¨çš„ç”¨æˆ·å</li><li>-p ä¸€æ¬¡æœ€å¤§å…è®¸å¤šå°‘è¿æ¥</li><li>-o è¾“å‡ºå†…å®¹é‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶</li><li>-e æ‰§è¡Œé”™è¯¯é‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶</li><li>-t è®¾ç½®å‘½ä»¤æ‰§è¡Œçš„è¶…æ—¶æ—¶é—´</li><li>-A æç¤ºè¾“å…¥å¯†ç å¹¶ä¸”æŠŠå¯†ç ä¼ é€’ç»™ssh</li><li>-O è®¾ç½®sshå‚æ•°çš„å…·ä½“é…ç½®ï¼Œå‚ç…§ssh_configé…ç½®æ–‡ä»¶</li><li>-x ä¼ é€’å¤šä¸ªSSHå‘½ä»¤ï¼Œå¤šä¸ªå‘½ä»¤ç”¨ç©ºæ ¼åˆ†å¼€ï¼Œç”¨å¼•å·æ‹¬èµ·æ¥</li><li>-X åŒ-x ä½†æ˜¯ä¸€æ¬¡åªèƒ½ä¼ é€’ä¸€ä¸ªå‘½ä»¤</li><li>-i æ˜¾ç¤ºæ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯åœ¨æ¯å°hostæ‰§è¡Œå®Œæ¯•å</li><li>-I è¯»å–æ¯ä¸ªè¾“å…¥å‘½ä»¤ï¼Œå¹¶ä¼ é€’ç»™sshè¿›ç¨‹ å…è®¸å‘½ä»¤è„šæœ¬ä¼ é€åˆ°æ ‡å‡†è¾“å…¥</li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools </tag>
            
            <tag> è¿ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤§è¥¿åŒ—ä¹‹æ—… -- ç»ˆç« </title>
      <link href="/travels/xi-bei/"/>
      <url>/travels/xi-bei/</url>
      
        <content type="html"><![CDATA[<p>é€›å®Œé’æµ·æ¹–ï¼Œä¸‹ä¸€ç«™æ˜¯è¢«ç§°ä¸ºå¤©ç©ºä¹‹å¢ƒçš„èŒ¶å¡ç›æ¹–ã€‚å¯èƒ½æ˜¯æˆ‘ä»¬æ¥çš„ä¸æ˜¯æ—¶å€™ï¼Œè§åˆ°çš„ä¸å®£ä¼ çš„å·®åˆ«å¾ˆå¤§ã€‚ä½†èµ°åœ¨é“ºæ»¡ç›ç²’çš„è·¯ä¸Šï¼Œè´¹åŠ›ä¹Ÿååˆ†æœ‰è¶£ï¼<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409164513.jpg-growing" alt="èŒ¶å¡ç›æ¹–"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409164526.jpg-growing" alt="ç›å¸"><br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="D:%5Ctools%5Ctypora%5Cimages%5C7763096-d8cc06d02d4b64c9.jpg" alt="å›¾ç‰‡å‘è‡ªç®€ä¹¦App"></p><p>è€Œåè½¬æˆ˜ç¿¡ç¿ æ¹–ï¼Œé‚£ä¸€å—ä¼¼ä¹è¿˜åœ¨å¼€å‘ä¸­ï¼Œè·¯ååˆ†éš¾å¼€ï¼Œå¼‚å¸¸é¢ ç°¸ã€‚åˆ°è¾¾çš„æ—¶å€™ï¼Œæ­£å¥½èµ¶ä¸Šæ—¥è½ã€‚å¯’é£ä¸­ï¼Œç‘Ÿç‘Ÿå‘æŠ–çœ‹å®Œæ—¥è½ï¼Œæ—¥è½çš„é€Ÿåº¦å¾ˆå¿«ï¼Œä½ èƒ½æ„Ÿè§‰åˆ°å¤•é˜³åœ¨ä¸‹é™ã€‚éš¾æ€ªè¯´å¤•é˜³æ— é™å¥½ï¼Œåªæ˜¯è¿‘é»„æ˜ï¼<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409164547.jpg-growing" alt="å¤•é˜³æŸ“çº¢çš„ç¿¡ç¿ æ¹–"></p><p>ä¹‹åå›åˆ°è¿™ä¸€ç«™çš„ä½å®¿ç‚¹â€”â€”é’å¹´æ—…é¦†ã€‚ç¬¬ä¸€æ¬¡ä½é’å¹´æ—…é¦†ã€‚å››å¼ åºŠå…«ä¸ªåºŠä½ï¼Œå’Œå¤§ä¸€æ—¶çš„å¯å®¤é¢‡æœ‰å‡ åˆ†ç›¸ä¼¼ä¹‹å¤„ã€‚ä¸æ„§æ˜¯å¤§è¥¿åŒ—ï¼Œæš–æ°”å¼€çš„å¼‚å¸¸çš„è¶³ï¼Œé—·å¾—æ…Œï¼Œæ„Ÿè§‰éƒ½å¿«å–˜ä¸è¿‡æ°”äº†ã€‚åªæ˜¯åæ¥ä¸çŸ¥æ€ä¹ˆçš„å°±ç¡ç€äº†ï¼Œæ—©ä¸Šèµ·æ¥å¤´ç–¼éš¾å—ï¼Œåƒäº†ä¸¤ç‰‡æ„Ÿå†’è¯ï¼Œç»§ç»­ä¸‹ä¸€ç«™ï¼Œæ•¦ç…Œã€‚</p><p>ä¸å¹¸çš„æ˜¯ï¼ŒåŒè¡Œæœ‹å‹çš„è½¦åäº†ï¼è¿˜å¥½è¿™è¾¹çš„é«˜é€Ÿæ²¡æœ‰å›´æ ï¼Œæˆ‘ä»¬æŠŠè½¦åœåˆ°ä¸¤æ¡è·¯çš„ä¸­é—´ï¼Œå¼€å§‹äº†ä¸€ç³»åˆ—çš„æ•‘æ´æªæ–½ã€‚</p><p>å…ˆæ˜¯å‘å¤§å¡è½¦æ‹›æ‰‹ï¼Œå¯»æ±‚å¸®åŠ©çœ‹çœ‹è½¦è¿˜æœ‰æ²¡æœ‰æ•‘ï¼Œå¤§å¡å¸æœºä¸€èˆ¬éƒ½æ˜¯è€å¸æœºï¼Œç»éªŒä¸°å¯Œï¼Œåªæ˜¯éƒ½è¯´è½¦å­ä¸èƒ½å†å¼€äº†ã€‚è€Œåæ‰¾è½¦è¡Œçš„äººï¼Œå’Œä»–ä»¬æ‰¯äº†åŠå¤©ï¼Œæ‰¯ä¸å‡ºä»€ä¹ˆç»“æœï¼è¿™é‡Œè¦æé†’å„ä½ç§Ÿè½¦çš„æœ‹å‹ï¼Œè½¦å­å‡ºäº†é—®é¢˜ï¼Œ<strong>ç¬¬ä¸€æ—¶é—´è”ç³»å¹³å°ï¼Œè€Œä¸è¦è”ç³»ç§Ÿè½¦å…¬å¸</strong>ï¼æˆ‘ä»¬å½“æ—¶ä¸çŸ¥é“ï¼Œä¸ºæ­¤æµªè´¹äº†å¾ˆå¤šæ—¶é—´ã€‚åæ¥æ‰¾æºç¨‹çš„å·¥ä½œäººå‘˜ï¼Œä»–ä»¬æ‰çœŸæ­£çš„æ¥è§£å†³æˆ‘ä»¬çš„è¡Œç¨‹é—®é¢˜(å…¶é—´ä¹Ÿæ˜¯å„ç§æ‰¯çš®ï¼Œåæ­£æŒºé—¹å¿ƒçš„)ã€‚è¿™äº‹å„¿ç›´åˆ°å‰æ®µæ—¶é—´æ‰ç®—ç»“æŸï¼Œåƒä¸€å ‘é•¿ä¸€æ™ºï¼Œä¹Ÿç®—æ—…è¡Œä¸­å¦ä¸€ç§é£æ™¯äº†ã€‚</p><p>è™½ç„¶æ˜¯éšæœºåœä¸‹çš„åœ°æ–¹ï¼Œå´ä¹Ÿæ˜¯é£æ™¯æ»¡æ»¡ï¼Œå¸¦ç€ç›¸æœºå’Œæœ‹å‹å°±å»æ—è¾¹æµªå»äº†ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409164638.jpg-growing" alt="å¤§è¥¿åŒ—é£å‘³"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409164813.jpg-growing" alt="å¤§è¥¿åŒ—é£å‘³"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409164823.jpg-growing" alt="å¤§è¥¿åŒ—é£æƒ…"></p><p>åæ¥è®©å¦¹å­ä»¬å»é©¬è·¯ä¸Šæ‹¦è½¦ï¼Œç¨‹åºçŒ¿ä¸å¦‚ç¨‹åºåª›å•Šï¼çƒ­å¿ƒçš„äººè¿˜æ˜¯å¾ˆå¤šçš„ï¼Œåœä¸‹æ¥é—®åŸå› ï¼Œå¸®æˆ‘ä»¬çœ‹æ•…éšœçš„è½¦å­ï¼Œåªæ˜¯ä¸€èˆ¬è½¦ä¸Šéƒ½æ»¡å‘˜äº†ï¼Œä¹Ÿæ˜¯æ— å¥ˆï¼Œå¤¸å¼ çš„æ—¶å€™ï¼Œé©¬è·¯ä¸€è¾¹åœäº†å››äº”è¾†ï¼Œä¸çŸ¥é“çš„ï¼Œè¿˜ä»¥ä¸ºè¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªæ™¯ç‚¹äº†å‘¢ã€‚<br>ç»è¿‡ä¸æ‡ˆåŠªåŠ›ï¼Œç»ˆäºæ‹¦åˆ°äº†åˆé€‚çš„è½¦ï¼Œæ˜¯ä¸€å¯¹è‡ªé©¾å‡ºæ¥ç©çš„æƒ…ä¾£ï¼Œä¹Ÿæ˜¯å‰å¾€æ•¦ç…Œã€‚äºæ˜¯ä¹ç»§ç»­å‡ºå‘ã€‚æ„Ÿè°¢çƒ­å¿ƒè½¦ä¸»ï¼</p><p>ç”±äºè½¦å­é—®é¢˜ï¼ŒåŸå®šçš„è«é«˜çªŸä¹‹æ—…åªå¥½ä½œåºŸï¼Œç•¥é—æ†¾ã€‚æ™šä¸ŠåŠ ç¬¬äºŒå¤©ä¸Šåˆï¼Œä¸€ç›´åœ¨å’Œç§Ÿè½¦è¡Œæ‰¯çš®ï¼Œè¯´å¥½ç¬¬äºŒå¤©æ—©ä¸Šé€æ¥çš„è½¦æ¯«æ— è¸ªå½±ï¼Œè®©æˆ‘ä»¬è‡ªå·±æƒ³åŠæ³•è¿‡å»ï¼Œä¹Ÿæ˜¯æ— è¯­ï¼æœ€åè¿˜æ˜¯æ‰¾æ°‘å®¿è€æ¿é€æˆ‘ä»¬åˆ°å¼ æ–ï¼Œä»–ä»¬æŠŠè½¦é€åˆ°å¼ æ–ã€‚</p><p>ä¸­åˆå¼€å§‹å¯ç¨‹åˆ°å¼ æ–ï¼Œåªæ˜¯ï¼Œåœ¨é¸£æ²™å±±ï¼Œç¨ç¨å¤šé€—ç•™äº†ä¸€ä¼šå„¿ï¼Œç©å—¨äº†ã€‚<br>é¸£æ²™å±±ä½äºæ²™æ¼ è¾¹ç¼˜ï¼Œåœ¨è¿™å„¿å¯ä»¥è§è¯†åˆ°æ²™æ¼ çš„æ ·å­ã€‚</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409165105.jpg-growing" alt="é¸£æ²™å±±æœˆç‰™æ³‰"></p><p>ç¬¬ä¸€æ¬¡ä½“éªŒéª‘éª†é©¼ã€‚ä¸€ç›´æŠŠè…°ç»·çš„ç´§ç´§çš„ï¼Œåæ¥ç‰µéª†é©¼çš„å°å“¥å®åœ¨çœ‹ä¸ä¸‹å»ï¼Œè¯´è¦æ”¾æ¾ï¼ŒæŠŠè…°æ¾ä¸‹æ¥ï¼Œä¸ä¼šæ‰ä¸‹å»ï¼ŒæœçœŸå¦‚æ­¤ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409165147.jpg-growing" alt="æˆ‘é«˜è´µçš„å¤´é¢…"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409165205.jpg-growing" alt="éª†é©¼ç¾¤åƒ"></p><p>è€Œåæœ¬ç€å¥½ä¸å®¹æ˜“æ¥ä¸€æ¬¡çš„å¿ƒæ€ï¼Œä½“éªŒäº†æŠŠä¸‰å››åˆ†é’Ÿå››ç™¾å…«åå…ƒçš„æ»‘ç¿”æœºã€‚çœŸè¦è¯´æ„Ÿå—ï¼Œé™¤äº†å¤±é‡æ—¶çš„å®³æ€•ï¼Œå…¶ä»–éƒ½è¿˜å¥½ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409165227.jpg-growing" alt="æ»‘ç¿”èµ·é£"></p><p>ä¹‹åä¾¿èµ¶å¾€å¼ æ–ï¼Œä¸ƒå½©ä¸¹éœä¹Ÿæ˜¯æˆ‘ä»¬çš„æœ€åä¸€ç«™ã€‚è¿™ä¸€ç«™çš„ä½å®¿ç‚¹æ˜¯è’™å¤åŒ…ï¼Œæ®è¯´æ™šä¸Šè¿˜æœ‰ç¯ç«æ™šä¼šï¼Œå®åœ¨å¯æƒœçš„æ˜¯ï¼Œæˆ‘ä»¬åˆ°çš„æ—¶å€™å·²ç»æ™šä¸Šåç‚¹å¤šäº†ï¼Œå®Œç¾é”™è¿‡ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409165241.jpg-growing" alt="ä¸¹éœè’™å¤åŒ…"></p><p>æœ€åä¸€æ—¥æ¸¸â€”â€”ä¸ƒå½©ä¸¹éœã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409165322.jpg-growing" alt="ä¸¹éœåœ°è²Œ"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409165332.jpg-growing" alt="ä¸¹éœåœ°è²Œ"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409165341.jpg-growing" alt="ä¸¹éœåœ°è²Œ"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409165449.jpg-growing" alt="å¿ƒæ„¿"></p><p>å¿ƒæ»¡æ„è¶³ï¼Œè¿”ç¨‹ï¼è·¯ä¸Šç»è¿‡è¿ç»µæ•°ç™¾å…¬é‡Œçš„ç¥è¿å±±è„‰ï¼Œæ›´æ˜¯ç»å†äº†æ˜¥å¤ç§‹å†¬ã€‚å±±ä¸‹è¿˜æŒºæš–å’Œçš„ï¼Œåªæ˜¯éšç€ä¸€ç‚¹ç‚¹çš„æ”€çˆ¬ï¼Œæ¸©åº¦æ¸æ¸ä¸‹é™ï¼Œæœ€åé£˜èµ·äº†å°é›ªï¼Œè€Œåè¶Šæ¥è¶Šå¤§ã€‚å±±é¡¶ç™½èŒ«èŒ«ä¸€ç‰‡ï¼Œç€å®éœ‡æ’¼ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409165549.jpg-growing" alt="å››å­£ä¹‹å†¬"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409165602.jpg-growing" alt="å››å­£ä¹‹å†¬"></p><p>ä¸€è·¯æ”€çˆ¬æœ€é«˜åˆ°ä¸‰åƒå…«ç™¾ç±³ï¼Œè€Œåä¸€è·¯å‘ä¸‹ï¼Œç»ˆåˆ°è¥¿å®é«˜é“ç«™é™„è¿‘ã€‚è¿˜è½¦ï¼Œä¼‘æ•´ï¼Œè¿”èˆªï¼</p><p>åä¸€ä¹‹æ—…è½ä¸‹å¸·å¹•ï¼Œå¤§è¥¿åŒ—çš„è‹å‡‰å’Œæµ©ç€šå®åœ¨éœ‡æ’¼äººå¿ƒï¼Œä¸æ±Ÿå—çš„å°æ¡¥æµæ°´è¿¥ç„¶ä¸åŒã€‚å¸Œæœ›ä¹‹åæœ‰æœºä¼šå»æ›´å¤šçš„åœ°æ–¹ï¼Œä½“éªŒä¸åŒçš„é£æ™¯ï¼Œæ›´å¸Œæœ›è¿™ä»½å¿ƒæƒ…ï¼Œä¸å› å¹´é¾„çš„å¢é•¿è€Œæ¶ˆé€ã€‚</p><p>å“¦å¯¹äº†ï¼Œè¥¿åŒ—å®åœ¨å¹²ç‡¥ï¼Œå¦‚æœæœ‰æœ‹å‹æƒ³å»ï¼Œè®°å¾—ä¸€å®šå¸¦æ¶¦å”‡è†ï¼Œè¡€ä¸æ³ªçš„æ•™è®­ï¼</p><p>ä»¥ä¸Š</p><p>äº 2018.10</p><blockquote><p>ä»¥å‰å‘åœ¨ç®€ä¹¦çš„æ–‡ç« ï¼Œå¯æ˜¯æœ€è¿‘ç®€ä¹¦è«åå°äº†æˆ‘çš„è´¦å·ã€‚åˆæ°é€¢è‡ªå·±æœ‰äº†è‡ªå·±çš„ blogï¼Œä¾¿æŠŠä¹‹å‰çš„ä¸€äº›è®°å¿†æ‹¿äº†å›æ¥ã€‚</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> travels </category>
          
      </categories>
      
      
        <tags>
            
            <tag> travels </tag>
            
            <tag> å¤§è¥¿åŒ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤§è¥¿åŒ—ä¹‹æ—… -- é’æµ·</title>
      <link href="/travels/qing-hai/"/>
      <url>/travels/qing-hai/</url>
      
        <content type="html"><![CDATA[<p>ä¸‹åˆä»å…µé©¬ä¿‘èµ¶å»è¥¿å®‰åŒ—ç«™ï¼Œå’Œå°ä¼™ä¼´ä»¬ä¼šåˆï¼Œä¸‹ä¸€ç«™é’æµ·è¥¿å®ã€‚</p><p>éšç€ç«è½¦ä¸æ–­é è¿‘è¥¿å®ï¼Œè½¦ä¸Šå‡ºç°äº†ååˆ†æœ‰è¶£çš„ç°è±¡ï¼šæœ‰äººçŸ­è¢–ï¼Œæœ‰äººç§‹è¡£ï¼Œæœ‰äººå†¬è£…ã€‚åªæ˜¯åˆ°è¥¿å®åï¼Œèƒ½åŠ çš„è¡£æœéƒ½åŠ äº†ï¼Œè™½ç„¶æ­¤æ—¶æ‰åæœˆä¸€å·ã€‚</p><p>åˆ°è¾¾è¥¿å®å·²æ˜¯æ™šä¸Šä¸ƒç‚¹å¤šäº†ï¼Œç§Ÿçš„ä¸¤è¾†è½¦ä¹Ÿå·²é€åˆ°ï¼Œä¸€è¡Œäººç­¾å¥½åˆåŒï¼Œä¾¿é©±è½¦å‰å¾€æ—©å·²é¢„å®šå¥½çš„æ°‘å®¿ã€‚</p><p>æ°‘å®¿ä¸»äººæ˜¯ä¸ªå¾ˆå’Œå–„çš„é˜¿å§¨ï¼Œé¢†ç€æˆ‘ä»¬ä¸Šæ¥¼ã€äº¤ä»£äº†å‡ å¥åä¾¿ç¦»å¼€äº†ã€‚æ°‘å®¿åå…å±…ç„¶æœ‰éº»å°†æœºã€‚äºæ˜¯ä¹ï¼Œå‡ äººè½®ç•ªä¸Šé˜µï¼Œè°èµ¢è°ä¸‹ã€‚æ— å¥ˆæŠ€æœ¯å‡ºè‰²åŠ è¿æ°”ä¸èµ–ï¼Œåªå¥½æ‰“ä¸€æŠŠæ­‡ä¸€æŠŠã€‚</p><p>ç¬¬äºŒæ—¥æ­£å¼å‡ºå‘ï¼Œç¬¬ä¸€ç«™ï¼Œæ—¥æœˆå±±ã€‚</p><p>çŠ¹è®°åˆšçœ‹åˆ°è¥¿åŒ—åœ°è²Œæ—¶ï¼Œè½¦é‡Œå‡ ä¸ªäººçš„æƒŠå«ã€‚å¼€ç€å¼€ç€ï¼Œå±…ç„¶ä¸‹èµ·äº†å°é›ªã€‚è€Œæ­¤æ—¶ï¼Œå·²æ˜¯åˆ°äº†æ—¥æœˆå±±è„šä¸‹äº†ã€‚æˆ‘ä»¬ç¨ä½œåœç•™ï¼Œä¸‹è½¦å»ä½“éªŒéª‘ä¸ƒå½©ç‰¦ç‰›ï¼Œæ›´æ˜¯ä¸€æ¿€åŠ¨ï¼Œç¨ç¨çˆ¬äº†ä¸‹å±±ã€‚çªç„¶æ„Ÿåˆ°å¤´æ™•ç›®çœ©ï¼Œæ‰ååº”è¿‡æ¥ï¼Œæ­¤æ—¶å·²ç»æµ·æ‹”ä¸‰åƒå¤šç±³äº†ï¼èµ¶ç´§æ…¢ä¸‹æ¥æ…¢æ…¢é€‚åº”ä¸‹ã€‚</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409163505.jpg-growing" alt="ä¸ƒå½©ç‰¦ç‰›"></p><p>å¾…çˆ¬ä¸Šæ—¥æœˆå±±æ—¶ï¼Œé›ªåˆå¤±å»è¸ªå½±ï¼Œä¼¼ä¸æ›¾æ¥è¿‡ã€‚è€Œæ­¤åˆ»åªè§æ—¥æœˆå±±â€”â€”ä¼ è¯´ä¸­ï¼Œç”±æ–‡æˆå…¬ä¸»çš„å®é•œæ‰€åŒ–ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409163513.jpg-growing" alt="æ—¥æœˆå±±"></p><p>ä»æ—¥æœˆå±±ä¸‹æ¥ï¼Œä¾¿å¼€å¾€é’æµ·æ¹–ã€‚æ²¿é€”é£å…‰æ— é™å¥½ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409163604.jpg-growing" alt="å¤§è¥¿åŒ—è‰åŸ"></p><p>ç»ˆäºæ¥åˆ°é’æµ·æ¹–ã€‚ä¸€è·¯ä¸Šçœ‹åˆ°å¾ˆå¤šæµªæ¼«çš„éª‘è¡Œè€…ã€‚<br>å„è‡ªè§‚èµå®Œåï¼Œæ‰“ç®—ä¸€èµ·æ‹ä¸ªåˆç…§ã€‚æ‰“å¼€ä¸‰è„šæ¶ï¼Œæ‘†ä¸Šç›¸æœºï¼Œæ‰“ç®—ç”¨å»¶æ—¶æ‘„å½±æ‹ï¼Œå¼„äº†åŠå¤©å¤±è´¥ï¼Œåˆè¯´å¯ä»¥æ‰‹åŠ¨æ§åˆ¶ï¼Œäº¦å¤±è´¥ï¼Œè¯·åŸè°…å‡ ä¸ªæ–°äººã€‚åæ¥ä¸€ä¸ªçƒ­å¿ƒè·¯äººè¿‡æ¥å¸®æˆ‘ä»¬ï¼Œæ— å¥ˆï¼Œé¼“æ£äº†åŠå¤©ï¼Œæœ€åæ˜¯ç”¨æ‰‹æœºæ‹çš„ï¼Œå“ˆå“ˆï¼Œå¼€å¿ƒå°±å¥½äº†ï¼<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409163639.jpg-growing" alt="é’æµ·æ¹–"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409163707.jpg-growing" alt="é’æµ·æ¹–"></p><p>ç­‰æˆ‘ä»¬å¿ƒæ»¡æ„è¶³æ‰“ç®—ç¦»å»æ—¶ï¼Œå¤©å·²ç»å¿«é»‘äº†ã€‚æœ¬æ‰“ç®—å»çœ‹æ—¥è½ï¼Œä¹Ÿæ˜¯èµ¶ä¸åˆ°äº†ã€‚åªæ˜¯é“è·¯ä¸¤è¾¹ï¼Œé£æ™¯æ»¡æ»¡ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409163728.jpg-growing" alt="é»„æ˜"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409163831.jpg-growing" alt="é»„æ˜"></p><p>è·¯ä¸Šç»è¿‡ä¸€ä¸ªå¾ˆçƒ­é—¹çš„é•‡å­ï¼Œåœä¸‹æ¥åƒé¥­ï¼Œå«äº†ç¾Šè‚‰ï¼Œç‰¦ç‰›è‚‰ï¼Œå„ç§è‚‰ã€‚æ°´è¶³é¥­é¥±ï¼Œç»§ç»­èµ¶å¾€ä¸‹ä¸€ç«™ã€‚</p><p>ä»¥ä¸Š</p><p>äº 2018.10</p><blockquote><p> ä»¥å‰å‘åœ¨ç®€ä¹¦çš„æ–‡ç« ï¼Œå¯æ˜¯æœ€è¿‘ç®€ä¹¦è«åå°äº†æˆ‘çš„è´¦å·ã€‚åˆæ°é€¢è‡ªå·±æœ‰äº†è‡ªå·±çš„ blogï¼Œä¾¿æŠŠä¹‹å‰çš„ä¸€äº›è®°å¿†æ‹¿äº†å›æ¥ã€‚</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> travels </category>
          
      </categories>
      
      
        <tags>
            
            <tag> travels </tag>
            
            <tag> å¤§è¥¿åŒ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤§è¥¿åŒ—ä¹‹æ—… -- è¥¿å®‰</title>
      <link href="/travels/xi-an/"/>
      <url>/travels/xi-an/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¹´çš„åä¸€æ ¼å¤–æµªã€‚</p><p>åä¸€ä¹‹å‰å’Œæœ‹å‹è®¨è®ºå»å“ªé‡Œæµªï¼Œä¸€æ›°è¥¿è—ï¼Œåé£æœºè¿‡å»ã€‚æˆ‘æ€•ä¸€ä¸‹é£æœºå°±é«˜åï¼Œæƒ³ç€åç«è½¦è¿‡å»ï¼Œæ…¢æ…¢æ‚ æ‚ ï¼Œè¿˜æœ‰ä¸€è·¯é£æ™¯å¯çœ‹ã€‚å²‚æ–™å¦ä¸€æœ‹å‹æè®®å¤§è¥¿åŒ—ï¼Œå¦™ï¼Œä¼—ç‹æœ‹ç‹—å‹ä¸€æ‹å³åˆã€‚</p><p>æƒ³ç€è™½é€”ç»è¥¿å®‰å´æœªåœç•™ï¼Œå®åœ¨é—æ†¾ï¼Œé‚ä¸ä¸€åŒæ ·é—æ†¾çš„æœ‹å‹è¯·å‡ä¸¤å¤©ï¼Œç›´å¥”è¥¿å®‰ã€‚</p><p>ä¸€ä¸‹é«˜é“ï¼Œæ‰¾åˆ°äº‹å…ˆå®šå¥½çš„æ°‘å®¿ï¼Œæ”¾ä¸‹è¡Œæï¼Œä¾¿é©¬ä¸åœè¹„çš„å‡ºæ¥æµªäº†ã€‚é’Ÿæ¥¼ï¼Œé¼“æ¥¼ï¼Œå›æ°‘è¡—ï¼Œä»¥åŠæ™šä¸Šé¼“æ¥¼çš„ç¯å…‰è¡¨æ¼”ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409160830.jpg-growing" alt="å‚æ™šæ—¶åˆ†"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409161005.jpg-growing" alt="å…¥å¤œå"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409161023.jpg-growing" alt="ç¯å…‰è¡¨æ¼”"></p><p>å›åˆ°æ°‘å®¿å·²ç»å¾ˆæ™šäº†ï¼Œå†åŠ ä¸Šä¸€å¤©çš„å¥”æ³¢ï¼Œå¾ˆå¿«å…¥ç¡ã€‚<br>è€ƒè™‘ä¹‹åä»è¥¿å®‰åŒ—ç«™å‡ºå‘ï¼Œæˆ‘ä»¬é‡æ–°æ‰¾äº†ä¸ªè¿‘ç‚¹çš„é…’åº—ã€‚äºæ˜¯ï¼Œä½ åœ¨è¡—ä¸Šçœ‹åˆ°ä¸¤ä¸ªè‹±ä¿Šæ½‡æ´’ï¼Œé£æµå€œå‚¥ï¼Œç‰æ ‘ä¸´é£çš„ç¾ç”·å­ï¼Œä¸€äººæ‹–ç€ä¸€ä¸ªç®±å­ï¼Œè¾¹èµ°è¾¹é€›ã€‚å¾…åˆ°è¥¿å®‰ç¢‘æ—é™„è¿‘ï¼Œè§ä¸€è€çˆ·çˆ·å’Œä¸€å¥³å­©è¯´ç€è¥¿å®‰çš„äººæ–‡å†å²ï¼Œé™„è¿‘çš„æ™¯ç‚¹ç‰¹è‰²ï¼Œååˆ†æœ‰è¶£ï¼Œæˆ‘ä¿©å°±åœ¨æ—è¾¹â€œå·å¬â€ã€‚</p><p>å¯èƒ½è€çˆ·çˆ·ä¹Ÿæ¥äº†å…´è‡´ï¼Œè¯´åšå›å…è´¹å¯¼æ¸¸ï¼Œé¢†ç€æˆ‘ä»¬è½¬è½¬ã€‚æˆ‘ä»¬åŸæœ¬æ‰“ç®—å»é…’åº—çš„ï¼Œæ¯•ç«Ÿè¿˜æ‹–ç€æ—…è¡Œç®±ï¼Œæ­¤æ—¶ä¹Ÿä¹‰æ— åé¡¾ï¼Œè·Ÿç€å§‘å¨˜å’Œè€çˆ·çˆ·é€›äº†èµ·æ¥ã€‚</p><p>è€çˆ·å­å®åœ¨æœ‰è¶£ï¼Œå­¦è¯†ä¹Ÿå¾ˆä¸°å¯Œï¼Œæ¯åˆ°ä¸€å¤„ï¼Œä¾¿è·Ÿæˆ‘ä»¬è®²ç›¸å…³çš„å†å²å’Œæ•…äº‹ã€‚è¯´ç¢‘æ—åˆ»æœ‰å­”åº™äºŒå­—å¢™ä¸‹çš„ä¸¤é¢—åƒå¹´å¤æ ‘ï¼Œè¯´åŸå¢™çªå‡ºæ¥çš„é©¬é¢è¶£äº‹ï¼Œè¯´é¼“æ¥¼å¤–é¢†å¯¼äººæ¥å¾…å›½å¤–é€‰æ‰‹çš„æ–°é—»ã€‚ä¸€è·¯ä¸Šç»™å°å§‘å¨˜æ‹ç…§ç‰‡ï¼Œæ•™æˆ‘ä»¬å¦‚ä½•å–æ™¯ã€æ„å›¾ï¼Œè¿˜é—®ä¸¤ä¸ªå‚»å°ä¼™å­æ‹–ç€ç®±å­ç´¯ä¸ç´¯ï¼åˆ°åˆé¥­çš„ç‚¹å„¿äº†ï¼Œæˆ‘ä»¬æ‰“ç®—æ‰¾ä¸€ä¸ªåœ°å„¿ï¼Œè¯·è€çˆ·å­åƒä¸€é¡¿ï¼Œè€çˆ·å­æ¥äº†å¥â€œä¸ƒåä¸ç•™é¥­â€ï¼Œå°±èµ°äº†ã€‚å®åœ¨æ˜¯è‡ªåœ¨çš„äººã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409161109.jpg-growing" alt="è¥¿å®‰ç¢‘æ—"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409161158.jpg-growing" alt="åŸå¢™é©¬é¢"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409161231.jpg-growing" alt="å°ç‹®å­"></p><p>äºæ˜¯ä¹ï¼Œä¸¤ä¸ªå‚»å°å­å’Œä¸€ä¸ªæ½‡æ´’çš„å§‘å¨˜å…±è¿›äº†ä¸€é¡¿åˆé¥­ã€‚å§‘å¨˜ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆæœ‰è¶£çš„äººï¼Œä¸€ä¸ªäººä»æµå—è·‘åˆ°äº†è¥¿å®‰æ—…æ¸¸ã€‚äºæˆ‘ï¼Œæ˜¯è‚¯å®šæ²¡æœ‰è¿™æ ·çš„æ‰§è¡ŒåŠ›çš„ã€‚å¾ˆå¤šæ—¶å€™ï¼Œéƒ½æ˜¯æƒ³æƒ³ï¼ŒçœŸåˆ°äº†è¦å»æ‰§è¡Œçš„æ—¶å€™ï¼Œå¤šåŠè¿˜æ˜¯èƒ½æ‰¾åˆ°å®‰æ…°è‡ªå·±çš„ç†ç”±ï¼Œç„¶åæ”¾å¼ƒã€‚</p><p>ç‚¹äº†ä¼ è¯´ä¸­çš„ biangbiang é¢ï¼Œä¸€é¥±å£ç¦ã€‚ä¸å¾—ä¸è¯´é¢é£Ÿç¡®å®ä¸é”™ã€‚è¿™å‡ æ—¥å°äº†æ²¹æ³¢é¢ï¼Œå‡‰çš®ç­‰ï¼Œå³ä½¿æˆ‘æ˜¯ä¸ªå¹³æ—¥é‡Œå¯¹é¢é£Ÿæ— æ„Ÿï¼Œåœ°åœ°é“é“çš„å—æ–¹äººï¼Œä¹Ÿå¾—ç«–èµ·å¤§æ‹‡æŒ‡ã€‚åªæ˜¯ä¸çŸ¥é“æ˜¯ä¸æ˜¯é¥¿çš„ã€‚æˆ‘ä¸ç¦æ¨æ–­ï¼Œæ—…æ¸¸æ—¶ç”±äºç´¯å’Œé¥¿ä»è€Œå¯¼è‡´äº†ä¸€æ‰¹ç¾é£Ÿå‡ºæ¥ã€‚</p><p>æœ¬æ¥æ‰“ç®—åƒå®Œå°±å»é…’åº—ï¼Œç»“æœå‘ç°å°é›å¡”å°±åœ¨å‡ ç™¾ç±³ä¹‹å†…ã€‚å“ï¼Œäºæ˜¯åˆæ‹–ç€ç®±å­è¡Œèµ°åœ¨è·¯äººè¯§å¼‚çš„ç›®å…‰ä¸­ã€‚å¯å–œçš„æ˜¯ï¼Œå°é›å¡”å¯ä»¥å…è´¹å­˜æ”¾ç‰©å“ï¼Œå·¥ä½œäººå‘˜æ›´æ˜¯ååˆ†å–„æ„çš„è·‘è¿‡æ¥å‘Šè¯‰æˆ‘ä»¬ï¼Œå¾ˆæ„Ÿè°¢ã€‚ä¹‹åå±…ç„¶åˆè§åˆ°äº†é‚£å§‘å¨˜ã€‚åªå¯æƒœè„¸çš®å¤ªè–„ï¼Œæœ€ç»ˆè¿˜æ˜¯æ²¡å¥½æ„æ€è¦è”ç³»æ–¹å¼ã€‚</p><p>æ¼«æ­¥å›­ä¸­ï¼Œèº«è¾¹éƒ½æ˜¯å‡ ç™¾ä¸Šåƒå¹´çš„å¤æ ‘ã€‚è¿™äº›å¤æ ‘ä»å†å²çš„é•¿æ²³ä¸­èµ°æ¥ï¼Œè§è¯äº†ä¸€ä»£ä»£ç‹æœçš„æ›´æ›¿ã€‚è€Œæˆ‘æ­¤åˆ»æ­£å’Œå®ƒä»¬å…±åŒå‘¼å¸ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409161608.jpg-growing" alt="å°é›å¡”"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409161619.jpg-growing" alt="å†å²è§è¯è€…"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409161644.jpg-growing" alt="ç”Ÿå‘½"></p><p>ç»ˆäºè¿æ¥åæœˆä¸€å·ï¼Œä¸€å¤§æ—©å°±èµ·æ¥ï¼Œä¹˜åå‘å¾€å…µé©¬ä¿‘çš„å…¬äº¤è½¦ã€‚çº¦æ‘¸ä¸€ä¸ªå°æ—¶ï¼Œä¾¿åˆ°äº†ç§¦å§‹çš‡é™µã€‚å¤–é¢æœ‰ä¸€åº§å§‹çš‡å¸çš„é›•åƒï¼Œéšåè§åˆ°äº†å¿ƒå¿ƒå¿µå¿µçš„ï¼Œå¤ä»£äººæ°‘ç”¨å‹¤åŠ³å’Œæ™ºæ…§æ‰“é€ å‡ºæ¥çš„å¥‡è¿¹â€”â€”å…µé©¬ä¿‘ã€‚<br>å†å²ï¼Œè¿™ä¸¤ä¸ªå­—ä»å‰åªæ˜¯ä¸€é—¨è¯¾ç¨‹ï¼Œæ­¤åˆ»å´å¼‚å¸¸æ·±åšï¼Œä¹Ÿååˆ†æ®‹é…·ã€‚ä¸çŸ¥é“å½“å¹´çš„å§‹çš‡å¸ï¼Œä¼šä¸ä¼šæƒ³åˆ°åé¢å‘ç”Ÿçš„ä¸€åˆ‡ã€‚å§‹çš‡å¸ï¼Œå´ä¸æ›¾æƒ³äºŒä¸–è€Œäº¡ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409161746.jpg-growing" alt="ç§¦å§‹çš‡"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409161922.jpg-growing" alt="å…µé©¬ä¿‘ç¾¤åƒ"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409161952.jpg-growing" alt="æ— å¤´ä¿‘"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409162015.jpg-growing" alt="å¥³ä¿‘"></p><p>è€çˆ·å­è¯´ï¼Œä½ åœ¨è¥¿å®‰éšä¾¿èµ°åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œå¯èƒ½æå…¶ä»–çœå¸‚éƒ½è¦é‡ç‚¹ä¿æŠ¤ï¼Œå¯åœ¨è¥¿å®‰ä¸ä¼šï¼Œè¥¿å®‰çš„å†å²å¤ªåšé‡ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409162054.jpg-growing" alt="åšç‰©é¦†æ ‡è¯­"></p><p>ä»¥ä¸Š</p><p>äº 2018.10</p><blockquote><p> ä»¥å‰å‘åœ¨ç®€ä¹¦çš„æ–‡ç« ï¼Œå¯æ˜¯æœ€è¿‘ç®€ä¹¦è«åå°äº†æˆ‘çš„è´¦å·ã€‚åˆæ°é€¢è‡ªå·±æœ‰äº†è‡ªå·±çš„ blogï¼Œä¾¿æŠŠä¹‹å‰çš„ä¸€äº›è®°å¿†æ‹¿äº†å›æ¥ã€‚</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> travels </category>
          
      </categories>
      
      
        <tags>
            
            <tag> travels </tag>
            
            <tag> å¤§è¥¿åŒ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¸¸è®° -- è¶Šå—å²˜æ¸¯</title>
      <link href="/travels/yue-nan-xian-gang/"/>
      <url>/travels/yue-nan-xian-gang/</url>
      
        <content type="html"><![CDATA[<p>è®°å¾—åˆä¸­å­¦è¿‡ä¸€ç¯‡æ–‡ç« å«ã€Šç¬¬ä¸€æ¬¡çœŸå¥½ã€‹ï¼Œé‡Œé¢æœ‰ä¸€å¥è¯</p><blockquote><p>ç”Ÿå‘½ä¸­çš„ç¬¬ä¸€æ¬¡æ„ˆå¤šï¼Œç”Ÿå‘½ä¹Ÿå°±æ„ˆç›Šå¤šå§¿å¤šå½©</p></blockquote><p>è¿™æ˜¯ç¬¬ä¸€æ¬¡å‡ºå›½ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡åé£æœºï¼Œå…´å¥‹ç€ä¹Ÿæ¿€åŠ¨ç€ï¼Œå¿ƒé‡Œè™½å¦‚æ­¤ï¼Œè„¸ä¸Šå´è¦åŠªåŠ›å¹³é™ç€ï¼Œæ¯•ç«Ÿï¼Œä¸å†æ˜¯é‚£ä¸ªæ‹¿ç€ç³–å°±å¯ä»¥æ‰‹èˆè¶³è¹ˆçš„å¹´çºªäº†ã€‚è€Œåå¼€å§‹æ£€ç¥¨ã€æ‰˜è¿ã€å®‰æ£€ç­‰ä¸€ç³»åˆ—çš„æ‰‹ç»­ï¼Œç»ˆäºåˆ°äº†å€™æœºå¤§å…äº†ï¼Œå†ç­‰äº†çº¦è« 20 åˆ†é’Ÿï¼Œå¼€å§‹ç™»æœºäº†ã€‚é£æœºä¸å¤§ï¼Œåº§ä½æ›´æ˜¯ç‹­å°ï¼Œä¸€ä¸‹å­è®©æˆ‘å¹³é™äº†ä¸‹æ¥ï¼Œåªæ˜¯ç­‰åˆ°èµ·é£æ—¶ï¼Œåˆå¿å¿‘äº†èµ·æ¥ï¼Œå¥½åœ¨ä¸€è·¯å¹³å®‰ï¼Œå†åŠ ä¸Šå¤œæ™šï¼Œå¤–é¢é»‘ä¹ä¹çš„ä¸€ç‰‡ï¼Œé™¤äº†å£°éŸ³å¤§ç‚¹å¤–ï¼Œä¸€åˆ‡éƒ½è¿˜å¯ä»¥ã€‚</p><p>é£è¡Œäº†çº¦è« 4 ä¸ªå°æ—¶ï¼Œä¾¿åˆ°äº†è¶Šå—äº†ã€‚ä¸‹é£æœºåï¼Œæ‰çŸ¥é“æœ‰ä¸€ä¸ªå°æ—¶çš„æ—¶å·®ï¼Œç¬¬ä¸€æ¬¡åˆ‡èº«ä½“éªŒäº†ä¸‹æ—¶å·®ï¼Œå®åœ¨æœ‰è¶£ï¼Œèµ¶ç´§ç»™å°ä¼™ä¼´ä»¬å‘äº†æ¡å¾®ä¿¡ã€‚è½åœ°å¾ˆä¸å·§ï¼Œæ­£ä¸‹ç€å¤§é›¨ï¼Œä»¥ä¸ºè¿™å‡ æ—¥è¦åœ¨é…’åº—åº¦è¿‡äº†ã€‚è·Ÿç€å¯¼æ¸¸åˆ°äº†å½“åœ°çš„ä¸€å®¶äº”æ˜Ÿçº§é…’åº—ï¼ŒåŠç†å¥½å…¥ä½æ‰‹ç»­åï¼Œç»ˆäºå¯ä»¥å¥½å¥½çš„ä¼‘æ¯ä¸‹äº†ã€‚åªæ˜¯ç¬¬ä¸€æ¬¡å…¥ä½æµ·æ™¯æˆ¿ï¼Œçœ‹ç€çª—å¤–çš„æµ·æ™¯ï¼Œå®åœ¨è¿·äººã€‚</p><p>ä¸€å¤œå¥½æ¢¦ã€‚</p><p>æ—©æ™¨èµ·æ¥ï¼Œæ‰“å¼€çª—å¸˜ï¼Œæ˜ å…¥çœ¼å¸˜çš„ï¼Œæ˜¯è“å¤©ç™½äº‘ï¼Œå’Œç¢§è“çš„å¤§æµ·ï¼Œç¬é—´è¢«å¸å¼•ä½ï¼Œç¬¬ä¸€æ¬¡çœ‹æµ·ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409155808.jpg-growing" alt="ç¢§æµ·è“å¤©"></p><p>å”¤é†’åŒäº‹ï¼Œæ´—æ¼±å®Œæ¯•ï¼Œå»åˆ°é…’åº—äºŒæ¥¼åƒå®Œæ—©é¤ï¼Œä¾¿è¿«ä¸åŠå¾…çš„å¥”å‘å‰é¢çš„æµ·æ»©äº†ã€‚<br>é˜³å…‰ï¼Œæ²™æ»©ï¼Œæµ·æµªï¼Œè¿˜æœ‰æˆ‘ã€‚ç«™åœ¨æ²™æ»©è¾¹ï¼Œä»»å‡­æµ·æµªä¸€æ¬¡æ¬¡çš„å†²åˆ·è¿‡æ¥ï¼Œå¬ç€æµ·æµªçš„å£°éŸ³ï¼Œæ„Ÿå—ç€æµ·é£ä»é¢é¢Šå¹è¿‡ï¼Œå†²èµ°çš„æ˜¯çƒ¦æ¼ï¼Œç•™ä¸‹çš„æ˜¯æƒ¬æ„å’Œæ„‰æ‚¦ã€‚<br>åœ¨æ²™æ»©å‘†äº†ä¸€ä¼šå„¿ï¼Œä¹‹ååœ¨å¯¼æ¸¸çš„å¸¦é¢†ä¸‹ï¼Œå¼€å¯æ‰“å¡æ¨¡å¼ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409160147.jpg-growing" alt="å²˜æ¸¯é¾™æ¡¥"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409160202.jpg-growing" alt="ç¾¤å±±"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409160209.jpg-growing" alt="æ¤°æ ‘"></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409160217.jpg-growing" alt="è¶Šå—è§‚éŸ³è©è¨"></p><p>å‚æ™šæ—¶åˆ†ï¼Œå¿ƒè¡€æ¥æ½®ï¼Œæ²¿ç€æ²™æ»©çº¿ï¼Œè·‘äº† 2018 å¹´çš„ç¬¬ä¸€ä¸ªåå…¬é‡Œï¼Œå¤§æ±—æ·‹æ¼“ã€‚è™½ç„¶é…é€Ÿå¾ˆæ…¢ï¼Œä¸è¿‡é‡åœ¨äº«å—ã€‚ç¬¬ä¸€æ¬¡å›½å¤–è·‘ã€‚<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200409160234.jpg-growing" alt="å¥åº·è·‘æ­¥"></p><p>ä¸´èµ°å‰ä¸€æ™šï¼Œæ€»è§‰å¾—å°‘åšäº†ç‚¹ä»€ä¹ˆã€‚çœŸåˆ‡çš„æ„Ÿå—åˆ°äº†è¶Šå—çš„æ‘©æ‰˜è½¦å¤§å†›ï¼Œåƒåˆ°äº†ç‰¹äº§æµ·é²œï¼Œè§è¯†äº†å¤§æµ·ã€‚å“¦ï¼Œæ˜¯æ²¡æœ‰å’Œå¤§æµ·æ¥ä¸ªäº²åˆ‡çš„æ¥è§¦ï¼äºæ˜¯ä¹ï¼Œå«ä¸ŠåŒäº‹ï¼Œåœ¨ä¸ƒå…«ç‚¹é’Ÿçš„æ—¶å€™ï¼Œèµ°è¿›äº†æµ·é‡Œï¼Œæµªæ¥äº†ï¼Œæˆ‘å²¿ç„¶ä¸åŠ¨ï¼›æµªæ¥äº†ï¼Œæ²¡äº‹å„¿ï¼Œå°æµªï¼›æµªæ¥äº†ï¼Œæˆ‘å»ï¼Œè¿™ä¹ˆå¤§ï¼Œè¢«å†²é£äº†ï¼Œå·®ç‚¹è¢«å¸ä¸‹å»ï¼å“å¾—æˆ‘ç«‹é©¬å¾€åé€€äº†å¥½å‡ æ­¥ã€‚å°±è¿™æ ·ï¼Œç©äº†ä¸€ä¸ªå¤šå°æ—¶è¿˜æ„çŠ¹æœªå°½ï¼é¢‡æœ‰â€œä¸­æµå‡»æ°´æµªéé£èˆŸâ€ä¹‹æ„ã€‚</p><p>æœ€åä¸€å¤©æ—©æ™¨ï¼Œèµ·äº†ä¸ªæ—©ï¼Œå»æ²™æ»©ä¸Šè½¬ä¸€è½¬ï¼Œçœ‹è§ç©ºç€çš„æ²™æ»©æ¤…ï¼Œä¾¿èººäº†ä¸‹ï¼Œæ²¡å¤šä¹…ï¼Œè§ä¸€äººè¿‡æ¥ï¼Œè¯´äº†å¥è‹±è¯­ï¼Œè™½æ²¡å¬å¤ªæ‡‚ï¼Œä½†å¤§è‡´æ„æ€æ˜¯è¦æ”¶è´¹çš„ï¼Œæ­¤æ—¶æ‰çŸ¥é“ï¼Œè¿™æ¤…å­åŸæ¥ä¸æ˜¯éšä¾¿èººçš„ï¼Œç«‹é©¬èµ·èº«èµ°äº†ï¼Œå“ˆå“ˆã€‚</p><p>å°†æ‹–é‹æ”¾åˆ°é…’åº—å‰é¢çš„æ ‘ä¸‹ï¼Œèµ¤ç€è„šæ²¿ç€æ²™æ»©æ™¨è·‘äº†èµ·æ¥ã€‚çªç„¶çœ‹åˆ°é›¶æ˜Ÿçš„è´å£³èººåœ¨æ²™æ»©ä¸Šï¼Œé¡¿æ—¶æ¡äº†èµ·æ¥ï¼Œå›æ¥çš„è·¯ä¸Šæ›´æ˜¯æ²¡è·‘äº†ï¼Œä¸€æ¥æ˜¯æƒ³ç€å†æ¡ç‚¹è´å£³ï¼ŒäºŒæ¥æ˜¯è„šåº•æ¿æ˜¯åœ¨æ˜¯ç–¼ï¼æœ€åæ‹¿ç€ä¸€æ‰‹çš„è´å£³ï¼Œå»é¤å…å’ŒåŒäº‹ä»¬ä¸€èµ·åƒæ—©é¤ã€‚ä¸€æ‰‹çš„è´å£³è¢«åŒäº‹åˆ†å…‰ï¼Œåªç•™ä¸‹äº†ä¸€ä¸ªæµ·èº(è¿˜å¥½æˆ‘äº‹å…ˆæŠŠè¿™å”¯ä¸€çš„å°æµ·èºæ”¶äº†èµ·æ¥)ã€‚åƒå®Œæ—©é¤ï¼Œæ›´æ˜¯å¸¦ç€ä»–ä»¬åˆå»æ¡äº†ä¸€éã€‚åªæ˜¯å‡ æ— æ”¶è·ã€‚è¿™å°±å«æ—©èµ·çš„é¸Ÿå„¿æœ‰è™«åƒå§ã€‚</p><p>ä¸‹åˆï¼Œä¹˜åå¤§å·´å¥”èµ´æœºåœºï¼Œæ™šä¸Šå…«ç‚¹å¤šï¼Œè½åœ°è§å±±å›½é™…æœºåœºï¼Œä¸‰å¤©çš„è¡Œç¨‹å°±æ­¤ç»“æŸã€‚</p><p>ç»™æˆ‘ç•™ä¸‹çš„ï¼Œé™¤äº†ä¸€ä¸ªå°æµ·èºï¼Œè¿˜æœ‰æˆ‘é‚£æ™’ä¼¤çš„åŒè„š(ç›´æ¥å¯¼è‡´åé¢ç©¿æ‹–é‹ä¸Šç­)ï¼Œä»¥åŠé‚£ä¹ˆå¤šæœ‰è¶£çš„ç¬¬ä¸€æ¬¡ã€‚</p><p>ä»¥ä¸Š</p><p>äº 2018.9</p><blockquote><p>ä»¥å‰å‘åœ¨ç®€ä¹¦çš„æ–‡ç« ï¼Œå¯æ˜¯æœ€è¿‘ç®€ä¹¦è«åå°äº†æˆ‘çš„è´¦å·ã€‚åˆæ°é€¢è‡ªå·±æœ‰äº†è‡ªå·±çš„ blogï¼Œä¾¿æŠŠä¹‹å‰çš„ä¸€äº›è®°å¿†æ‹¿äº†å›æ¥ã€‚</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> travels </category>
          
      </categories>
      
      
        <tags>
            
            <tag> travels </tag>
            
            <tag> danang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¥¿æ¸¸äº¦è¥¿è¡Œ -- è—åŒºæ¸¸è®°&lt;å®Œ&gt;</title>
      <link href="/travels/tibet-2/"/>
      <url>/travels/tibet-2/</url>
      
        <content type="html"><![CDATA[<p>éƒ½è¯´å—è¿¦å·´ç“¦å³°ç»ˆå¹´äº‘é›¾ç¼­ç»•ï¼Œä¸è‚¯éœ²å‡ºçœŸé¢ç›®ï¼Œæ•…è€Œå¾—åç¾å¥³å³°ã€‚</p><p>å¯èƒ½æ˜¯æˆ‘ä»¬è¿™ç¾¤äººç¡®å®è¿æ°”ä¸é”™ï¼Œå¼€è½¦çš„å¸ˆå‚…ä¹Ÿè¯´å¾ˆéš¾å¾—ï¼Œæˆ‘ä»¬åˆ°æ—èŠçš„é‚£å¤©å‚æ™šï¼Œå°±çœ‹åˆ°äº†è—äºäº‘é›¾ä¹‹åçš„çœŸå®¹ï¼Œè™½ç„¶åªéœ²å‡ºäº†å¾ˆçŸ­çš„æ—¶é—´ã€‚</p><p>å¾ˆç¾ä¸½ã€‚</p><p>å¯æ˜¯æˆ‘å´æ›´å–œæ¬¢è·¯ä¸Šé‡åˆ°çš„ä¸€ä¸ªå¤šé›„æ‹‰é›ªå±±ã€‚</p><p>å‚æ™šæ—¶åˆ†ï¼Œå¤•é˜³ä¸‹å±±ï¼Œå¯æ˜¯è—åŒºçš„å¤•é˜³ï¼Œå¹¶éå¦‚æ±Ÿå—é‚£èˆ¬æŸ”å’Œã€‚æˆ‘ååœ¨è½¦é‡Œï¼Œçœ‹ç€çª—å¤–çš„æ™¯è‰²ã€‚ä¹Ÿä¸çŸ¥ä¸ºä»€ä¹ˆï¼Œå°±æŠ¬èµ·äº†å¤´ï¼Œå°±è§é‚£åº§é›ªå³°ç«‹åœ¨é‚£é‡Œã€‚é˜³å…‰é€è¿‡å®ƒå°–ä¸Šç»ˆå¹´ä¸åŒ–çš„ç§¯é›ªï¼Œä½¿å¾—é‚£æœ¬å°±æ´ç™½çš„é›ªï¼Œç«Ÿæ˜¾å¾—åœ£æ´èµ·æ¥ã€‚æˆ‘ç›¯ç€çœ‹äº†å¾ˆä¹…ï¼Œä»¥è‡³äºå¿˜äº†å–Šå¸ˆå‚…åœä¸‹æ¥æ‹å¼ ç…§ç‰‡ã€‚</p><p>æ˜¯çš„ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šé€‰æ‹©ç”¨ç…§ç‰‡æ¥è®°å½•ä¸‹è¿™äº›ç¾å¥½çš„ç¬é—´ã€‚åªæ˜¯è¿™æ¬¡ï¼Œæˆ‘å¾—è®°åœ¨å¿ƒé‡Œäº†ã€‚</p><p>æˆ‘ä»¬åœ¨è¿™ä¸ªå°æ‘åº„é‡Œå‘†äº†ä¸€å®¿ï¼Œç¬¬äºŒå¤©å°±ç»§ç»­ä¸Šè·¯äº†ã€‚</p><p>å»äº†å·´æ¾æªï¼Œå»äº†è‰²å­£æ‹‰å±±ï¼Œå»äº†ä¼ è¯´ä¸­çš„ç¾Šæ¹–ï¼Œå»äº†æ—¥å–€åˆ™ï¼Œå»äº†ç»’å¸ƒå¯ºï¼Œé¡ºä¾¿åœ¨ç å³°å¤§æœ¬è¥ä½äº†ä¸€æ™šä¸Šã€‚</p><p>è¦ä¸æ€ä¹ˆè¯´æˆ‘ä»¬è¿æ°”å¥½ï¼Œå¸ˆå‚…è¯´å¤§æœ¬è¥é‚£å‡ å¤©æ‰å¼€æ”¾ï¼</p><p>æˆ‘ç°åœ¨è¿˜è®°å¾—ï¼Œåœ¨æµ·æ‹” 5000 ç±³çš„å¤§æœ¬è¥ï¼Œæˆ‘æ¿€åŠ¨çš„å¿˜è®°äº†ç¼ºæ°§è¿™å›äº‹å„¿ã€‚ä¸€ä¸ªäººåœ¨é‚£è·³æ¥è·³å»ï¼Œè·‘æ¥è·‘å»ã€‚ä»ä½çš„å¸ç¯·è·‘åˆ°ç»’å¸ƒå¯ºï¼Œåˆä»ç»’å¸ƒå¯ºè·‘åˆ°ç å³°çš„ç•Œç¢‘é‚£ï¼Œå¿«å“‰ã€‚</p><p>æˆ‘ä»¬åœ¨åˆ»æœ‰ 8844.43 çš„ç•Œç¢‘é‚£æ‹ç…§ï¼Œèº«åå°±æ˜¯ä¼ è¯´ä¸­çš„ç å³°ã€‚</p><p>ç­‰æˆ‘åœ¨å¤–é¢æºœè¾¾å®Œå›åˆ°å¸ç¯·æ—¶ï¼Œå‡ ä¸ªå°ä¼™ä¼´éƒ½åœ¨é‚£å®‰é™çš„æ•´ç†ä¸€è·¯ä¸Šçš„ç…§ç‰‡ã€‚</p><p>æ™šä¸Šç¡è§‰çš„æ—¶å€™ï¼Œæœ¬ä»¥ä¸ºç»è¿‡å¥½å‡ ä¸ªæ™šä¸Šçš„ç£¨ç»ƒï¼Œå·²ç»å¯ä»¥é€‚åº”äº†ã€‚å¯è¿˜æ˜¯å°çœ‹äº†è¿™ 5000 ç±³æµ·æ‹”çš„å‰å®³ã€‚</p><p>ç»ˆäºç†¬åˆ°å‡Œæ™¨å››ç‚¹å·¦å³ï¼Œæ‹‰ç€å‡ ä¸ªå°ä¼™ä¼´å“†å“†å—¦å—¦çš„è·‘èµ·æ¥ï¼Œå»æ‹æ˜Ÿæ˜Ÿå»äº†ã€‚</p><p>å†·ï¼Œæ˜¯çœŸçš„å†·ã€‚</p><p>å¤œç©ºçš„æ˜Ÿæ˜Ÿï¼Œç¡®å®æ¯”å¹³æ—¥é‡Œçœ‹åˆ°çš„è¦å¤šçš„å¤šã€‚åªæ˜¯å°æ—¶å€™ï¼Œå¤å¤©çš„å¤œæ™šï¼Œæ˜Ÿæ˜Ÿä¹Ÿå‡ºå¥‡çš„å¤šï¼Œå‡ºå¥‡çš„äº®ã€‚</p><p>æˆ‘ä»¬å‡ ä¸ªäººï¼Œå°±åœ¨ç‘Ÿç‘Ÿå¯’é£ä¸­ï¼Œä¸€è¾¹æ‹ç€å»¶æ—¶ï¼Œä¸€è¾¹ä½å£°èŠç€å¤©ã€‚</p><p>ä»å¤§æœ¬è¥ä¸‹æ¥åï¼Œæ•´ä¸ªçš„è—åŒºä¹‹è¡Œï¼Œå·®ä¸å¤šå°±è¦ç»“æŸäº†ã€‚</p><p>ä¸‹æ¥åï¼ŒåŒè¡Œçš„ä¸€ä¸ªå§‘å¨˜ï¼Œè™½ç„¶æ˜¯ä¸ªå—æ–¹å¥³å­©å­ï¼Œå´ç”šæ˜¯è±ªçˆ½çš„åœ¨åƒé¥­çš„æ—¶å€™ï¼Œæ‹‰ç€æˆ‘ä»¬å–èµ·äº†é…’ï¼Œè‡ªç„¶æ˜¯å•¤é…’ã€‚</p><p>åªæ˜¯ç†Ÿæ‚‰æˆ‘çš„äººéƒ½çŸ¥é“ï¼Œé…’é‡å·…å³°æœŸåº”è¯¥æ˜¯å¤§å­¦é‚£ä¼šå„¿ï¼Œæ›¾ç»å–è¿‡ä¸€ç“¶å¤šçš„å•¤é…’ï¼Œå–å®Œå›å®¿èˆåï¼Œå°±å»å•æ‰€åäº†ã€‚ç„¶è€Œæ­¤åˆ»ï¼Œå´æ˜¯çœŸåˆ‡çš„è§‰å¾—ï¼Œå°±è¯¥å–ä¸€ç‚¹ã€‚</p><p>å¥½åœ¨å¸ˆå‚…å¾ˆå…‹åˆ¶ï¼ŒçŸ¥é“æ˜å¤©è¿˜è¦å¼€è½¦ä¸Šè·¯ï¼Œå°±æ¯ä¸ªäººéƒ½åªå–äº†ä¸€ç‚¹ã€‚å—¯ï¼Œé‚£è‡ªç„¶æ˜¯å¯¹ä»–ä»¬è€Œè¨€ï¼äºæˆ‘ï¼Œè™½ç„¶æˆ‘å¿˜è®°å–äº†å¤šå°‘ï¼Œä½†æ˜¯å›å»åï¼Œæˆ‘å°±å…¨èº«æ³›çº¢ï¼Œå¤´æ™•è„‘èƒ€äº†ã€‚</p><p>é‚£ä¸ªæ—¶å€™ï¼Œæˆ‘åªæƒ³ç€ç¡ä¸€è§‰ï¼Œå¯æ˜¯é‚£å‡ ä¸ªå®¶ä¼™ï¼Œå´ååè¦æ‰“æ¼è›‹ï¼ä½œä¸ºä¸€ä¸ªå¤´æ™•è„‘èƒ€ä¸”åŸºæœ¬ä¸ä¼šæ‰“æ¼è›‹çš„äººè€Œè¨€ï¼Œå’Œä»–ä»¬æ‰“äº†å¥½ä¸€ä¼šå„¿ã€‚</p><p>åªæ˜¯è¿™æ®µæ—¶å…‰ï¼Œæ­¤åˆ»æƒ³èµ·æ¥ï¼Œå¼‚å¸¸æ€€å¿µã€‚</p><p>çªç„¶æƒ³èµ·ä¸€å…«å¹´çš„å…ƒæ—¦ï¼Œå’Œå‡ ä¸ªæœ‹å‹å»é»„å±±ç©ï¼Œä¹Ÿæ˜¯åœ¨å›æ¥çš„å‰ä¸€ä¸ªæ™šä¸Šï¼Œæ‰“äº†å¥½ä¸€ä¼šå„¿ç‰Œï¼Œæœ€åæˆ¿ä¸œæ‰“ç”µè¯æ¥ï¼Œè¯´æœ‰æ—…å®¢æŠ•è¯‰æˆ‘ä»¬å¤ªåµäº†ã€‚ã€‚ã€‚</p><p>ä¸è¿‡è¿™æ¬¡è‡ªæ˜¯æ²¡æœ‰äººæŠ•è¯‰çš„ã€‚</p><p>åé¢å›åˆ°æ‹‰è¨ï¼Œæ¯ä¸ªäººéƒ½ä¹°äº†ä¸€å †çš„ç‰¦ç‰›å¹²ä»€ä¹ˆçš„åœŸç‰¹äº§ï¼Œé€åŒäº‹ï¼Œé€æœ‹å‹ï¼Œè‡ªå·±äº«ç”¨ï¼Œéƒ½æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚</p><p>å†åé¢ï¼Œå°±æ˜¯å¸ˆå‚…å¤§æ¸…æ—©çš„ï¼Œé€æˆ‘ä»¬å»è´¡å˜æœºåœºã€‚</p><p>è€Œåæˆ‘ä»¬å°±ç¦»è¥¿è—è¶Šæ¥è¶Šè¿œã€‚</p><p>è€Œåæˆ‘ä»¬å‡ ä¸ªå°ä¼™ä¼´ä¹Ÿå„è‡ªåˆ†åˆ«ã€‚</p><p>æ¯ä¸ªå»è¥¿è—çš„äººï¼Œéƒ½ç›¼ç€èƒ½æ´—æ¶¤å¿ƒçµã€‚åªæ˜¯ï¼Œç»™æˆ‘çš„æ„ŸåŠ¨ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œå·²å¯¥å¯¥æ— å‡ ã€‚å¤šå‡ºæ¥çš„ï¼Œåªæ˜¯å’Œåˆ«äººçš„è°ˆèµ„ã€‚</p><p>æˆ–è®¸åœ¨æŸä¸ªé˜³å…‰æ˜åªšçš„ä¸‹åˆï¼Œæˆ‘ååœ¨ç”µè„‘é¢å‰æ•²ä»£ç ï¼Œå¶å°”é—­ä¸Šçœ¼ç›ï¼Œä¼šä¸ç»æ„æƒ³èµ·è¿™æ®µæ—…ç¨‹æ¥ã€‚</p><p>ä»¥ä¸Š</p><p>äº 2019.4</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> travels </category>
          
      </categories>
      
      
        <tags>
            
            <tag> travels </tag>
            
            <tag> tibet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¥¿æ¸¸äº¦è¥¿è¡Œ -- è—åŒºæ¸¸è®°</title>
      <link href="/travels/tibet/"/>
      <url>/travels/tibet/</url>
      
        <content type="html"><![CDATA[<p>ä¸çŸ¥ä¸è§‰ï¼Œè¿›è—å·²ä¸‰æ—¥æœ‰ä½™ã€‚</p><p>è®°å¾—é£æœºé™è½åœ¨è´¡å˜æœºåœºï¼Œä¸€ç›´å½“å¿ƒçš„é«˜åæ²¡æœ‰å‘ç”Ÿåï¼Œæ˜¯é›€è·ƒçš„ã€‚åªæ˜¯éšåçš„ä¸€ç³»åˆ—ä¸é€‚ï¼Œè®©æˆ‘è®°å¿†çŠ¹æ–°ã€‚</p><p>å½“æ™šåˆ°è¾¾é…’åº—åï¼Œæ²¡æœ‰æ´—æ¾¡(è¿›è—åä¸è¦è½»æ˜“æ´—æ¾¡)ï¼Œç®€å•æ´—æ¼±åç›´æ¥å…¥ç¡ã€‚ç„¶è€Œä¼´éšè€Œæ¥çš„æ˜¯ä¸€ä¸¤ä¸ªå°æ—¶å°±é†’æ¥ä¸€æ¬¡çš„ç®€çŸ­ç¡çœ ï¼Œå¿ƒè„åŠ é€Ÿï¼Œå¤´ç–¼ã€‚åªç›¼ç€æ—©ç‚¹å¤©äº®ï¼Œå°±ä¸ç”¨å†ç¡è§‰äº†ã€‚</p><p>å¤ªé˜³ç»ˆç©¶è¿˜æ˜¯ç¼“ç¼“å‡äº†èµ·æ¥ï¼Œæˆ‘ä¹Ÿç»ˆäºä¸ç”¨ç»§ç»­èººåœ¨åºŠä¸Šã€‚æœ‰è¶£çš„æ˜¯ï¼Œå½“æˆ‘èµ°å‡ºé…’åº—ï¼Œä¹‹å‰æ‰€æœ‰çš„ä¸é€‚ç»Ÿç»Ÿæ¶ˆæ•£ï¼Œæˆ‘ä»¬å»åƒæ—©é¤ï¼Œå–ç”œèŒ¶ï¼Œæ¼«æ­¥äºè¥¿è—è¡—é“ï¼Œæµè¿åœ¨å¸ƒè¾¾æ‹‰å®«ã€‚</p><p>ä¸€è·¯ä¸Šçœ‹ç€æˆ–æ»åŠ¨ä½›ç ï¼Œæˆ–è½¬åŠ¨è½¬ç»ç­’ï¼Œæˆ–ä¸‰æ­¥ä¸€æ‰£çš„äººä»¬ï¼Œè‚ƒç©†è€Œè™”è¯šã€‚åœ¨è¿™é‡Œï¼Œä½ èƒ½å¤ŸçœŸçœŸåˆ‡åˆ‡çš„çœ‹åˆ°ä¿¡ä»°ã€‚åœ¨å¤§æ˜­å¯ºï¼Œä¼—å¤šçš„ä¿¡å¾’ä»¬åœ¨è¡Œç€è·ªæ‹œç¤¼æœåœ£ã€‚æœ‰æˆ´ç€çœ¼é•œæ–¯æ–¯æ–‡æ–‡çš„é’å¹´ï¼Œæœ‰ç©¿ç€æ—¶å°šç»“ä¼´è€Œè¡Œçš„å¤«å¦»ï¼Œæœ‰å¤´æ‰é•¿è¾«ä¸€èº«è‰ºæœ¯æ°”æ¯çš„ç‹¬è¡Œè€…ï¼Œè¿˜æœ‰å¹´è¿ˆæ²§æ¡‘çš„è€äººï¼Œä½ æ— æ³•çŸ¥é“ä»–ä»¬å„è‡ªçš„ç›®çš„ï¼Œæ˜¯å¯»æ±‚å†…å¿ƒçš„å®‰å®ï¼Œæ˜¯æ¸´æœ›ä½›ç¥–çš„å¸®åŠ©ï¼Œæ˜¯é€ƒç¦»ç”Ÿæ´»çš„è‹¦éš¾ï¼Œè¿˜æ˜¯ä»…ä»…ä¼ ä¸‹çš„ä¸€ç§ä»ªå¼ã€‚ä¸ç®¡æ˜¯ä»€ä¹ˆï¼Œä»–ä»¬éƒ½åœ¨è‡ªå·±çš„ä¿¡ä»°ä¸‹ï¼Œæ˜‚é¦–å‰è¡Œã€‚</p><p>æˆ‘åœ¨æœ‹å‹åœˆå†™åˆ°</p><blockquote><p>ç°åœ¨ï¼Œäº²çœ¼çœ‹ç€æœåœ£è€…ä»¬ä¸‰æ­¥ä¸€è·ªï¼Œä¸€å¿ƒå‘å‰ï¼Œä»¿ä½›è¿™ä¸ªä¸–ç•Œï¼Œå¯ä»¥ç®€å•åˆ°ä»–å’Œä»–å¿ƒä¸­çš„ä¿¡ä»°ï¼Œå†æ— å…¶ä»–ã€‚</p></blockquote><p>å…¶ä¸­ä¸€ä¸ªæœ‹å‹ç•™è¨€é—®æˆ‘è¯´ï¼Œä½ æœ‰ä¿¡ä»°ä¹ˆï¼Ÿå¦ç™½è¯´ï¼Œæˆ‘æ˜¯æ²¡æœ‰çš„ã€‚å¦‚æœç¡¬è¦è¯´æœ‰ï¼Œé‚£æ— éæ˜¯ä¿¡å¥‰é’±ã€‚æˆ‘ä»¬ä»å°åˆ°å¤§æ¥å—åˆ°çš„æ•™è‚²ï¼ŒåŒ…æ‹¬å„è·¯åª’ä½“å¹æ§çš„æ‰€è°“æˆåŠŸï¼Œéƒ½åœ¨æœ‰æ„æ— æ„çš„å‘Šè¯‰æˆ‘ä»¬é’±çš„é­…åŠ›ã€‚å¾ˆæ˜¾ç„¶ï¼Œæˆ‘æ¥å—äº†è¿™æ ·çš„è®¤çŸ¥ã€‚</p><p>è¿™äº›ä¹Ÿåªæ˜¯å¯¹æˆ‘ä»·å€¼è§‚çš„ä¸€æ¬¡å†²å‡»ï¼Œå¹¶ä¸ä¼šæ¯ç­æ‰ã€‚æˆ‘æƒ³å›å»ä¹‹åï¼Œè¿˜æ˜¯ä¼šå’Œå¾€å¸¸ä¸€æ ·ã€‚å½“ç„¶ï¼Œè‹¥æ˜¯èƒ½å› æ­¤æœ‰ä¸€äº›æ”¹å˜ï¼Œé‚£è‡ªæ˜¯æœ€å¥½ä¸è¿‡äº†ã€‚</p><p>æ™šä¸Šæ‹å®Œå¸ƒè¾¾æ‹‰å®«çš„å¤œæ™¯ï¼Œæ‰“ç®—å›å»æ—¶ï¼Œæ‰é€šè¿‡ç”µè¯å¾—çŸ¥æœ‰äººæ„Ÿå†’ã€‚éƒ½è¯´é«˜åŸåœ°åŒºçš„æ„Ÿå†’å¾ˆå¯æ€•ï¼Œè¦ååˆ†å½“å¿ƒã€‚æˆ‘ä»¬ä¾¿ç«‹é©¬èµ¶å»åŒ»é™¢ã€‚å¥½åœ¨æ‰“é’ˆåŠ åƒè¯åŠ è´´å„ç§é€€çƒ§è´´åï¼Œå¥½äº†èµ·æ¥ã€‚å¯æ˜¯æˆ‘å€’ä¸‹äº†ã€‚</p><p>æ™šä¸Šçš„ç¡çœ ä¾æ—§å’ŒæŒ¤ç‰™è†ä¸€æ ·ã€‚æ—©æ™¨æ‰“ç®—èµ·æ¥æ—¶æ‰å‘ç°ï¼Œä¸€ç‚¹éƒ½ä¸æƒ³åŠ¨ï¼Œå¤´ç–¼ï¼Œæ™•ï¼Œå¿ƒè„å¿«é€Ÿè·³åŠ¨ä»¥æŠ—è®®è¿™ä¸ªèº«ä½“çš„ä¸»äººï¼Œèµ·æ¥æ²¡èµ°å‡ æ­¥å°±æƒ³åã€‚åœ¨åäº†å¥½å‡ å£å£æ°´ï¼Œä»¥åŠåŒä¼´ä»¬å„ç§è¯ç‰©çš„æ”¯æ’‘ä¸‹ï¼Œç»ˆäºæ…¢æ…¢å¥½äº†èµ·æ¥ã€‚</p><p>æ²¿é€”å»åŠç†è¾¹é˜²è¯çš„æ—¶å€™ï¼Œæˆ‘æ²¿ç€æ²³è¾¹æ…¢æ…¢æ•£æ­¥ï¼Œèº«è¾¹å¶å°”ç»è¿‡å‡ ä¸ªæ™¨è·‘è€…ï¼Œå†…å¿ƒä¹Ÿè·ƒè·ƒæ¬²è¯•ã€‚äºæ˜¯åœ¨æµ·æ‹” 3600 å¤šç±³çš„æ‹‰è¨ï¼Œè·‘äº†ä¸åˆ°ä¸€ç™¾ç±³ï¼Œç«‹é©¬å°±å¼€å§‹å¤§å£å–˜æ°”ï¼Œåªèƒ½ç«‹å³åœä¸‹æ¥ã€‚</p><p>ä½ é™¤äº†æƒ³åˆ°å‘¼å¸ï¼Œæ„Ÿå—åˆ°å¤´ç–¼ï¼Œå…¶ä»–çš„ä¼¼ä¹ä¸€ä¸‹å­éƒ½ä¸è§äº†ã€‚</p><p>æ™šä¸Šçš„ç¯ç«èˆä¼šï¼Œä¹Ÿæ…¢æ…¢è®©æ—…è¡Œå˜å¾—æ¬¢å¿«èµ·æ¥ã€‚çœ‹ç€è€å¤§çˆ·ä»¬è½½æ­Œè½½èˆï¼Œæ— è®ºæ˜¯ä¸æ˜¯å·¥ä½œéœ€è¦ï¼Œæˆ‘æƒ³ï¼Œå½“ä¸‹ï¼Œä»–ä»¬éƒ½æ˜¯å¼€å¿ƒçš„ã€‚æˆ‘ä¹Ÿå¸Œæœ›åœ¨é‚£ä¸ªå¹´çºªï¼Œä¾æ—§æœ‰ç€ä¸€é¢—å¹´è½»çš„ï¼ŒèºåŠ¨çš„å†…å¿ƒã€‚</p><p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ä¹ æƒ¯ä»¥è‡ªå·±çš„è®¤çŸ¥å»è¯„åˆ¤ä¸€äº›äº‹æƒ…ã€‚å°±å¥½åƒæˆ‘è§‰å¾—å…¬åŠ¡å‘˜ä¸€ç›´å¾ˆè½»æ¾ä¸€æ ·ï¼Œå°±å¥½åƒæˆ‘è§‰å¾—é‚£ä¸ªè·³èˆçš„å¤§å”ä¸€ç›´å¾ˆå¿«ä¹ä¸€æ ·ã€‚</p><p>è¥¿è—ä¹‹æ—…ç»§ç»­ã€‚</p><p>ä»¥ä¸Š</p><p>äº 2019.4</p><blockquote><p> ä»¥å‰å‘åœ¨ç®€ä¹¦çš„æ–‡ç« ï¼Œå¯æ˜¯æœ€è¿‘ç®€ä¹¦è«åå°äº†æˆ‘çš„è´¦å·ã€‚åˆæ°é€¢è‡ªå·±æœ‰äº†è‡ªå·±çš„ blogï¼Œä¾¿æŠŠä¹‹å‰çš„ä¸€äº›è®°å¿†æ‹¿äº†å›æ¥ã€‚</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> travels </category>
          
      </categories>
      
      
        <tags>
            
            <tag> travels </tag>
            
            <tag> tibet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Part 4 --ZooKeeper Zab Protocol</title>
      <link href="/zookeeper/zab/"/>
      <url>/zookeeper/zab/</url>
      
        <content type="html"><![CDATA[<h1 id="ZooKeeper-lt-å››-gt-ZAB-åè®®"><a href="#ZooKeeper-lt-å››-gt-ZAB-åè®®" class="headerlink" title="ZooKeeper<å››> ZAB åè®®"></a>ZooKeeper&lt;å››&gt; ZAB åè®®</h1><p>zab åè®®å…¨ç§° ZooKeeper Atomic Broadcast Protocol ã€‚</p><p>å®ƒä½œä¸º zk æœ€æ ¸å¿ƒçš„åè®®ï¼Œè´¯ç©¿äº† zk çš„å§‹ç»ˆã€‚    </p><p>æˆ‘ä»¬çŸ¥é“ zk ä»å¯åŠ¨åˆ°æŒ‚æ‰ï¼Œæ— éåšè¿™ä¹ˆå‡ ä»¶äº‹ï¼š</p><ul><li>é€‰ä¸¾ leader</li><li>å‘ç° server</li><li>åŒæ­¥ äº‹åŠ¡</li><li>å¹¿æ’­ äº‹åŠ¡</li><li>å´©æºƒå†é€‰ä¸¾</li></ul><p>è€Œ zab åˆ™æ˜¯è¿™äº›äº‹æƒ…çš„ä¿éšœï¼Œå®ƒè®©æ‰€æœ‰çš„äº‹æƒ…æŒ‰ç…§æˆ‘ä»¬æœŸå¾…çš„æ–¹å‘è¡Œè¿›ã€‚ç°åœ¨å»çœ‹çœ‹ zk ç©¶ç«Ÿæ˜¯å¦‚ä½•å»åšè¿™äº›äº‹æƒ…çš„ã€‚</p><h2 id="Election"><a href="#Election" class="headerlink" title="Election"></a>Election</h2><p>å‰æ–‡å·²ç»ä»‹ç»ï¼Œzk ä½¿ç”¨ FLE è¿›è¡Œé€‰ä¸¾ï¼Œæ˜¯ç°åœ¨ zk å”¯ä¸€æ”¯æŒçš„é€‰ä¸¾ç®—æ³•ã€‚è¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p>å…¶ä»–é˜¶æ®µï¼Œè¿™é‡Œåˆ† Leader  å’Œ Follower ä¸¤ä¸ªè§’è‰²è¿›è¡Œè§£è¯»ã€‚</p><h2 id="Leader"><a href="#Leader" class="headerlink" title="Leader"></a>Leader</h2><h3 id="1-Discovery"><a href="#1-Discovery" class="headerlink" title="1. Discovery"></a>1. Discovery</h3><p>æˆ‘ä»¬å‰é¢è§£ææºç çš„æ—¶å€™ï¼Œåœ¨ <code>QuorumPeer</code> è¿™ä¸ªç±»é‡Œï¼Œè¯´è¿‡å®ƒçš„ <code>run</code> æ–¹æ³•ï¼Œé‡Œé¢æœ‰ä¸ª <code>switch...case</code> ï¼Œä¼šå¯¹ <code>serverState</code> çš„ä¸åŒçŠ¶æ€ï¼Œåšä¸åŒå¤„ç†ã€‚</p><p>å½“æ—¶æˆ‘ä»¬çœ‹äº† <code>LOOKING</code> çš„ caseï¼Œå› ä¸ºè¿™é‡Œæ˜¯ election çš„å…¥å£ã€‚</p><p>ç°åœ¨é€‰ä¸¾ç»“æŸåï¼Œ<code>serverState</code> ä¼šåˆ‡æ¢æˆå…¶ä»–çŠ¶æ€ï¼ŒåŒæ—¶ zabState ä¹ŸåŒæ ·ä¼šåˆ‡æ¢</p><p>æˆ‘ä»¬å†æ¥çœ‹ä¸‹è¿™ä¸ª<code>run</code> æ–¹æ³•(æˆªå–éƒ¨åˆ†)ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// æºç å‚è€ƒï¼š org.apache.zookeeper.server.quorum.QuorumPeer#run</span><span class="token keyword">case</span> LEADING<span class="token operator">:</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token function">setLeader</span><span class="token punctuation">(</span><span class="token function">makeLeader</span><span class="token punctuation">(</span>logFactory<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è¿™ä¸ªæ–¹æ³•é‡Œæœ‰ä¸€ä¸ª while ï¼Œå¦‚æœé€€äº†å‡ºæ¥ï¼Œ</span>        <span class="token comment" spellcheck="true">// è¯´æ˜è¯¥ server çš„é¢†å¯¼ç»“æŸï¼Œä¼šè¿›è¡Œä¸‹ä¸€æ¬¡çš„é€‰ä¸¾</span>        leader<span class="token punctuation">.</span><span class="token function">lead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">setLeader</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        LOG<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"Unexpected exception"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>leader <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            leader<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token string">"Forcing shutdown"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">setLeader</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// è¿™é‡Œä¼šæŠŠ serverState é‡æ–°ç½®ä¸º LOOKING çŠ¶æ€</span>        <span class="token comment" spellcheck="true">// ä»è€Œåœ¨æ•´ä¸ª while é‡Œå†æ¬¡å‘èµ·é€‰ä¸¾</span>        <span class="token function">updateServerState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>å¥½ï¼Œä»ä¸Šé¢èƒ½çœ‹åˆ°ï¼Œè¢«é€‰ä¸º leader åï¼Œæ‰€æœ‰çš„å¥¥ç§˜ï¼Œéƒ½åœ¨ <code>leader.lead()</code> è¿™ä¸ªæ–¹æ³•ä¸­äº†ã€‚ç°åœ¨å»çœ‹çœ‹è¿™ä¸ªå®¶ä¼™ï¼Œç©¶ç«ŸèƒŒç€æˆ‘ä»¬éƒ½åšäº†äº›ä»€ä¹ˆï¼ï¼ï¼</p><p>æˆ‘çœ‹äº†ä¸‹è¿™ä¸ªæ–¹æ³•ï¼Œ ä» 576 è¡Œåˆ° 874 è¡Œï¼Œå…±è®¡ <code>874 - 576 = 298</code> è¡Œï¼Œæˆ‘ä»¬å¹³æ—¶è¿™ä¹ˆå†™ä»£ç ï¼Œä¼°è®¡ä¼šè¢«æ‰“æ­»ï¼Œç„¶åé¢†å¯¼ä»¬è¯´ï¼Œä½ è¿™ä¸ªæ–¹æ³•æ€ä¹ˆèƒ½å†™è¿™ä¹ˆå¤šè¡Œå‘¢ï¼ï¼ï¼ å•Šå“ˆå“ˆå“ˆ :joy:</p><p><strong>æ•´ä¸ªé˜¶æ®µéƒ½éœ€è¦å¯¹ç…§ï¼š</strong></p><pre><code>org.apache.zookeeper.server.quorum.LearnerHandler#run</code></pre><p><strong>LearnerHandler</strong> ï¼Œä¼šä¸ºæ¯ä¸€ä¸ªè·Ÿéšè€…åˆ†é…ä¸€ä¸ªè¿æ¥ï¼Œè´Ÿè´£å’Œ server æ•´ä¸ªç”Ÿå‘½å‘¨æœŸé—´çš„é€šä¿¡ã€‚</p><p>åŒæ—¶æ³¨æ„ <code>Leader</code> å’Œ <code>LearnerHandler</code> åœ¨å‡ ä¸ªå…³é”®èŠ‚ç‚¹çš„åŒæ­¥ï¼š</p><ul><li><p>getEpochToProposeï¼šhandler ä¼šè·å–è¶…è¿‡åŠæ•°çš„ server epochï¼Œä¸€æ¬¡äº§ç”Ÿ leader æ–°çš„ epoch </p></li><li><p>waitForEpochAck ï¼š handler ä¼šè·å–è¶…è¿‡åŠæ•°çš„ server ack ï¼Œä»¥æ­¤ä¸ºåŸºç¡€è¿›è¡ŒåŒæ­¥</p></li><li><p>waitForNewLeaderAckï¼šç­‰å¾… server åŒæ­¥çš„ç»“æœã€‚æ•´ä¸ªåŒæ­¥è¿‡ç¨‹ï¼Œéƒ½æ˜¯ handler è´Ÿè´£å¤„ç†çš„ã€‚</p></li></ul><p>æ­£æ˜¯é€šè¿‡è¿™å‡ ä¸ªæ–¹æ³•ï¼Œä½¿å¾—è™½ç„¶æ˜¯å¼‚æ­¥è¿›è¡Œï¼Œä½†æœ€ç»ˆåœ¨å…³é”®èŠ‚ç‚¹ä¸Šï¼Œéƒ½ä¼šç­‰å¾…å„è‡ªå®Œæˆå„è‡ªçš„äº‹æƒ…ï¼ï¼ï¼</p><pre class=" language-java"><code class="language-java">self<span class="token punctuation">.</span><span class="token function">setZabState</span><span class="token punctuation">(</span>QuorumPeer<span class="token punctuation">.</span>ZabState<span class="token punctuation">.</span>DISCOVERY<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•å¼€å§‹æ—¶ï¼Œå°† <code>zabState</code> çš„çŠ¶æ€è®¾ç½®ä¸ºäº† <code>DISCOVERY</code> ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œzk æ­£å¼ä»é€‰ä¸¾é˜¶æ®µè¿›å…¥åˆ°å‘ç°é˜¶æ®µï¼š</p><pre class=" language-java"><code class="language-java">self<span class="token punctuation">.</span><span class="token function">setZabState</span><span class="token punctuation">(</span>QuorumPeer<span class="token punctuation">.</span>ZabState<span class="token punctuation">.</span>DISCOVERY<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¿™é‡ŒæŠŠè‡ªå·±çš„ epoch å’Œ zxid æ”¾åˆ° StatueSummary ä¸­ï¼Œæ–¹ä¾¿ä¹‹åçš„æ¯”è¾ƒ</span>leaderStateSummary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StateSummary</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">getCurrentEpoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> zk<span class="token punctuation">.</span><span class="token function">getLastProcessedZxid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¼€å¯çº¿ç¨‹æ¥å— followers çš„è¿æ¥</span>cnxAcceptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LearnerCnxAcceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cnxAcceptor<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¿™ä¸ªæ–¹æ³•ç”¨äºè·å– epoch ï¼Œ +1 å³ä¸ºæ–° leader çš„ epoch ï¼Œå®ƒçš„å›½å·ï¼--- [1]</span><span class="token keyword">long</span> epoch <span class="token operator">=</span> <span class="token function">getEpochToPropose</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span><span class="token function">getAcceptedEpoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// zk åœ¨è·å–åˆ°æ‰€æœ‰è¿æ¥ä¸­æœ€å¤§çš„ epoch åï¼Œ+1 ï¼Œ ç„¶åä½ 32 ä½æ¸…é›¶ï¼Œå³ä¸ºæ–°çš„ zxid</span>zk<span class="token punctuation">.</span><span class="token function">setZxid</span><span class="token punctuation">(</span>ZxidUtils<span class="token punctuation">.</span><span class="token function">makeZxid</span><span class="token punctuation">(</span>epoch<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ...</span><span class="token comment" spellcheck="true">// ç­‰å¾…è¶…åŠæ•°çš„ server çš„ epoch ackï¼Œ ç¡®è®¤æ–°çš„ epoch ä¸‹å‘åˆ°åŠæ•°ä»¥ä¸Šçš„ server</span><span class="token comment" spellcheck="true">// è¿™é‡Œçš„å¤„ç†æ–¹å¼å’Œä¸Šé¢è·å–æœ€å¤§ epoch ä¸€æ ·</span><span class="token comment" spellcheck="true">// zk è®¤ä¸ºï¼Œç­‰åˆ°è¶³å¤Ÿå¤šçš„ epoch ack åï¼Œé€‰ä¸¾æ‰ç®—ç»“æŸ</span><span class="token function">waitForEpochAck</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> leaderStateSummary<span class="token punctuation">)</span><span class="token punctuation">;</span>self<span class="token punctuation">.</span><span class="token function">setCurrentEpoch</span><span class="token punctuation">(</span>epoch<span class="token punctuation">)</span><span class="token punctuation">;</span>self<span class="token punctuation">.</span><span class="token function">setLeaderAddressAndId</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">getQuorumAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>self<span class="token punctuation">.</span><span class="token function">setZabState</span><span class="token punctuation">(</span>QuorumPeer<span class="token punctuation">.</span>ZabState<span class="token punctuation">.</span>SYNCHRONIZATION<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>åˆ°è¿™é‡Œï¼Œ <code>Discovery</code> é˜¶æ®µå°±ç»“æŸäº†ã€‚æˆ‘ä»¬æ€»ç»“ä¸‹ <strong><code>Discovery</code> é˜¶æ®µï¼Œ leader ä¸»è¦åšäº†ä»€ä¹ˆ</strong>ï¼š</p><ul><li>è·å–æœ€æ–°çš„ epoch<ul><li>æ”¶åˆ° FOLLOWERINFO æˆ–è€…  OBSERVERINFO ç±»å‹çš„ qp (quorum packet)</li><li>ç»Ÿè®¡å¹¶è·å–æœ€å¤§çš„ epochï¼Œè®¾ç½®æ–°çš„ epoch</li><li>å›å¤ LEADERINFO ç±»å‹çš„ qp ï¼ŒåŒæ—¶æŠŠæ–°çš„ epoch å‘Šè¯‰å½“å‰çš„ server</li></ul></li><li>è·å–è¶…è¿‡åŠæ•°çš„ server çš„è¿æ¥(waitForEpochAck)ï¼š<ul><li>handler ç­‰å¾… follower/observer  ACKEPOCH ç±»å‹çš„å›å¤ï¼Œè¶…è¿‡åŠæ•°è¡¨æ˜æ–°çš„ epoch è®¾ç½®æˆåŠŸ</li></ul></li></ul><h3 id="2-Synchronization"><a href="#2-Synchronization" class="headerlink" title="2. Synchronization"></a>2. Synchronization</h3><pre class=" language-java"><code class="language-java">self<span class="token punctuation">.</span><span class="token function">setZabState</span><span class="token punctuation">(</span>QuorumPeer<span class="token punctuation">.</span>ZabState<span class="token punctuation">.</span>SYNCHRONIZATION<span class="token punctuation">)</span><span class="token punctuation">;</span>    </code></pre><p>è¿™é‡Œå¼€å§‹ï¼Œ zab åè®®è¿›å…¥åˆ°åŒæ­¥é˜¶æ®µï¼Œæˆ‘ä»¬çœ‹çœ‹åŒæ­¥é˜¶æ®µï¼Œ leader éƒ½ä¼šåšå“ªäº›äº‹æƒ…ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** ä¸ [1] ä¸€æ‘¸ä¸€æ ·çš„å¤„ç†æ–¹å¼ï¼Œ è·å–è¶…è¿‡åŠæ•°çš„ ackï¼Œæˆ‘ä»¬å»æŸ¥çœ‹è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨ï¼Œèƒ½çœ‹åˆ°åœ¨ learnerHandler ä¸­è¢«è°ƒç”¨äº†ï¼Œè€Œåœ¨è°ƒç”¨ä¹‹å‰ï¼ŒlearnerHandler åšçš„äº‹æƒ…å°±æ˜¯å’Œä¸ä¹‹è¿æ¥çš„ server è¿›è¡ŒåŒæ­¥*/</span><span class="token function">waitForNewLeaderAck</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> zk<span class="token punctuation">.</span><span class="token function">getZxid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¿™é‡Œä¼šå¼€å¯ leader çš„äº‹åŠ¡å¤„ç†è´£ä»»é“¾ --- [2]</span><span class="token function">startZkServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¿™é‡Œå°±æ˜¯åœ¨ how-to-use ä¸­ä»‹ç»çš„é…ç½®ï¼Œè®¾ä¸º yes(é»˜è®¤)ï¼Œå³è¡¨æ˜ leader ä¹Ÿä¼šæ¥å— client è¿æ¥</span><span class="token comment" spellcheck="true">// å°† zkServer æ”¾å…¥åˆ° ServerCnxFactory ä¸­</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>System<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"zookeeper.leaderServes"</span><span class="token punctuation">,</span> <span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    self<span class="token punctuation">.</span><span class="token function">setZooKeeperServer</span><span class="token punctuation">(</span>zk<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// è¿™å°±åˆ° BROADCAST äº†ï¼Ÿï¼Ÿï¼Ÿ</span><span class="token comment" spellcheck="true">// æ˜¯çš„ï¼Œå› ä¸ºæˆ‘æœ‰åŠ©æ‰‹ learnerHandler</span>self<span class="token punctuation">.</span><span class="token function">setZabState</span><span class="token punctuation">(</span>QuorumPeer<span class="token punctuation">.</span>ZabState<span class="token punctuation">.</span>BROADCAST<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è¿™é‡Œå…ˆä»‹ç»ä¸‹åŒæ­¥æ—¶çš„å‡ ç§ç±»å‹(å¯ä»¥åŒæ—¶æ€è€ƒä¸‹ï¼Œåˆ†åˆ«ä»€ä¹ˆæƒ…å†µï¼Œä¼šå¯¼è‡´ä¸‹é¢çš„ç±»å‹å¤„ç†)ï¼š</p><ul><li>DIFFï¼šå·®å¼‚åŒæ­¥</li><li>TRUNCï¼šå›æ»šåŒæ­¥</li><li>SNAPï¼šå…¨é‡åŒæ­¥</li></ul><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å»çœ‹ <code>LearnerHandler</code>  ä» <code>waitForEpochAck</code> åˆ° <code>waitForNewLeaderAck</code> ä¸­é—´éƒ¨åˆ†çš„ä»£ç </p><h4 id="syncFollower"><a href="#syncFollower" class="headerlink" title="syncFollower"></a><code>syncFollower</code></h4><p><code>org.apache.zookeeper.server.quorum.LearnerHandler#syncFollower</code></p><ol><li><p>leader lastProcessedZxid == peerLastZixdï¼š è¯´æ˜äº‹åŠ¡ä¸€è‡´ï¼Œæ— éœ€åŒæ­¥ï¼Œæ­¤æ—¶ leader ä¼šå‘é€ä¸€ä¸ªç©ºçš„ DIFF qp ç»™ follower</p></li><li><p>peer lastProcessedZxid åœ¨ [minCommittedLog, maxCommittedLog] ä¹‹é—´ï¼Œè¿™ä¸ªåŒºé—´æ˜¯ zk ç»´æŠ¤çš„ä¸€ä»½ commit queueï¼Œç”¨æ¥å¿«é€Ÿä¸å„ server åŒæ­¥ã€‚åœ¨æ­¤ä¹‹é—´è¯´æ˜ peer çš„äº‹åŠ¡ä¸ leader ä¹‹é—´å­˜åœ¨å·®å¼‚ï¼Œzk ä¼šå…ˆå‘ä¸€ä¸ª DIFF qp ç»™ server ï¼Œç„¶åå°†åŒºé—´ä¸­æ¯” peer zxid å¤§çš„äº‹åŠ¡ï¼Œä»¥ Proposal çš„æ–¹å¼å‘é€ç»™ serverï¼Œserver æ”¶åˆ°åï¼Œå›å¤ ack </p></li><li><p>peer lastProcessedZxid &gt; maxCommittedLog æ—¶ï¼Œå°±éœ€è¦è¿›è¡Œ trunc ï¼ŒåŒä¸Šï¼Œä¹Ÿæ˜¯å…ˆå‘é€ TRUNC qpï¼Œç„¶åé€šè¿‡ Proposal è¿›è¡Œå›æ»šåŒæ­¥</p></li><li><p>peer lastProcessedZxid &lt; minCommittedLog æ—¶ï¼Œzk ä¼šå…ˆå°è¯• <code>on-disk txnlog + committedLog</code> çš„æ–¹å¼è¿›è¡ŒåŒæ­¥ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™ä½¿ç”¨ <strong>SNAP</strong> çš„æ–¹å¼è¿›è¡ŒåŒæ­¥ã€‚ SNAP ä¼šä»ç£ç›˜è¯»å– <code>snapshot.xxx</code> å‘½åçš„æ–‡ä»¶ï¼Œåºåˆ—åŒ–åå‘é€ç»™ server</p></li></ol><p>ä¸Šè¿°åŒæ­¥å®Œæˆåï¼Œleader ä¼šå‘é€ä¸€ä¸ª <code>NEWLEADER</code> qp ç»™ serverï¼Œå‘ŠçŸ¥åŒæ­¥ç»“æŸï¼Œå¾—åˆ°è¶³å¤Ÿ server çš„ ack å›å¤å(è¿™é‡Œå°±æ˜¯ leader å’Œ learnerHandler çš„ä¸€ä¸ªåŒæ­¥ç‚¹ï¼Œä¹Ÿå°±æ˜¯æ–¹æ³• <code>waitForNewLeaderAck</code>)ï¼Œleader å°†æ‰§è¡Œ <code>startZKServer</code> æ–¹æ³•ï¼Œè€Œæ­¤å¯çš„ <code>learnerHandler</code> ä¹Ÿä¼šç­‰å¾… zkServer çš„å¯åŠ¨ã€‚</p><h4 id="startZkServer"><a href="#startZkServer" class="headerlink" title="startZkServer"></a><code>startZkServer</code></h4><p><code>org.apache.zookeeper.server.quorum.Leader#startZkServer</code></p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// æ¥æºäºåŸºç±» org.apache.zookeeper.server.ZooKeeperServer#startup</span><span class="token comment" spellcheck="true">// æˆªå–éƒ¨åˆ†ä»£ç </span><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">startup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// è¿™é‡Œå°±æ˜¯ä¸Šæ–‡æåˆ°çš„ leader å¤„ç†äº‹åŠ¡çš„è´£ä»»é“¾</span>    <span class="token function">setupRequestProcessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// è®¾ç½® zk çŠ¶æ€</span>    <span class="token function">setState</span><span class="token punctuation">(</span>State<span class="token punctuation">.</span>RUNNING<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// é€šçŸ¥æ‰€æœ‰ç­‰å¾…åœ¨è¯¥å¯¹è±¡ä¸Šçš„çº¿ç¨‹</span>    <span class="token comment" spellcheck="true">// è¿™äº›çº¿ç¨‹å³è´Ÿè´£ä¸å„ä¸ª server è¿æ¥çš„ learnerHandler</span>    <span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p><code>zkServer</code> å¯åŠ¨åï¼Œ learnerHandler å°±ä¼šå‘é€ä¸€ä¸ª <code>UPTODATE</code> çš„æŠ¥æ–‡ç»™å„ä¸ª server ï¼Œå‘Šè¯‰ä»–ä»¬ï¼Œæˆ‘ä»¬å‡†å¤‡å¥½äº†ï¼Œå¯ä»¥å¼€é—¨æ¥å®¢ï¼Œå•Šå‘¸ï¼Œå¯ä»¥æ¥å— client çš„è¿æ¥äº†ã€‚</p><h3 id="3-Broadcast"><a href="#3-Broadcast" class="headerlink" title="3. Broadcast"></a>3. Broadcast</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// æ£€æŸ¥ quorumPeer å’Œ zkServer çš„çŠ¶æ€ï¼Œä¸å¯¹åŠ²å°±ä¼šè·³å‡º while</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// follower æœªè¶…è¿‡åŠæ•°ï¼Œè·³å‡º while</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tickSkip <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>syncedAckSet<span class="token punctuation">.</span><span class="token function">hasAllQuorums</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å®šæ—¶å‘é€ ping æŠ¥æ–‡</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>LearnerHandler f <span class="token operator">:</span> <span class="token function">getLearners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        f<span class="token punctuation">.</span><span class="token function">ping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// å¦‚æœä» while è·³å‡ºï¼Œè¿™é‡Œçš„ msg ä¼šæœ‰å€¼ï¼Œä»£ç è¢«æˆ‘ç²¾ç®€äº†</span><span class="token keyword">if</span> <span class="token punctuation">(</span>null <span class="token operator">!=</span> shutdownMessage<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">shutdown</span><span class="token punctuation">(</span>shutdownMessage<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>è¿™æ˜¯ leader.lead() æ–¹æ³•å»åšçš„ï¼Œå¯æ˜¯æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œleader å’Œ server ä¹‹é—´çš„å·¥ä½œï¼Œå¤§éƒ¨åˆ†éƒ½ç”± learnerHandler åœ¨å¤„ç†ã€‚æ‰€ä»¥è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬è¿˜å¾—å»çœ‹çœ‹ <code>learnerHandler</code> åœ¨æäº›ä»€ä¹ˆäº‹æƒ…</p><pre class=" language-java"><code class="language-java"><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    qp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QuorumPacket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ia<span class="token punctuation">.</span><span class="token function">readRecord</span><span class="token punctuation">(</span>qp<span class="token punctuation">,</span> <span class="token string">"packet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>qp<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">case</span> Leader<span class="token punctuation">.</span>ACK<span class="token operator">:</span>        <span class="token comment" spellcheck="true">// ...</span>    <span class="token keyword">case</span> Leader<span class="token punctuation">.</span>PING<span class="token operator">:</span>        <span class="token comment" spellcheck="true">// ...</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> Leader<span class="token punctuation">.</span>REVALIDATE<span class="token operator">:</span>        <span class="token comment" spellcheck="true">// ...</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> Leader<span class="token punctuation">.</span>REQUEST<span class="token operator">:</span>        <span class="token comment" spellcheck="true">// ...</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">default</span><span class="token operator">:</span>        LOG<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"unexpected quorum packet, type: {}"</span><span class="token punctuation">,</span> <span class="token function">packetToString</span><span class="token punctuation">(</span>qp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œ learnerHandler é€šè¿‡ switchâ€¦caseâ€¦ æ¥å¤„ç†æ¥è‡ª server çš„å„ä¸ªç±»å‹è¯·æ±‚ï¼Œä¸€æ—¦å‡ºäº†é—®é¢˜ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæœ€ååœ¨ finally ä»£ç å—ä¸­ï¼Œshutdown</p><h2 id="Follower"><a href="#Follower" class="headerlink" title="Follower"></a>Follower</h2><p>å¯¹äº Follower è€Œè¨€ï¼ŒåŒæ ·è¦ä»  <code>QuorumPeer</code> çš„ run æ–¹æ³•çš„ switchâ€¦caseâ€¦ ä»£ç å—å…¥æ‰‹ï¼Œè¿™é‡Œå°±ä¸å†è´´ä»£ç äº†ï¼Œå°±ç®€å•æ¢³ç†ä¸‹å¤§è‡´çš„æµç¨‹ï¼Œä»¥åŠå„ä¸ªé˜¶æ®µå’Œ leader çš„é€šä¿¡ã€‚</p><h3 id="1-Discovery-1"><a href="#1-Discovery-1" class="headerlink" title="1. Discovery"></a>1. Discovery</h3><ul><li><p>Follower (ä¸‹æ–‡ä»¥ F ä»£æ›¿)ï¼Œé€šè¿‡ <code>org.apache.zookeeper.server.quorum.Learner#connectToLeader</code> ä¸æ–° leader å»ºç«‹ TCP è¿æ¥ã€‚</p></li><li><p>F å‘é€ <strong>FOLLOWERINFO</strong> ç±»å‹ qp ç»™ leader(å¦‚æœæ˜¯ observer ï¼Œå‘é€çš„ç±»å‹ä¸º OBSERVERINFO)ï¼Œè¢« <code>learnerHandler</code> æ¥æ”¶ã€‚</p><p>å‰æ–‡æåˆ° leader åœ¨æ‰§è¡Œ lead æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå…ˆå»åˆ›å»º <code>LearnerCnxAcceptor</code> â€“&gt;  <code>LearnerCnxAcceptorHandler</code> â€“&gt; <code>LearnerHandler</code> , è¿™ä¸€äº›åˆ—ä»£ç æ‰§è¡Œåï¼Œå°±åœ¨ç­‰å¾… F è¿æ¥å¹¶å‘é€ FOLLOWERINFO  æŠ¥æ–‡ã€‚è¿™æ˜¯ä»–ä»¬é€šä¿¡çš„ç¬¬ä¸€ä¸ªæŠ¥æ–‡ï¼Œå¦‚æœä¸æ˜¯ï¼Œè¿™ä¸ªè¿æ¥å°±ä¼šè¢« leader èˆå¼ƒæ‰</p></li><li><p>ç­‰å¾… leader çš„ <strong>LEADERINFO</strong> qpï¼Œ è¯¥æŠ¥æ–‡å«æœ‰ leader çš„æœ€æ–° epoch ï¼Œæ‰€ä»¥ F è®¾ç½®æ–°çš„ epochï¼ŒåŒæ—¶å‘é€ <strong>ACKEPOCH</strong> ç±»å‹ qp ç»™ leader</p></li></ul><p>discovery é˜¶æ®µç»“æŸ</p><h3 id="2-Synchronization-1"><a href="#2-Synchronization-1" class="headerlink" title="2. Synchronization"></a>2. Synchronization</h3><p>leader é€šè¿‡ <code>learnerHandler</code> å‘é€çš„åŒæ­¥æ ‡å¿—(DIFF/TRUNC/SNAP) ï¼Œè¿›è¡Œä¸åŒçš„å¤„ç†å’Œå›å¤ï¼Œåœ¨ <code>org.apache.zookeeper.server.quorum.Learner#syncWithLeader</code> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚</p><p>åŒæ­¥ç»“æŸåï¼Œ leader ä¼šå‘é€ä¸€ä¸ª <strong>NEWLEADER</strong> qp ç»™ Fï¼ŒF å› ACKï¼Œ leader æ”¶åˆ°è¶…åŠæ•° ack åï¼Œå‘é€ <strong>UPTODATE</strong> qpï¼ŒF æ”¶åˆ°è¯¥ç±»å‹çš„ qp åï¼Œä¼šè·³å‡º while å¾ªç¯ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">case</span> Leader<span class="token punctuation">.</span>UPTODATE<span class="token operator">:</span>    <span class="token keyword">break</span> outerLoop<span class="token punctuation">;</span></code></pre><p>åç»­ä»£ç ä¼šå›å¤ ACKï¼ŒåŒæ—¶å¯åŠ¨ zkServerï¼š</p><pre class=" language-java"><code class="language-java">ack<span class="token punctuation">.</span><span class="token function">setZxid</span><span class="token punctuation">(</span>ZxidUtils<span class="token punctuation">.</span><span class="token function">makeZxid</span><span class="token punctuation">(</span>newEpoch<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">writePacket</span><span class="token punctuation">(</span>ack<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>sock<span class="token punctuation">.</span><span class="token function">setSoTimeout</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>tickTime <span class="token operator">*</span> self<span class="token punctuation">.</span>syncLimit<span class="token punctuation">)</span><span class="token punctuation">;</span>self<span class="token punctuation">.</span><span class="token function">setSyncMode</span><span class="token punctuation">(</span>QuorumPeer<span class="token punctuation">.</span>SyncMode<span class="token punctuation">.</span>NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>zk<span class="token punctuation">.</span><span class="token function">startup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è€Œ F çš„ zkServer ï¼ŒåŒæ ·ä¼šå¼€å¯ä¸€æ¡äº‹åŠ¡å¤„ç†çš„è´£ä»»é“¾ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">setupRequestProcessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    RequestProcessor finalProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FinalRequestProcessor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    commitProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommitProcessor</span><span class="token punctuation">(</span>finalProcessor<span class="token punctuation">,</span> Long<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token function">getServerId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token function">getZooKeeperServerListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    commitProcessor<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    firstProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FollowerRequestProcessor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> commitProcessor<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">(</span><span class="token punctuation">(</span>FollowerRequestProcessor<span class="token punctuation">)</span> firstProcessor<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    syncProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SyncRequestProcessor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SendAckRequestProcessor</span><span class="token punctuation">(</span><span class="token function">getFollower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    syncProcessor<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>é€šè¿‡ä»£ç å¯ä»¥çœ‹åˆ°ï¼ŒF çš„è´£ä»»é“¾å¦‚ä¸‹ï¼š</p><ul><li><p>FollowerRequestProcessor â€“&gt; CommitProcessor â€“&gt; FinalRequestProcessor</p></li><li><p>SyncRequestProcessor â€“&gt; SendAckRequestProcessor</p></li></ul><p>é€šè¿‡è¿™äº›è´£ä»»é“¾ï¼Œå°†ä¸€æ¡äº‹åŠ¡çš„å¤„ç†å˜å¾—åˆ†å·¥æ˜ç¡®ã€‚</p><h3 id="3-Broadcast-1"><a href="#3-Broadcast-1" class="headerlink" title="3. Broadcast"></a>3. Broadcast</h3><p><code>syncWithLeader</code> æ‰§è¡Œå®Œæ¯•ï¼Œä¹Ÿå°±æ˜¯åŒæ­¥å®Œæˆåï¼Œ F å°±è¿›å…¥åˆ°å¹¿æ’­é˜¶æ®µã€‚</p><p>å¦‚æœè¯¥ F é…ç½®äº† <code>observerMasterPort</code> ï¼Œè¿™é‡Œè¿˜ä¼šå¯åŠ¨ä¸€ä¸ª <code>ObserverMaster</code> çº¿ç¨‹ï¼Œç”¨æ¥ä¸ observer äº‹åŠ¡åŒæ­¥</p><pre class=" language-java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">getObserverMasterPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    om <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObserverMaster</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fzk<span class="token punctuation">,</span> self<span class="token punctuation">.</span><span class="token function">getObserverMasterPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    om<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">readPacket</span><span class="token punctuation">(</span>qp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">processPacket</span><span class="token punctuation">(</span>qp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>è¿™é‡ŒåŒæ ·ï¼Œé€šè¿‡ while ï¼Œä¿æŒä¸ leader ä¹‹é—´çš„è”ç³»</p><h2 id="ä¸€æ¡å†™äº‹åŠ¡"><a href="#ä¸€æ¡å†™äº‹åŠ¡" class="headerlink" title="ä¸€æ¡å†™äº‹åŠ¡"></a>ä¸€æ¡å†™äº‹åŠ¡</h2><p>æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œ<code>ServerCnxnFactory</code> (æˆ‘ä»¬æ²¡æœ‰é…ç½® netty ï¼Œè¿™é‡ŒæŒ‡ NIOServerCnxnFactory)ï¼Œè´Ÿè´£æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸ client çš„è¿æ¥ã€‚å…ˆçœ‹ä¸‹ <code>NIOServerCnxnFactory</code> çš„ç±»å›¾ï¼š</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200410190237.png-growing" alt="NIOServerCnxnFactory"></p><p>ç»§æ‰¿è‡ª <code>ServerCnxnFactory</code> ï¼Œå†…éƒ¨ä¸»è¦æœ‰ï¼š</p><ul><li>IOWorkRequestï¼šè´Ÿè´£å¤„ç† IO çš„è¯»å†™( m ä¸ªï¼Œå¯é…ç½®ï¼Œé»˜è®¤ æ ¸æ•°*2 )</li><li>ConnectionExpirerThreadï¼šè´Ÿè´£æ¸…ç†ä¸å®¢æˆ·ç«¯çš„ å¼‚å¸¸/å¤±æ•ˆ/è¿‡æœŸ è¿æ¥ (1 ä¸ªçº¿ç¨‹)</li><li>AcceptThreadï¼šè´Ÿè´£æ¥æ”¶æ¥è‡ª client çš„è¿æ¥å¹¶åˆ†é…ç»™ selectorThread (1 ä¸ªçº¿ç¨‹)</li><li>SelectorThreadï¼šè´Ÿè´£ä¸ client çš„è¿æ¥å¤„ç†( n ä¸ªï¼Œå¯é…ç½®ï¼Œæˆ–è€…å– æ ¸æ•°/2 çš„å¹³æ–¹æ ¹)</li></ul><p>å½“å®¢æˆ·ç«¯è¯·æ±‚è¿‡æ¥åï¼Œç”± selectorThread äº¤ç”± IOWorkRequest(äº‹å®ä¸Šï¼ŒIOWorkRequest çº¿ç¨‹æ± å¤„ç†) çš„ doWork å¤„ç†ï¼ŒdoWork å¤„ç†åï¼Œäº¤ç”± NIOServerCnxn çš„ doIO å¤„ç†ï¼Œè¯¥ç±»çœŸæ­£è´Ÿè´£ä¸ client çš„é€šä¿¡ã€‚è‹¥æ˜¯æ¥æ”¶ client çš„ä¿¡æ¯ï¼Œåˆ™äº¤ç”±è¯¥ç±»çš„ readPayload å¤„ç†ï¼Œå®ƒç®€å•å¤„ç†åï¼Œå†ç»™ readRequest(or readConnectRequest) æ–¹æ³•ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">readRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>    zkServer<span class="token punctuation">.</span><span class="token function">processPacket</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> incomingBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>è¿™ä¸ªæ–¹æ³•å¾ˆç®€å•ï¼Œå°±iæ˜¯æŠŠè¿™ä¸ª request äº¤ç»™ zkServer å¤„ç†ï¼Œæœ€ç»ˆä¼šæ·»åŠ åˆ°ï¼š</p><pre class=" language-java"><code class="language-java">LinkedBlockingQueue<span class="token operator">&lt;</span>Request<span class="token operator">></span> submittedRequests <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token operator">&lt;</span>Request<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è€Œè¿™ä¸ªå±æ€§ï¼Œä¼šç”±è¯¥ç±»ï¼Œä¹Ÿå°±æ˜¯ <code>RequestThrottler</code> çº¿ç¨‹çš„ run æ–¹æ³•å¤„ç†ï¼Œé€šè¿‡ take() æ–¹æ³•ï¼Œé˜»å¡ï¼Œç›´åˆ°æœ‰æ¶ˆæ¯è¿‡æ¥ã€‚</p><p>æœ€ç»ˆä¼šäº¤ç”± <code>ZooKeeperServer</code> æ¥å¤„ç†ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// org.apache.zookeeper.server.ZooKeeperServer#submitRequestNow</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">submitRequestNow</span><span class="token punctuation">(</span>Request si<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ¶ˆæ¯äº¤ç»™äº† Follower çš„è´£ä»»é“¾å¤„ç†</span>        firstProcessor<span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span>si<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">MissingSessionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">requestFinished</span><span class="token punctuation">(</span>si<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RequestProcessorException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">requestFinished</span><span class="token punctuation">(</span>si<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>åˆ°äº†è¿™é‡Œï¼Œæˆ‘ä»¬åŸºæœ¬èƒ½ç†æ¸…ï¼Œä» client å‘å‡ºä¸€ä¸ªæ¶ˆæ¯ï¼Œåˆ°æœ€ç»ˆè¿™ä¸ªæ¶ˆæ¯è¢«å¤„ç†çš„æµç¨‹</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200410221247.png-growing" alt="zk"></p><h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><h3 id="1"><a href="#1" class="headerlink" title="[1]"></a>[1]</h3><pre class=" language-java"><code class="language-java">cnxAcceptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LearnerCnxAcceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cnxAcceptor<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">long</span> epoch <span class="token operator">=</span> <span class="token function">getEpochToPropose</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span><span class="token function">getAcceptedEpoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æˆ‘ä»¬æ¥è¯´ä¸‹è¿™ä¸‰è¡Œã€‚</p><p>å‰ä¸¤è¡Œç”¨äºå¼€å¯çº¿ç¨‹ï¼Œæ¥å— followers çš„è¿æ¥ã€‚æ¥å—è¿æ¥æ˜¯å¹²å˜›çš„ï¼Ÿ</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œ æ–°çš„çš‡å¸ä¼šæœ‰æ–°çš„å¹´å·ï¼Œzk ä¸­æ–°çš„ leader ä¹Ÿä¼šæ›´æ–°è‡ªå·±çš„ epoch ã€‚</p><p>å‡è®¾é›†ç¾¤ä¸­æœ‰ä¸€ä¸ªä¸ä¸–éš”ç»çš„ C follower ï¼Œä¸€ç›´æ²¡æœ‰è·å–åˆ° leader çš„ epoch ã€‚è€Œä¹‹åè¿™ä¸ª leader æŒ‚æ‰äº†ï¼Œæ°å·§è¿™ä¸ª C å½“é€‰ä¸ºæ–°çš„ leader ï¼Œå®ƒè¦äº§ç”Ÿè‡ªå·±çš„ epoch ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿç›´æ¥åœ¨è‡ªå·±çš„ epoch ä¸ŠåŠ ä¸€ï¼Ÿ</p><p>é‚£è‚¯å®šä¸è¡Œï¼ä½ ä¸èƒ½ç¡®å®šè¿™ä¸ª epoch æœ‰æ²¡æœ‰è¢«å…¶ä»– leader ç”¨è¿‡ï¼</p><p>zk é€šè¿‡ä¸Šé¢ä¸‰è¡Œï¼Œè¿˜è·å– ensemble ä¸­æœ€æ–°çš„ epochï¼Œä¹Ÿå°±æ˜¯å½“å‰ ensemble ä¸­æœ€å¤§çš„ epoch ï¼Œä¹‹ååŠ ä¸€åç”¨ä½œæ–°çš„ epoch ã€‚</p><p>è¿™é‡Œæ•´ä½“çš„å¤„ç†ï¼Œåœ¨ zk ä¸­ï¼Œè¿™ç§å¤„ç†æ–¹å¼å¾ˆå¸¸è§ã€‚</p><p>å¦‚æœæ˜¯æˆ‘å†™ï¼Œè‚¯å®šä¼šå…ˆå»ç­‰å¾…æ‰€æœ‰çš„è¿æ¥ï¼Œè¶…è¿‡åŠæ•°åï¼Œç»Ÿè®¡æ‰€æœ‰çš„ epoch ï¼Œç„¶åå’Œè‡ªå·±çš„ epoch ä¸€èµ·æ¯”è¾ƒï¼Œè·å–æœ€å¤§çš„ epochï¼ŒåŠ ä¸€ï¼Œæˆä¸ºæ–° leader çš„ epoch ã€‚</p><p>å—¯ï¼Œååˆ†å‡¡å¤«ä¿—å­çš„æƒ³æ³•ã€‚</p><p>æˆ‘ä»¬çœ‹çœ‹è¿™å¸®ä¸€ä¸ªæ–¹æ³•å†™äº†å‡ ç™¾è¡Œçš„å®¶ä¼™æ˜¯æ€ä¹ˆåšçš„ã€‚</p><ol><li><p>å…ˆé€šè¿‡ <code>LearnerCnxAcceptor</code> è¿™ä¸ªç±»ï¼Œå»å¼€å¯ <code>learnerHandler</code> ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥å¤„ç†å…¶ä»– server çš„è¿æ¥çš„ï¼Œç„¶ååœ¨è¿™ä¸ª handler é‡Œè·å–æœ€æ–°çš„ epochï¼Œå—¯å“¼ï¼Œepoch å¯æ˜¯è¿˜æ²¡äº§ç”Ÿå“¦ï¼</p><pre class=" language-java"><code class="language-java"><span class="token keyword">long</span> zxid <span class="token operator">=</span> qp<span class="token punctuation">.</span><span class="token function">getZxid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">long</span> newEpoch <span class="token operator">=</span> learnerMaster<span class="token punctuation">.</span><span class="token function">getEpochToPropose</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lastAcceptedEpoch<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">long</span> newLeaderZxid <span class="token operator">=</span> ZxidUtils<span class="token punctuation">.</span><span class="token function">makeZxid</span><span class="token punctuation">(</span>newEpoch<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li><li><p>Leader ä¸»çº¿ç¨‹é‡Œï¼Œä¹Ÿé€šè¿‡ <code>getEpochToPropose</code> è·å–æœ€æ–°çš„ epoch</p></li><li><p>æ‰€ä»¥å…³é”®å°±åœ¨è¿™ä¸ª <code>getEpochToPropose</code> è¿™é‡Œäº†ã€‚</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// org.apache.zookeeper.server.quorum.Leader#getEpochToPropose</span><span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getEpochToPropose</span><span class="token punctuation">(</span><span class="token keyword">long</span> sid<span class="token punctuation">,</span> <span class="token keyword">long</span> lastAcceptedEpoch<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// åŠ é”ï¼Œè¿™æ˜¯ä¸ª set é›†åˆï¼Œç”¨æ¥å­˜å‚¨æ‰€æœ‰è¿æ¥çš„ server myid</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>connectingFollowers<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// æ ‡è®°ä½ï¼Œåˆå§‹ä¸º true</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>waitingForNewEpoch<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> epoch<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// è¿™é‡Œå¤„ç†æ–°çš„ epoch ï¼Œåªè¦ä½ çš„ epoch æ¯”æˆ‘å¤§ï¼Œä½ å°±èƒ½å–ä»£æˆ‘</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>lastAcceptedEpoch <span class="token operator">>=</span> epoch<span class="token punctuation">)</span> <span class="token punctuation">{</span>            epoch <span class="token operator">=</span> lastAcceptedEpoch <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// æ ¡éªŒ server æ˜¯å¦æ˜¯åˆæ³•çš„æŠ•ç¥¨å›¢æˆå‘˜</span>        <span class="token comment" spellcheck="true">// è¿™é‡Œçš„é¡ºåºè¡¨æ˜ï¼Œä½ å¯ä»¥ä¸æ˜¯æŠ•ç¥¨æ–¹çš„æˆå‘˜ï¼Œåªè¦ä½ ä¼ è¿‡æ¥çš„ epoch æ¯”æˆ‘å¤§å°±å¥½</span>        <span class="token comment" spellcheck="true">// ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·å‘¢? æˆ‘ç†è§£ä¸ºæ ¹æ® zab åè®®ï¼Œè¿™é‡Œæœ€é«˜çš„ epoch å¿…ç„¶ä»åˆæ³•æŠ•ç¥¨å›¢æˆå‘˜ä¸­äº§ç”Ÿ</span>        <span class="token comment" spellcheck="true">// æ‰€ä»¥è¿™é‡Œçš„å¤„ç†æ–¹å¼æ˜¯ä½ å¤§ä½ æœ‰ç†</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isParticipant</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            connectingFollowers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        QuorumVerifier verifier <span class="token operator">=</span> self<span class="token punctuation">.</span><span class="token function">getQuorumVerifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è·å¾—äº†è¶…è¿‡åŠæ•°çš„è¿æ¥ï¼Œæ‹¿åˆ°æœ€æ–°çš„ epochï¼Œè®¾ç½® flag ä¸º false</span>        <span class="token comment" spellcheck="true">// åŒæ—¶é€šçŸ¥æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connectingFollowers<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> verifier<span class="token punctuation">.</span><span class="token function">containsQuorum</span><span class="token punctuation">(</span>connectingFollowers<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            waitingForNewEpoch <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            self<span class="token punctuation">.</span><span class="token function">setAcceptedEpoch</span><span class="token punctuation">(</span>epoch<span class="token punctuation">)</span><span class="token punctuation">;</span>            connectingFollowers<span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token keyword">long</span> start <span class="token operator">=</span> Time<span class="token punctuation">.</span><span class="token function">currentElapsedTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>sid <span class="token operator">==</span> self<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                timeStartWaitForEpoch <span class="token operator">=</span> start<span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">long</span> cur <span class="token operator">=</span> start<span class="token punctuation">;</span>            <span class="token keyword">long</span> end <span class="token operator">=</span> start <span class="token operator">+</span> self<span class="token punctuation">.</span><span class="token function">getInitLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> self<span class="token punctuation">.</span><span class="token function">getTickTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// è¿™é‡Œé€šè¿‡ while + wait å®ç°</span>            <span class="token comment" spellcheck="true">// å³æ‰€æœ‰è®¿é—®è¿™ä¸ªæ–¹æ³•çš„çº¿ç¨‹ï¼Œåœ¨æ²¡æœ‰è·å¾—åŠæ•°è¿æ¥çš„æ—¶å€™ï¼Œæœ€ç»ˆéƒ½ä¼šåœ¨è¿™é‡Œå»ç­‰å¾…</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>waitingForNewEpoch <span class="token operator">&amp;&amp;</span> cur <span class="token operator">&lt;</span> end <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>quitWaitForEpoch<span class="token punctuation">)</span> <span class="token punctuation">{</span>                connectingFollowers<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span>end <span class="token operator">-</span> cur<span class="token punctuation">)</span><span class="token punctuation">;</span>                cur <span class="token operator">=</span> Time<span class="token punctuation">.</span><span class="token function">currentElapsedTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>waitingForNewEpoch<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">(</span><span class="token string">"Timeout while waiting for epoch from quorum"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> epoch<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre></li></ol><p>æˆ‘åœ¨ä¸Šé¢çš„ä»£ç ä¸ŠåŠ äº†ä¸€ç‚¹æ³¨é‡Šï¼Œä¸‹é¢å†ä»”ç»†è¯´ä¸‹ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œjava é‡Œ <code>wait</code> å’Œ <code>notifyAll</code> æ˜¯ <code>Object</code> é‡Œçš„ä¸¤ä¸ªæ–¹æ³•ã€‚å¯¹äºé•¿æœŸå†™ä¸šåŠ¡ä»£ç çš„æˆ‘è€Œè¨€ï¼Œå‡ ä¹æ²¡æ€ä¹ˆç”¨è¿‡ã€‚ä»Šå¤©ä¹Ÿæ˜¯çœ‹åˆ°è¿™é‡Œåï¼Œæ‰çŸ¥é“åŸæ¥è¿˜å¯ä»¥è¿™ä¹ˆç©ã€‚</p><p><code>java.lang.Object#wait(long, int)</code> çš„æ–‡æ¡£ä¸Šï¼Œè¯´ï¼š</p><blockquote><p>This method causes the current thread (referred to here as <var>T</var>) to place itself in the wait set for this object and then to relinquish any and all synchronization claims on this object. Note that only the locks on this object are relinquished; any other objects on which the current thread may be synchronized remain locked while the thread waits.</p></blockquote><p>æ„æ€æ˜¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•ï¼Œä¼šè®©å½“å‰çš„çº¿ç¨‹æ”¾åˆ°é”å¯¹è±¡çš„ç­‰å¾…åˆ—è¡¨ä¸­ï¼Œå¯¹äºä¸Šé¢çš„ä»£ç ï¼Œå°±æ˜¯æ‰€æœ‰è®¿é—®çš„çº¿ç¨‹éƒ½è¢«æ”¾åˆ°äº† <code>connectingFollowers</code> è¿™ä¸ªå¯¹è±¡çš„ç­‰å¾…åˆ—è¡¨é‡Œã€‚</p><p>ä½†æ˜¯è¿™ä¸ªæ–¹æ³•åŠ äº†åŒæ­¥é”ï¼Œä¸€ä¸ªçº¿ç¨‹è¿‡æ¥äº†ï¼Œå…¶ä»–çº¿ç¨‹è¿˜æ€ä¹ˆè®¿é—®å‘¢?</p><p><code>wait</code> çš„ doc è¯´ï¼ŒåŒæ—¶<strong>ä¼šæ”¾å¼ƒä¸”åªæ”¾å¼ƒ</strong>æ‰€æœ‰è¯¥å¯¹è±¡ä¸Šçš„åŒæ­¥å£°æ˜(synchronization claims)ï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰è·å¾—çš„è¿™ä¸ªå¯¹è±¡(è¿™é‡ŒæŒ‡ <code>connectingFollowers</code>) ä¸Šçš„é”ï¼Œæ­¤æ—¶ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥å†æ¬¡ç«äº‰ã€‚</p><p>ç›´åˆ°æœ‰çº¿ç¨‹ notify æˆ–è€… notifyAll æˆ–è€… interrupted æˆ–è€…è¶…æ—¶ã€‚</p><p>æ‰€ä»¥è¿™é‡Œï¼Œæˆ‘å°±èƒ½ç†è§£äº†ã€‚</p><p>æ‰€æœ‰ server çš„è¿æ¥ï¼ŒåŒ…æ‹¬è‡ªå·±ï¼Œéƒ½ä¼šåœ¨è¿™é‡Œå»ç­‰å¾…è¶…è¿‡åŠæ•°çš„è¿æ¥ï¼Œè¾¾åˆ°æ ‡å‡†åï¼Œä¼šè¢«å”¤é†’ï¼Œç„¶åå„å¹²å„çš„äº‹æƒ…ã€‚</p><h3 id="2"><a href="#2" class="headerlink" title="[2]"></a>[2]</h3><p>æˆ‘ä»¬é€æ­¥ç‚¹å‡»è¿™ä¸ªæ–¹æ³•ï¼Œä¼šå‘ç°å®ƒæœ‰è°ƒç”¨ä¸¤ä¸ªæ–¹æ³•ï¼š</p><pre class=" language-java"><code class="language-java"><span class="token function">setupRequestProcessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">startRequestThrottler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ç¬¬ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ç”¨æ¥å¼€å¯è´£ä»»é“¾ï¼Œè´Ÿè´£ leader æœŸé—´æ‰€æœ‰äº‹ç‰©çš„å¤„ç†ã€‚</p><p>ç¬¬äºŒä¸ªæ–¹æ³•ç›¸å½“äºä¸€ä¸ªé˜€é—¨ï¼Œç”¨æ¥çº¦æŸè¯·æ±‚æ•°é‡ã€‚</p><p>æˆ‘ä»¬æŠŠé‡ç‚¹æ”¾åˆ°ç¬¬ä¸€ä¸ªæ–¹æ³•ä¸Šï¼Œçœ‹çœ‹å®ƒåšäº†ä»€ä¹ˆï¼š</p><pre class=" language-java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">setupRequestProcessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    RequestProcessor finalProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FinalRequestProcessor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    RequestProcessor toBeAppliedProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Leader<span class="token punctuation">.</span>ToBeAppliedRequestProcessor</span><span class="token punctuation">(</span>finalProcessor<span class="token punctuation">,</span> <span class="token function">getLeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    commitProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommitProcessor</span><span class="token punctuation">(</span>toBeAppliedProcessor<span class="token punctuation">,</span> Long<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token function">getServerId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token function">getZooKeeperServerListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    commitProcessor<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ProposalRequestProcessor proposalProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProposalRequestProcessor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> commitProcessor<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// è¿™é‡Œæ³¨æ„ï¼Œ initialize æ–¹æ³•é‡Œï¼Œä¼šåˆå§‹åŒ–å¦å¤–ä¸€æ¡ syncRequestProcessor</span>    proposalProcessor<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    prepRequestProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrepRequestProcessor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> proposalProcessor<span class="token punctuation">)</span><span class="token punctuation">;</span>    prepRequestProcessor<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    firstProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LeaderRequestProcessor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> prepRequestProcessor<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setupContainerManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>è¿™é‡Œèƒ½å¾ˆæ¸…æ¥šçš„çœ‹åˆ°æ•´ä¸ª <strong>leader</strong> å¤„ç†è¯·æ±‚çš„é“¾æ¡ï¼š</p><p>LeaderRequestProcessor  â€“&gt;  PrepRequestProcessor  â€“&gt;  ProposalRequestProcessor â€“&gt;  CommitProcessor â€“&gt; ToBeAppliedRequestProcessor  â€“&gt; FinalRequestProcessor</p><p><strong>leader</strong> åŒæ—¶è¿˜æœ‰ä¸€æ¡è´£ä»»é“¾ï¼Œè´Ÿè´£è®°å½•äº‹åŠ¡åˆ°ç£ç›˜ï¼š</p><p>SyncRequestProcessor â€“&gt;  AckRequestProcessor</p><p>è‡³äºæ¯ä¸ª processer è´Ÿè´£ä»€ä¹ˆäº‹æƒ…ï¼Œå¤§å®¶å¯ä»¥å»ä»£ç é‡Œç§ä¸€ç§çœ‹ä¸€çœ‹ï¼Œç›¸ä¿¡ä¼šæœ‰æ”¶è·ï¼Œè¿™é‡Œæš‚æ—¶ä¸å†èµ˜è¿°ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> middlewares </category>
          
      </categories>
      
      
        <tags>
            
            <tag> zookeeper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Part 3 -- ZooKeeper FastLeaderElection</title>
      <link href="/zookeeper/fast-leader-election/"/>
      <url>/zookeeper/fast-leader-election/</url>
      
        <content type="html"><![CDATA[<h1 id="ZooKeeper-lt-ä¸‰-gt-Leader-é€‰ä¸¾"><a href="#ZooKeeper-lt-ä¸‰-gt-Leader-é€‰ä¸¾" class="headerlink" title="ZooKeeper <ä¸‰> Leader é€‰ä¸¾"></a>ZooKeeper &lt;ä¸‰&gt; Leader é€‰ä¸¾</h1><p>ZooKeeper versionï¼š 3.6.0</p><h2 id="ZooKeeper-çš„å¯åŠ¨"><a href="#ZooKeeper-çš„å¯åŠ¨" class="headerlink" title="ZooKeeper çš„å¯åŠ¨"></a>ZooKeeper çš„å¯åŠ¨</h2><p>ZooKeeper æ˜¯å¦‚ä½•å¯åŠ¨çš„ï¼Ÿï¼ï¼è¿™ä¸ªé—®é¢˜è¦ä»å“ªé‡Œæ‰¾ç­”æ¡ˆå‘¢?</p><h3 id="1-zkServer-sh"><a href="#1-zkServer-sh" class="headerlink" title="1. zkServer.sh"></a>1. zkServer.sh</h3><p>æˆ‘ä»¬å¯åŠ¨å®ƒæ—¶ï¼Œæ˜¯æ€ä¹ˆè·‘çš„ï¼Ÿ è®©æˆ‘æƒ³æƒ³ï¼Œå“¦ï¼Œå¯¹äº†</p><pre class=" language-bash"><code class="language-bash">./zkServer.sh start</code></pre><p>æ˜¯çš„äº†ï¼Œå°±æ˜¯è¿™æ ·ï¼</p><p>okï¼Œé‚£å°±ç®€å•äº†ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹è¿™ä¸ª zkServer.sh æ–‡ä»¶</p><pre class=" language-bash"><code class="language-bash"><span class="token keyword">case</span> <span class="token variable">$1</span> <span class="token keyword">in</span>start<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># ...</span>    <span class="token function">nohup</span> <span class="token string">"<span class="token variable">$JAVA</span>"</span> <span class="token variable">$ZOO_DATADIR_AUTOCREATE</span> <span class="token string">"-Dzookeeper.log.dir=<span class="token variable">${ZOO_LOG_DIR}</span>"</span> \    <span class="token string">"-Dzookeeper.log.file=<span class="token variable">${ZOO_LOG_FILE}</span>"</span> <span class="token string">"-Dzookeeper.root.logger=<span class="token variable">${ZOO_LOG4J_PROP}</span>"</span> \    -XX:+HeapDumpOnOutOfMemoryError -XX:OnOutOfMemoryError<span class="token operator">=</span><span class="token string">'kill -9 %p'</span> \    -cp <span class="token string">"<span class="token variable">$CLASSPATH</span>"</span> <span class="token variable">$JVMFLAGS</span> <span class="token variable">$ZOOMAIN</span> <span class="token string">"<span class="token variable">$ZOOCFG</span>"</span> <span class="token operator">></span> <span class="token string">"<span class="token variable">$_ZOO_DAEMON_OUT</span>"</span> 2<span class="token operator">></span><span class="token operator">&amp;</span>1 <span class="token operator">&lt;</span> /dev/null <span class="token operator">&amp;</span>    <span class="token comment" spellcheck="true"># ...</span>    <span class="token punctuation">;</span><span class="token punctuation">;</span> esac</code></pre><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ <code>zkServer.sh start</code> çš„æ—¶å€™ï¼Œå…¶å®è·‘åˆ°äº†è¿™é‡Œï¼Œè€Œè¿™é‡Œï¼Œä¼šä»¥ <code>java cp</code> çš„æ–¹å¼å¯ç”¨ <code>$ZOOMAIN</code> è¿™ä¸ªä¸»ç±»ã€‚å¾€ä¸Šçœ‹</p><pre class=" language-bash"><code class="language-bash"><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"x<span class="token variable">$JMXDISABLE</span>"</span> <span class="token operator">=</span> <span class="token string">"x"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$JMXDISABLE</span>"</span> <span class="token operator">=</span> <span class="token string">'false'</span> <span class="token punctuation">]</span><span class="token keyword">then</span>  <span class="token keyword">echo</span> <span class="token string">"ZooKeeper JMX enabled by default"</span> <span class="token operator">></span><span class="token operator">&amp;</span>2  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"x<span class="token variable">$JMXPORT</span>"</span> <span class="token operator">=</span> <span class="token string">"x"</span> <span class="token punctuation">]</span>  <span class="token keyword">then</span>    <span class="token comment" spellcheck="true"># for some reason these two options are necessary on jdk6 on Ubuntu</span>    <span class="token comment" spellcheck="true">#   accord to the docs they are not necessary, but otw jconsole cannot</span>    <span class="token comment" spellcheck="true">#   do a local attach</span>    ZOOMAIN<span class="token operator">=</span><span class="token string">"-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=<span class="token variable">$JMXLOCALONLY</span> org.apache.zookeeper.server.quorum.QuorumPeerMain"</span>  <span class="token keyword">else</span>    <span class="token comment" spellcheck="true"># ...</span>    ZOOMAIN<span class="token operator">=</span><span class="token string">"-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=<span class="token variable">$JMXPORT</span> -Dcom.sun.management.jmxremote.authenticate=<span class="token variable">$JMXAUTH</span> -Dcom.sun.management.jmxremote.ssl=<span class="token variable">$JMXSSL</span> -Dzookeeper.jmx.log4j.disable=<span class="token variable">$JMXLOG4J</span> org.apache.zookeeper.server.quorum.QuorumPeerMain"</span>  <span class="token keyword">fi</span><span class="token keyword">else</span>    <span class="token keyword">echo</span> <span class="token string">"JMX disabled by user request"</span> <span class="token operator">></span><span class="token operator">&amp;</span>2    ZOOMAIN<span class="token operator">=</span><span class="token string">"org.apache.zookeeper.server.quorum.QuorumPeerMain"</span><span class="token keyword">fi</span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œè™½ç„¶åŒºåˆ†äº†å‡ ç§æƒ…å†µï¼Œä½†éƒ½æ˜¯å¾€ <code>ZOOMAIN</code> ä¸­æ·»åŠ å¯åŠ¨å˜é‡ï¼Œä½†æœ€ç»ˆï¼Œè¿™ä¸ªä¸»ç±»ï¼Œå®ƒè¿˜æ˜¯å®ƒï¼š</p><blockquote><p>org.apache.zookeeper.server.quorum.QuorumPeerMain</p></blockquote><p>äºæ˜¯æˆ‘ä»¬çŸ¥é“äº† zk çš„å¯åŠ¨ç±»ã€‚</p><h3 id="2-QuorumPeerMain"><a href="#2-QuorumPeerMain" class="headerlink" title="2. QuorumPeerMain"></a>2. QuorumPeerMain</h3><p>ä¸‹é¢æˆ‘ä»¬æŠŠ zk çš„æºç æ‹‰ä¸‹æ¥ï¼Œé€šè¿‡è¿™ä¸ªä¸»ç±»ä¸€æ­¥æ­¥å¾€é‡Œé¢çœ‹ã€‚æºç  clone çœ‹ <a href="https://github.com/apache/zookeeper" target="_blank" rel="noopener">GitHub</a></p><p>ä¸‹è½½å®Œæˆå(éœ€è¦ä¾æ¬¡ mvn clean install)ï¼Œæˆ‘ä»¬æ‰¾åˆ°è¿™ä¸ªç±»ï¼Œå¯ä»¥çœ‹åˆ°ï¼š</p><p>é€šè¿‡ <code>main</code> æ–¹æ³• è°ƒç”¨ <code>initializeAndRun</code> ï¼Œ è¿™ä¸ªæ–¹æ³•å…ˆè¯»å– config ï¼Œç„¶åå¯åŠ¨ä¸€ä¸ªç±»ä¼¼æ¸…æ´å·¥çš„çº¿ç¨‹ï¼Œä¹‹åæ ¹æ®ä¼ å…¥çš„å‚æ•°ï¼Œæ¥åˆ¤æ–­æ˜¯å¯ç”¨ ensemble æ¨¡å¼è¿˜æ˜¯ standalone æ¨¡å¼ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬çœ‹ ensemble æ¨¡å¼ã€‚</p><blockquote><p> org.apache.zookeeper.server.quorum.QuorumPeerMain#runFromConfig</p></blockquote><ul><li><p>è¿™ä¸ªæ–¹æ³•ï¼Œåˆå§‹åŒ–äº†ä¸€ä¸ªååˆ†é‡è¦çš„å¯¹è±¡ï¼Œå³ <strong>QuorumPeer</strong> !! zk çš„æ ¸å¿ƒç±»ä¹‹ä¸€ã€‚ç¨åæˆ‘ä»¬ä¼šè¯´åˆ°å®ƒã€‚æˆ‘ä»¬çœ‹è¿™ä¸ªæ–¹æ³•è¿˜å¹²äº†äº›ä»€ä¹ˆäº†ä¸å¾—çš„äº‹æƒ…ã€‚</p></li><li><p>ä¹‹å‰ <code>zoo.cfg</code> é‡Œè®¾ç½®çš„ä»€ä¹ˆ tickTimeï¼Œ initLimitï¼ŒsyncLimit å•¥çš„ï¼Œéƒ½ä¼šåœ¨è¿™ä¸ªæ–¹æ³•é‡Œå®Œæˆåˆå§‹åŒ–ã€‚</p></li><li><p>é€‰ä¸¾ç®—æ³•(ä½ éšä¾¿æ‰¾ä¸‹ï¼Œå°±èƒ½çœ‹åˆ°ï¼Œç°åœ¨ zk åªæ”¯æŒ 3ï¼Œä¹Ÿå°±æ˜¯ FastLeaderElection ç®—æ³•)ï¼Œmyidï¼Œdatabase ç­‰çš„åˆå§‹åŒ–</p></li><li><p>QuorumVerifier ç±»ï¼Œç»´æŠ¤ç€ ensemble å†…æ‰€æœ‰åˆå§‹åŒ–æ—¶çš„æ‰€æœ‰ server ä¿¡æ¯ï¼Œä¹‹åè¯´é€‰ä¸¾æ˜¯ä¸æ˜¯è¿‡åŠäº†ï¼Œå°±æ˜¯é€šè¿‡å®ƒæ¥åšåˆ¤æ–­çš„</p></li><li><p>ServerCnxnFactory ç±»ï¼Œè´Ÿè´£ server åˆ° client çš„é€šä¿¡ï¼Œä¸»è¦æœ‰ NIO å’Œ Netty ä¸¤ç§å®ç°ï¼Œé»˜è®¤ä¸º NIOï¼Œ å¯ä»¥é€šè¿‡é…ç½® <code>zookeeper.serverCnxnFactory</code> æ¥ä½¿ç”¨ Netty</p></li><li><p>others</p></li></ul><p>ä¹‹åå°±ä¼šè¿è¡Œ <code>quorumPeer.start()</code> ä¹Ÿå°±æ˜¯èµ·äº†ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸è¿‡è¿™ä¸ªçº¿ç¨‹ä¼šå»ç«äº‰ cpu æ—¶é—´ç‰‡ï¼Œè·å¾—åå°±ä¼š run èµ·æ¥</p><h3 id="3-QuorumPeer"><a href="#3-QuorumPeer" class="headerlink" title="3. QuorumPeer"></a>3. QuorumPeer</h3><p>è¿™ä¸ªç±»è´Ÿè´£ç»´æŠ¤è¿™ä¸ª server åœ¨è¿è¡ŒæœŸé—´çš„æ‰€æœ‰äº‹ç‰©ï¼Œæˆ–è€…è¯´ï¼Œä¸€ä¸ª server ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ª quorumPeer ã€‚ä¸ºä»€ä¹ˆè¿™æ ·è¯´ï¼Ÿ</p><p>zk åœ¨è¿è¡ŒæœŸé—´ï¼Œæ— éå°±æ˜¯å’Œ client é€šä¿¡ï¼Œå’Œå„ä¸ª server ï¼Œå’Œ leader é€šä¿¡ï¼Œè€Œè¿™ä¸ªç±»æ‰€æŒæœ‰çš„å„ä¸ªå¯¹è±¡ï¼Œå°±æ˜¯å¹²è¿™äº›äº‹æƒ…çš„ã€‚</p><ul><li><h4 id="3-1-QuorumPeer-start"><a href="#3-1-QuorumPeer-start" class="headerlink" title="3.1 QuorumPeer.start()"></a>3.1 QuorumPeer.start()</h4></li></ul><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ start çš„æ—¶å€™ï¼Œåšäº†ä»€ä¹ˆ</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// éªŒè¯ myid æ­£ç¡®æ€§</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>myid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"My id "</span> <span class="token operator">+</span> myid <span class="token operator">+</span> <span class="token string">" not in the peer list"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// è£…è½½ zk database</span>    <span class="token function">loadDataBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">startServerCnxnFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        adminServer<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">AdminServerException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        LOG<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"Problem starting AdminServer"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å¼€å¯ä¸€è½®é€‰ä¸¾</span>    <span class="token function">startLeaderElection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">startJvmPauseMonitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>åšäº†äº›éªŒè¯ç­‰å…¶ä»–æ“ä½œåï¼Œå¼€å¯äº†ä¸€è½®é€‰ä¸¾ï¼Œæˆ‘ä»¬çœ‹ä¸‹è¿™ä¸ªæ–¹æ³•åšäº†ä»€ä¹ˆ</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">startLeaderElection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬åˆå§‹æ—¶çŠ¶æ€å°±æ˜¯ LOOKINGï¼Œæ‰€ä»¥ä¼šåˆå§‹åŒ–ä¸€å¼ è‡ªå·±çš„é€‰ç¥¨</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getPeerState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> ServerState<span class="token punctuation">.</span>LOOKING<span class="token punctuation">)</span> <span class="token punctuation">{</span>            currentVote <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vote</span><span class="token punctuation">(</span>myid<span class="token punctuation">,</span> <span class="token function">getLastLoggedZxid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getCurrentEpoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        RuntimeException re <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        re<span class="token punctuation">.</span><span class="token function">setStackTrace</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">throw</span> re<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// åˆå§‹åŒ–é€‰ä¸¾ç®—æ³•</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>electionAlg <span class="token operator">=</span> <span class="token function">createElectionAlgorithm</span><span class="token punctuation">(</span>electionType<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">protected</span> Election <span class="token function">createElectionAlgorithm</span><span class="token punctuation">(</span><span class="token keyword">int</span> electionAlgorithm<span class="token punctuation">)</span> <span class="token punctuation">{</span>    Election le <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>electionAlgorithm<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 1ï¼Œ2 éƒ½ä¼šæŠ›å¼‚å¸¸</span>        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>            <span class="token comment" spellcheck="true">// QuorumCnxManager è´Ÿè´£é€‰ä¸¾æœŸé—´æ‰€æœ‰çš„ TCP è¿æ¥ï¼ï¼ï¼</span>            <span class="token comment" spellcheck="true">// ä¸ºä»€ä¹ˆè¿™ä¸ªç±»è¦åœ¨è¿™é‡Œåˆå§‹åŒ–ï¼Ÿ</span>            <span class="token comment" spellcheck="true">// å› ä¸ºä»–è¦è´Ÿè´£ç›‘å¬é€‰ä¸¾</span>            QuorumCnxManager qcm <span class="token operator">=</span> <span class="token function">createCnxnManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            QuorumCnxManager oldQcm <span class="token operator">=</span> qcmRef<span class="token punctuation">.</span><span class="token function">getAndSet</span><span class="token punctuation">(</span>qcm<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>oldQcm <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                LOG<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"Clobbering already-set QuorumCnxManager (restarting leader election?)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                oldQcm<span class="token punctuation">.</span><span class="token function">halt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            QuorumCnxManager<span class="token punctuation">.</span>Listener listener <span class="token operator">=</span> qcm<span class="token punctuation">.</span>listener<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>listener <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// listener è´Ÿè´£ç›‘å¬æ‰€æœ‰è¿æ¥</span>                listener<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                FastLeaderElection fle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FastLeaderElection</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> qcm<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// å¼€å¯é€‰ä¸¾çº¿ç¨‹</span>                fle<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                le <span class="token operator">=</span> fle<span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                LOG<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Null listener when initializing cnx manager"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">default</span><span class="token operator">:</span>            <span class="token keyword">assert</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> le<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h4 id="3-2-FastLeaderElection"><a href="#3-2-FastLeaderElection" class="headerlink" title="3.2 FastLeaderElection"></a>3.2 FastLeaderElection</h4><p>è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸‹ FLE(FastLeaderElection) çš„ç±»å›¾</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200404143916.png-growing" alt="FLE Class"></p><p>FLE ä¸»è¦æŒæœ‰çš„å¯¹è±¡æœ‰</p><ul><li><p>ToSendï¼šå°±æ˜¯ä¸€ä¸ªå°è£…ç±»ï¼Œç”¨æ¥å°è£…å‘é€çš„æ¶ˆæ¯ä½“</p></li><li><p>Notificationï¼šä¹Ÿæ˜¯ä¸€ä¸ªå°è£…ç±»ï¼Œç”¨æ¥å‘ŠçŸ¥å…¶ä»– serverï¼Œvote å‘ç”Ÿäº†å˜åŒ–çš„å®ä½“</p></li><li><p>Messengerï¼šçœŸæ­£å¹²äº‹æƒ…çš„ï¼Œç”¨äºå‘é€å’Œæ¥å—é€‰ä¸¾æœŸé—´çš„é€‰ç¥¨ï¼Œå…¶ä¸­ï¼š</p><ul><li>WorkerReceiverï¼šæ¥æ”¶é€‰ç¥¨</li><li>WorkerSenderï¼šå‘é€é€‰ç¥¨</li></ul></li><li><p>FastLeaderElection é‡Œè¿˜æœ‰ä¸¤ä¸ªå¾ˆé‡è¦çš„å˜é‡ï¼Œæˆ‘ä»¬ä»åå­—ä¹Ÿèƒ½å¾ˆå¥½ç†è§£</p><ul><li>sendqueue LinkedBlockingQueue&lt;ToSend&gt; ï¼š ç”¨æ¥æ¥æ”¶éœ€è¦å‘é€çš„é€‰ç¥¨é˜Ÿåˆ—</li><li>recvqueue  LinkedBlockingQueue&lt;Notification&gt; ï¼š ç”¨æ¥æ¥æ”¶ä»å…¶ä»– server å‘è¿‡æ¥çš„é€‰ç¥¨é˜Ÿåˆ—</li></ul></li></ul><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° FLE è™½ç„¶æœ‰ä¸ª start() æ–¹æ³•ï¼Œå¯æ˜¯å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹ç±»ï¼ åœ¨ start ä¹‹åï¼Œå®ƒäº‹å®ä¸Šæ˜¯åˆå§‹åŒ–äº† <code>Messenger</code> ,ä¹‹å Messenger å»åˆå§‹åŒ– <code>WorkerReceiver</code> å’Œ <code>WorkerSender</code> ï¼Œè¿™ä¸¤ä¸ªæ˜¯çº¿ç¨‹ç±»ï¼Œå¹¶ä¸”è¢« start äº†ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸¤è´§å¼€å§‹å¹²æ´»äº†ï¼š è¿™ä¸¤è´§ä¼šæ ¹æ®æ¥æ”¶/å‘é€çš„é€‰ç¥¨çš„å„ç§çŠ¶æ€ï¼Œåˆ†åˆ«å¡ç»™  sendqueue å’Œ recvqueue </p><ul><li>sendqueue æœ€ç»ˆè¢«å‰æ–‡æåˆ°çš„ <code>QuorumCnxManager</code> æ¶ˆè´¹ï¼Œç”±å®ƒå‘é€ç»™å…¶ä»– server</li><li>recvqueue æœ€ç»ˆç”± fle åœ¨è®¡ç®—é€‰ç¥¨æ—¶å€™æ¶ˆè´¹ï¼Œä»¥æ­¤æ¥ç¡®å®š leader çš„è¯ç”Ÿ</li></ul><h4 id="3-3-QuorumPeer-run"><a href="#3-3-QuorumPeer-run" class="headerlink" title="3.3 QuorumPeer.run()"></a>3.3 QuorumPeer.run()</h4><p>ç®€å•ä»‹ç»å®Œ FLE ï¼Œç°åœ¨æˆ‘ä»¬å›åˆ° <code>QuorumPeer</code> è¿™ä¸ªç±»ï¼Œä¹‹å‰æˆ‘ä»¬åœ¨ <code>QuorumPeerMain</code> é‡Œ start äº†è¿™ä¸ªçº¿ç¨‹ï¼Œç°åœ¨ï¼Œå®ƒï¼Œç»ˆäºäº‰å–åˆ°äº† cpu æ—¶é—´ç‰‡ï¼Œå®ƒå¯ä»¥ run äº†ï¼ï¼ï¼</p><p>QuourmPeer ä¸­åŒ…å«çš„å‡ ç§çŠ¶æ€ï¼š</p><ul><li>ServerState ï¼š æ ‡è®°å½“å‰ server çŠ¶æ€<ul><li>LOOKINGï¼šè¯¥çŠ¶æ€ä¸‹ä¼šå‘èµ·é€‰ä¸¾</li><li>OBSERVINGï¼šè¡¨æ˜å¤„äºè§‚å¯Ÿè€…çŠ¶æ€</li><li>FOLLOWINGï¼šè·Ÿéšè€…çŠ¶æ€</li><li>LEADINGï¼šé¢†å¯¼è€…çŠ¶æ€</li></ul></li><li>ZabStateï¼šæ ‡è®° zab åè®®çš„çŠ¶æ€<ul><li>ELECTION ï¼šé€‰ä¸¾é˜¶æ®µ</li><li>DESCOVERYï¼šå‘ç°é˜¶æ®µï¼Œå’Œå„ä¸ª follower/observer å»ºç«‹ tcp è¿æ¥</li><li>SYNCHRONIZATIONï¼šåŒæ­¥é˜¶æ®µï¼Œå’Œå„ä¸ª follower åŒæ­¥ä¿¡æ¯</li><li>BROADCASTï¼šå¹¿æ’­é˜¶æ®µ</li></ul></li></ul><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// æºç å‚è§ org.apache.zookeeper.server.quorum.QuorumPeer#run</span><span class="token comment" spellcheck="true">// è¿™é‡Œå¯¹ä»£ç åšäº†ç²¾ç®€å¤„ç†</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// è®¾ç½® jmx</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>running<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">getPeerState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">case</span> LOOKING<span class="token operator">:</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>Boolean<span class="token punctuation">.</span><span class="token function">getBoolean</span><span class="token punctuation">(</span><span class="token string">"readonlymode.enabled"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token comment" spellcheck="true">// readonly æ¨¡å¼ä¸‹çš„å¿…è¦å¤„ç† [1]</span>                     <span class="token function">setCurrentVote</span><span class="token punctuation">(</span><span class="token function">makeLEStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lookForLeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">// ...</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                    <span class="token comment" spellcheck="true">// è¿™ä¸ªæ ‡å¿—å’Œé…ç½®é‡Œçš„ version æœ‰å…³</span>                    <span class="token comment" spellcheck="true">// version å’Œ zk çš„ dynamic é…ç½®æœ‰å…³</span>                    <span class="token comment" spellcheck="true">// æš‚æ—¶è¿˜æ²¡æœ‰å»çœ‹è¿™å—çš„ä¸œè¥¿ï¼Œåé¢æŠŠè¿™é‡Œçš„å‘å¡«ä¸Š</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>shuttingDownLE<span class="token punctuation">)</span> <span class="token punctuation">{</span>                        shuttingDownLE <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                        <span class="token function">startLeaderElection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                    <span class="token function">setCurrentVote</span><span class="token punctuation">(</span><span class="token function">makeLEStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lookForLeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> OBSERVING<span class="token punctuation">,</span>FOLLOWING<span class="token punctuation">,</span>LEADING<span class="token operator">:</span>                <span class="token comment" spellcheck="true">// è®¾ç½®ä¸º OBSERVER FOLLOWER LEADER</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></pre><p>è¿™é‡Œå°±æ˜¯è´Ÿè´£å‘èµ·é€‰ä¸¾çš„ä¸»æµç¨‹ã€‚å¾ˆç®€å•ï¼Œç›´æ¥è°ƒç”¨ FLE çš„ <code>lookForLeader</code> æ–¹æ³•ã€‚èŒè´£æ˜ç¡®ã€‚</p><h4 id="3-4-lookForLeader"><a href="#3-4-lookForLeader" class="headerlink" title="3.4 lookForLeader()"></a>3.4 lookForLeader()</h4><p>ä¸€å¼ é€‰ç¥¨ï¼Œå¯èƒ½æœ‰ä»¥ä¸‹å‡ ç§é—®é¢˜ï¼š</p><ol><li>é€‰ç¥¨æ•°æ®å‡ºäº†é—®é¢˜ï¼Œæ¯”å¦‚ tcp ä¼ è¾“è¿‡ç¨‹ä¸­ï¼ŒæŸä¸ªæ•°æ®åŒ…ä¸¢äº†â€¦</li><li>æŠ•å‡ºè¿™å¼ é€‰ç¥¨çš„ server æ²¡æœ‰æƒé™(observer)</li><li>æ”¶åˆ°é€‰ç¥¨æ—¶ï¼Œæˆ‘è‡ªå·±çš„çŠ¶æ€å¹¶ä¸åœ¨ LOOKING çŠ¶æ€(ä»€ä¹ˆæ—¶å€™ä¼šæœ‰è¿™ç§æƒ…å†µå‘¢ï¼Ÿ [4])</li><li>æ”¶åˆ°é€‰ç¥¨æ—¶ï¼Œ å…¶ä»– server çš„é€‰ç¥¨ä¸æ˜¯ LOOKING çŠ¶æ€(è¿™ä¸ªä¸‹æ–‡ä¼šåˆ†æï¼Œå¯ä»¥å…ˆæƒ³ä¸€ä¸‹)</li><li>æ­£å¸¸çš„é€‰ç¥¨ï¼Œä½ åœ¨å¯»æ‰¾ leader(é€‰ç¥¨çŠ¶æ€ä¸º LOOKING)ï¼Œæˆ‘ä¹Ÿåœ¨å¯»æ‰¾  leader (æˆ‘çš„çŠ¶æ€ä¹Ÿæ˜¯ LEADING)</li></ol><p>ä¸Šé¢çš„å‰ä¸‰ç§æƒ…å†µï¼Œéƒ½ä¼šç”± <code>WorkReceiver</code> å¤„ç†æ‰</p><p>åé¢çš„ä¸¤ç§æƒ…å†µï¼Œ<code>WorkerReceiver</code> æ‰ä¼šæŠŠé€‰ç¥¨æ”¾å…¥ <code>recvqueue</code> ä¸­ï¼Œç”±ä¸‹é¢çš„æµç¨‹æ¥å¤„ç†ã€‚</p><p>åœ¨çœ‹ä¸‹é¢çš„ä»£ç ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸‹å‡ ä¸ªå˜é‡ä»¥åŠæ•°æ®ç»“æ„</p><ul><li>logicalclockï¼šç”¨æ¥è®°å½•æˆ‘è‡ªå·±çš„é€‰ä¸¾è½®æ¬¡</li><li>todo</li><li>Notification (å¤„ç†åçš„ä¸€å¼ é€‰ç¥¨)<ul><li>leaderï¼š long ï¼Œ é€‰ç¥¨çš„ sid ï¼Œå³ myidï¼Œè¿™é‡Œé€‰ç¥¨è¦é€‰ä¸¾çš„é‚£ä¸ª server çš„ sidï¼Œä¸æ˜¯è‡ªå·±çš„</li><li>peerEpochï¼šæŠ•ç¥¨äººé€‰ä¸¾çš„ leader æ‰€å¤„çš„å¹´ä»£</li><li>zxidï¼šæŠ•ç¥¨äººé€‰ä¸¾çš„ leader çš„ zxid</li><li>sidï¼š long ï¼ŒæŠ•ç¥¨äººè‡ªå·±çš„ sid</li><li>electionEpochï¼š æŠ•ç¥¨äººçš„æŠ•ç¥¨è½®æ¬¡ï¼Œè¿™ä¸ªå€¼ä¼šå’Œæˆ‘è‡ªå·±çš„ logicalclock æ¯”è¾ƒï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯å¤„äºåŒä¸€ä¸ªè½®æ¬¡</li><li>stateï¼š æŠ•ç¥¨äººçš„ serverState</li><li>qvï¼šæŠ•ç¥¨äººçš„æŠ•ç¥¨ä¿¡æ¯</li></ul></li></ul><p><strong>zk é’ˆå¯¹ä¸¤å¼ åˆæ³•çš„é€‰ç¥¨ï¼Œæ ¹æ®å¦‚ä¸‹è§„åˆ™åšæ¯”è¾ƒ</strong></p><p>æºä»£ç ï¼š org.apache.zookeeper.server.quorum.FastLeaderElection#totalOrderPredicate</p><ul><li>epochï¼š å³å¾…é€‰ leader æ‰€å¤„çš„å¹´ä»£ï¼Œé€‰å¤§çš„ï¼ ä¹Ÿå°±æ˜¯ notification ä¸­çš„ peerEpoch</li><li>zxidï¼š epoch ä¸€æ ·çš„æ—¶å€™ï¼Œçœ‹å¾…é€‰ leader çš„ zxidï¼Œé€‰å¤§çš„ï¼</li><li>myidï¼šè¿˜ä¸€æ ·æ€ä¹ˆåŠï¼Ÿ é€‰ myid å¤§çš„ï¼ å³ notification ä¸­çš„ leader</li></ul><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// åŒæ ·å¯¹ä»£ç åšäº†ç²¾ç®€ </span><span class="token comment" spellcheck="true">// æºç å‚è§ org.apache.zookeeper.server.quorum.FastLeaderElection#lookForLeader</span><span class="token keyword">public</span> Vote <span class="token function">lookForLeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>       <span class="token comment" spellcheck="true">// ç”¨æ¥å­˜å‚¨æœ‰æ•ˆé€‰ç¥¨(logicalClock == é€‰ç¥¨.electionEpoch)çš„é›†åˆ</span>        <span class="token comment" spellcheck="true">// server æ ¹æ®å®ƒæ¥åˆ¤æ–­é€‰ä¸¾ç»“æœ</span>        Map<span class="token operator">&lt;</span>Long<span class="token punctuation">,</span> Vote<span class="token operator">></span> recvset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>Long<span class="token punctuation">,</span> Vote<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å…³äºè¿™ä¸ªå­—æ®µçš„è¯¦ç»†è§£é‡Šä»¥åŠ pr [2]</span>        Map<span class="token operator">&lt;</span>Long<span class="token punctuation">,</span> Vote<span class="token operator">></span> outofelection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>Long<span class="token punctuation">,</span> Vote<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> notTimeout <span class="token operator">=</span> minNotificationInterval<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// logicalclock å¢åŠ ï¼Œ åŒæ—¶åˆå§‹åŒ–ä¸€å¼ è‡ªå·±çš„é€‰ç¥¨ï¼Œå¹¶å¹¿æ’­å‡ºå»</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            logicalclock<span class="token punctuation">.</span><span class="token function">incrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">updateProposal</span><span class="token punctuation">(</span><span class="token function">getInitId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getInitLastLoggedZxid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getPeerEpoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">sendNotifications</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        SyncedLearnerTracker voteSet<span class="token punctuation">;</span>       <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">getPeerState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> ServerState<span class="token punctuation">.</span>LOOKING<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>stop<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           <span class="token comment" spellcheck="true">// å‰æ–‡æåˆ°çš„ recvqueue ï¼Œè¿™é‡Œä»è¿™ä¸ªé˜Ÿåˆ—æ‹¿é€‰ç¥¨</span>            Notification n <span class="token operator">=</span> recvqueue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span>notTimeout<span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">// æ²¡æœ‰é€‰ç¥¨ï¼ æ˜¯ä»€ä¹ˆæƒ…å†µå‘¢? è¿˜æœ‰è¿™é‡Œä¸ºä»€ä¹ˆä¸€ç§ä¼šé‡æ–°å‘é€ï¼Œå¦ä¸€ç§åˆæ²¡æœ‰å‘¢? [3]</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>manager<span class="token punctuation">.</span><span class="token function">haveDelivered</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">sendNotifications</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                    manager<span class="token punctuation">.</span><span class="token function">connectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">validVoter</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>sid<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">validVoter</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// æŠ•ç¥¨äººçš„ serverState</span>                <span class="token keyword">switch</span> <span class="token punctuation">(</span>n<span class="token punctuation">.</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">case</span> LOOKING<span class="token operator">:</span>                    <span class="token comment" spellcheck="true">// æŠ•ç¥¨äººé€‰ä¸¾è½®æ¬¡å¤§ï¼Œè¯´æ˜ä¹‹å‰çš„æŠ•ç¥¨éƒ½æ— æ•ˆï¼Œæ‰€ä»¥è¿™é‡Œæ¸…ç©ºç¥¨ç®±</span>                    <span class="token comment" spellcheck="true">// åŒæ—¶æ›´æ–°è‡ªå·±çš„ logicalclock,</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>n<span class="token punctuation">.</span>electionEpoch <span class="token operator">></span> logicalclock<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        logicalclock<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>electionEpoch<span class="token punctuation">)</span><span class="token punctuation">;</span>                        recvset<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment" spellcheck="true">// æ¯”è¾ƒä¸¤å¼ é€‰ç¥¨å¹¶æ›´æ–°</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">totalOrderPredicate</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">,</span> <span class="token function">getInitId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getInitLastLoggedZxid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getPeerEpoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token function">updateProposal</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                            <span class="token function">updateProposal</span><span class="token punctuation">(</span><span class="token function">getInitId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getInitLastLoggedZxid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getPeerEpoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                        <span class="token comment" spellcheck="true">// æ›´æ–°é€‰ç¥¨åï¼Œå‘é€ä¸ªå…¶ä»– server</span>                        <span class="token function">sendNotifications</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n<span class="token punctuation">.</span>electionEpoch <span class="token operator">&lt;</span> logicalclock<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token comment" spellcheck="true">// ä½ çš„é€‰ä¸¾è½®æ¬¡æ¯”æˆ‘å°ï¼Œæˆ‘åªèƒ½å¯¹ä½ çˆ±ç†ä¸ç†äº†</span>                        <span class="token keyword">break</span><span class="token punctuation">;</span>                        <span class="token comment" spellcheck="true">// å¤„äºåŒä¸€ä¸ªé€‰ä¸¾è½®æ¬¡çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒé€‰ç¥¨å¹¶æ›´æ–°</span>                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">totalOrderPredicate</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">,</span> proposedLeader<span class="token punctuation">,</span> proposedZxid<span class="token punctuation">,</span> proposedEpoch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token function">updateProposal</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token function">sendNotifications</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                <span class="token comment" spellcheck="true">// æ— æ•ˆçš„é€‰ç¥¨éƒ½ break æ‰äº†ï¼Œåˆ°è¿™é‡Œéƒ½æ˜¯æœ‰æ•ˆçš„é€‰ç¥¨ï¼Œæ”¾å…¥ç¥¨ç®±</span>                    recvset<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>sid<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vote</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>electionEpoch<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// ç»Ÿè®¡é€‰ç¥¨ï¼Œè¿™é‡Œéœ€è¦è¯´ä¸‹ï¼Œæ‰€æœ‰ update æ“ä½œï¼Œéƒ½ä¼šæ›´æ–°è‡ªå·±çš„ proposedLeader ç­‰æ•°æ®</span>                  <span class="token comment" spellcheck="true">// æ‰€ä»¥è¿™é‡Œ new Vote å‚æ•°ï¼Œéƒ½æ˜¯æ›´æ–°åçš„å‚æ•°</span>                    voteSet <span class="token operator">=</span> <span class="token function">getVoteTracker</span><span class="token punctuation">(</span>recvset<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vote</span><span class="token punctuation">(</span>proposedLeader<span class="token punctuation">,</span> proposedZxid<span class="token punctuation">,</span> logicalclock<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> proposedEpoch<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// è¶…è¿‡åŠæ•°</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>voteSet<span class="token punctuation">.</span><span class="token function">hasAllQuorums</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token comment" spellcheck="true">// è¿™é‡Œçš„å¤„ç†å¾ˆæœ‰æ„æ€äº†ï¼Œå®ƒä¼šå†æ¬¡æŸ¥çœ‹ï¼Œä»ä¸Šé¢å–å‡ºé€‰ç¥¨ï¼Œåˆ°è¿è¡Œåˆ°è¿™é‡Œçš„è¿™æ®µæ—¶é—´å†…</span>                        <span class="token comment" spellcheck="true">// æ˜¯ä¸æ˜¯åˆæ”¶åˆ°äº†é€‰ç¥¨ï¼Œå¦‚æœä¸ä»…æ”¶åˆ°äº†ï¼Œè¿˜æ˜¯ä¸€å¼ æœ€ç‰›çš®çš„ï¼Œæ‹¿å‡ºæ¥åï¼Œåˆå¡äº†å›å»ï¼</span>                        <span class="token comment" spellcheck="true">// å› ä¸º breakï¼Œè€Œ n ä¸ä¸ºç©ºï¼Œä¼šè¿›å…¥åˆ°å¤–é¢çš„ while å¾ªç¯ï¼Œå†æ¬¡è·‘ä¸€éä¸Šé¢çš„æµç¨‹</span>                        <span class="token comment" spellcheck="true">// é‚£ä¹ˆï¼Œä»€ä¹ˆæƒ…å†µä¸‹ï¼Œè¿™å¼ é€‰ç¥¨é‡Œçš„ leader ä¼šå½“é€‰å‘¢ï¼Ÿ</span>                        <span class="token comment" spellcheck="true">// å¾ˆæ˜æ˜¾ï¼Œè¶…è¿‡åŠæ•°çš„ server ï¼Œåœ¨æ”¶åˆ°è¿™å¼ é€‰ç¥¨ä¹‹å‰ï¼Œæ²¡æœ‰ç¡®å®š serverï¼Œé‚£å®ƒå°±</span>                        <span class="token comment" spellcheck="true">// æœ‰æ¦‚ç‡å½“é€‰</span>                        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">=</span> recvqueue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span>finalizeWait<span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">totalOrderPredicate</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">,</span> proposedLeader<span class="token punctuation">,</span> proposedZxid<span class="token punctuation">,</span> proposedEpoch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                recvqueue<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>                                <span class="token keyword">break</span><span class="token punctuation">;</span>                            <span class="token punctuation">}</span>                        <span class="token punctuation">}</span>                        <span class="token comment" spellcheck="true">// åˆ°è¿™é‡Œï¼Œleader å°±èƒ½ç¡®å®šäº†</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token function">setPeerState</span><span class="token punctuation">(</span>proposedLeader<span class="token punctuation">,</span> voteSet<span class="token punctuation">)</span><span class="token punctuation">;</span>                            Vote endVote <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vote</span><span class="token punctuation">(</span>proposedLeader<span class="token punctuation">,</span> proposedZxid<span class="token punctuation">,</span> logicalclock<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> proposedEpoch<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token function">leaveInstance</span><span class="token punctuation">(</span>endVote<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token keyword">return</span> endVote<span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> OBSERVING<span class="token operator">:</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> FOLLOWING<span class="token operator">:</span>                <span class="token keyword">case</span> LEADING<span class="token operator">:</span>                    <span class="token comment" spellcheck="true">// å¯ä»¥æ€è€ƒä¸‹ï¼Œä»€ä¹ˆæƒ…å†µï¼Œä¼šè·‘åˆ°è¿™é‡Œæ¥ [5]</span>                    <span class="token comment" spellcheck="true">// åŒä¸€ä¸ªé€‰ä¸¾è½®æ¬¡ï¼Œä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ</span>                    <span class="token comment" spellcheck="true">// æˆ‘ä»¬éƒ½å‚ä¸äº†æŠ•ç¥¨ï¼Œåˆ«äººéƒ½æå®Œé€‰å‡º leader äº†ï¼Œå›å¤æˆ‘çš„æ—¶å€™</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>n<span class="token punctuation">.</span>electionEpoch <span class="token operator">==</span> logicalclock<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        recvset<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>sid<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vote</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>electionEpoch<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">,</span> n<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        voteSet <span class="token operator">=</span> <span class="token function">getVoteTracker</span><span class="token punctuation">(</span>recvset<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vote</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>version<span class="token punctuation">,</span> n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>electionEpoch<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">,</span> n<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>voteSet<span class="token punctuation">.</span><span class="token function">hasAllQuorums</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">checkLeader</span><span class="token punctuation">(</span>recvset<span class="token punctuation">,</span> n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>electionEpoch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token function">setPeerState</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> voteSet<span class="token punctuation">)</span><span class="token punctuation">;</span>                            Vote endVote <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vote</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>electionEpoch<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token function">leaveInstance</span><span class="token punctuation">(</span>endVote<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token keyword">return</span> endVote<span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span>                <span class="token comment" spellcheck="true">// æ–°çš„ server åŠ å…¥ç¨³å®šçš„ ensemble æ—¶ï¼Œä¼šåˆ°è¿™é‡Œ</span>                  <span class="token comment" spellcheck="true">// ä¸»è¦éªŒè¯å½“å‰ leader æ˜¯ä¸æ˜¯çœŸçš„è¢«è¶…åŠæ•°çš„ follower è¿½éš</span>                    outofelection<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>sid<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vote</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>version<span class="token punctuation">,</span> n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>electionEpoch<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">,</span> n<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    voteSet <span class="token operator">=</span> <span class="token function">getVoteTracker</span><span class="token punctuation">(</span>outofelection<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vote</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>version<span class="token punctuation">,</span> n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>electionEpoch<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">,</span> n<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>voteSet<span class="token punctuation">.</span><span class="token function">hasAllQuorums</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">checkLeader</span><span class="token punctuation">(</span>outofelection<span class="token punctuation">,</span> n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>electionEpoch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                            logicalclock<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>electionEpoch<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token function">setPeerState</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> voteSet<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                        Vote endVote <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vote</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leader<span class="token punctuation">,</span> n<span class="token punctuation">.</span>zxid<span class="token punctuation">,</span> n<span class="token punctuation">.</span>electionEpoch<span class="token punctuation">,</span> n<span class="token punctuation">.</span>peerEpoch<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token function">leaveInstance</span><span class="token punctuation">(</span>endVote<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">return</span> endVote<span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>åˆ°è¿™é‡Œï¼Œå³åŸºæœ¬è¯´å®Œäº† FLE çš„å¤§è‡´ç®—æ³•ã€‚</p><p>æˆ‘ä»¬æ€»ç»“ä¸‹ï¼Œæ— éå‡ å¥è¯ï¼š</p><ol><li>åˆ¤æ–­æ˜¯ä¸æ˜¯åŒä¸€ä¸ªé€‰ä¸¾è½®æ¬¡ã€‚é€‰ä¸¾è½®æ¬¡åªæœ‰åœ¨å‘èµ·é€‰ä¸¾çš„æ—¶å€™æ‰ä¼šæ›´æ–°ã€‚æ¯”æˆ‘å°çš„ï¼Œæˆ‘éƒ½ä¸å¸¦ç†ç¬ï¼Œç›¸åŒæˆ–å¤§çš„ï¼Œæ ¹æ® epoch ï¼Œ zxid ï¼Œ myid æ¯”è¾ƒå¹¶æ›´æ–°é€‰ç¥¨ï¼ŒåŒæ—¶é‡æ–°å‘é€è‡ªå·±çš„é€‰ç¥¨ã€‚</li><li>åœ¨æ”¶é›†åˆ°è¶³å¤Ÿå¤šçš„é€‰ç¥¨åï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡äº†åŠæ•°(äº‹å®ä¸Šï¼Œzk è¿˜å»æ£€æŸ¥äº†è¿™ä¸ªå³å°†å½“é€‰çš„ leader çš„çŠ¶æ€ï¼Œå¯ä»¥è¯´ç›¸å½“è´Ÿè´£äº†)ã€‚è¶…è¿‡çš„è¯ï¼Œå°±è¿›å…¥ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚</li><li>å¦‚æœæ˜¯åŠè·¯æ€å‡ºæ¥çš„ï¼Œå³æ–°çš„ server åŠ å…¥ï¼Œå°±æ£€æŸ¥å½“å‰ leader çš„åˆæ³•æ€§ï¼Œåˆæ³•å°±åŠ å…¥å…¶ä¸­ã€‚(å¦‚æœä¸åˆæ³•ï¼Œè‡ªç„¶ä¼šä¸æ–­çš„å‘é€é€‰ç¥¨ï¼Œç›´åˆ°é›†ç¾¤ä¸­å¤§éƒ¨åˆ†çš„ server éƒ½è§‚å¯Ÿåˆ°ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ª while å¾ªç¯å•Š)</li></ol><h4 id="FLE-Flow"><a href="#FLE-Flow" class="headerlink" title="FLE Flow"></a>FLE Flow</h4><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200405092256.png-growing" alt="FastLeaderElection Flow"></p><p>è¯¥æµç¨‹å›¾å¯èƒ½ä¸æ˜¯ç‰¹åˆ«ç²¾ç¡®ï¼Œå°‘äº†äº›å…·ä½“çš„æµç¨‹ï¼Œè¯·åŠ¡å¿…æ‰¹åˆ¤ç€çœ‹ã€‚å‡†ç¡®çš„è¯´ï¼Œæ‰€æœ‰çš„ç½‘ç»œæ–‡ç« ï¼Œä½ éƒ½å¾—æ‰¹åˆ¤ç€çœ‹ <span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f602.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png?v8">ğŸ˜‚</span> </p><h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><h3 id="1"><a href="#1" class="headerlink" title="[1]:"></a>[1]:</h3><p>zk æä¾› readonly æ¨¡å¼çš„ server ã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œå½“ä¸€å° server ä¸è¶…è¿‡åŠæ•°çš„ server  ä¸¢å¤±è¿æ¥åï¼Œå°±ä¼šåœæ­¢å·¥ä½œï¼Œè¯»å†™è¯·æ±‚éƒ½ä¸ä¼šå¤„ç†ã€‚ ä½†æ˜¯ä½¿ç”¨è¯¥æ¨¡å¼åï¼Œåˆ™è¯¥ server ä»ç„¶ä¼šå¤„ç† <strong>è¯»</strong> è¯·æ±‚ã€‚è™½ç„¶ä¿è¯äº†å¯ç”¨æ€§ï¼Œä½†ä¸¢æ‰äº†ä¸€è‡´æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ­¤æ—¶çš„ CAP ä» CP è½¬æ¢åˆ°äº† AP</p><h3 id="2"><a href="#2" class="headerlink" title="[2]"></a>[2]</h3><p><a href="https://github.com/apache/zookeeper/pull/1081" target="_blank" rel="noopener">outofelection pr</a></p><h3 id="3"><a href="#3" class="headerlink" title="[3]"></a>[3]</h3><p>ä»€ä¹ˆæƒ…å†µä¸‹ä¼šæ”¶ä¸åˆ°é€‰ç¥¨å‘¢ï¼Ÿ</p><ul><li>æˆ‘å·²ç»å‘é€äº†ï¼Œæ˜¯ä½ ä»¬çš„é—®é¢˜ï¼Œä½ ä»¬æ²¡æœ‰ç»™æˆ‘å›å¤ï¼ï¼ï¼ å¯èƒ½æ‰€æœ‰ server éƒ½å› ä¸ºå„ç§é—®é¢˜ä¸¢å¤±äº†è¿™æ¡æ¶ˆæ¯ï¼Œé‚£æ²¡åŠæ³•ï¼Œæˆ‘åªèƒ½å†å‘ä¸€æ¬¡äº†ã€‚é‚£ä¹ˆè¿™é‡Œéœ€è¦æ‹…å¿ƒé€‰ç¥¨é‡å¤çš„é—®é¢˜å—? of course not ï¼æˆ‘æ˜¯ç”¨ set å­˜å‚¨é€‰ç¥¨çš„ï¼Œä½ ç›¸åŒçš„é€‰ç¥¨ï¼Œæˆ‘è¦†ç›–ä¸€æ¬¡å°±å¥½äº†å‘—ã€‚</li><li>æˆ‘ä»¥ä¸ºæˆ‘å‘é€äº†ï¼Œå…¶å®æˆ‘å¹¶æ²¡æœ‰â€¦ ä¸å¥½æ„æ€ï¼Œæ˜¯æˆ‘çš„é”…ï¼ï¼ï¼ åŸæ¥æˆ‘å’Œä½ ä»¬çš„è¿æ¥å‡ºäº†é—®é¢˜ï¼Œå¥½å§ï¼Œæˆ‘é‡æ–°è¿æ¥ä¸€æ¬¡ã€‚ å¯æ˜¯è¿™é‡Œï¼Œé‡æ–°è¿æ¥å <strong>æ²¡æœ‰é‡æ–°å‘é€é€‰ç¥¨</strong> ï¼Œ ä¸ºä»€ä¹ˆè¿™æ ·å­ï¼Ÿæˆ‘ä»¬å¯ä»¥ç¨å¾®çœ‹ä¸‹å®ƒå‘é€æ¶ˆæ¯çš„æœºåˆ¶ï¼Œéœ€è¦å…ˆå»ºç«‹è¿æ¥ï¼Œç„¶åå–å‡ºæ¶ˆæ¯å‘é€ï¼Œæ‰€ä»¥å¦‚æœå‹æ ¹å°±æ²¡æœ‰è¿ä¸Šï¼Œé‚£ä¹ˆå°±æ²¡æœ‰æ‰€è°“çš„å–å‡ºæ¶ˆæ¯å‘é€ï¼Œæ‰€ä»¥è¿™é‡Œå¹¶ä¸éœ€è¦å†æ¬¡å‘é€æ¶ˆæ¯ã€‚</li></ul><h3 id="4"><a href="#4" class="headerlink" title="[4]"></a>[4]</h3><ul><li>å½“æœ‰æ–°çš„ server åŠ å…¥åˆ°ä¸€ä¸ªç¨³å®šè¿è¡Œçš„ ensemble æ—¶ï¼Œè¿™ä¸ªæ–° server ä¼šå‘èµ·æŠ•ç¥¨ï¼Œæˆ‘å»å›å¤è¿™ä¸ªæ–° server å‘èµ·çš„é€‰ä¸¾æ—¶ï¼Œè‡ªå·±æœ¬èº«çš„çŠ¶æ€ï¼Œå¿…ç„¶æ˜¯ LEADING / FOLLOWING /OBSERVING </li><li>é›†ç¾¤ä¸­ï¼Œæœ‰ server å‘ç° leader æŒ‚æ‰äº†ï¼Œæ­¤æ—¶å®ƒä¼šå‘èµ·æŠ•ç¥¨ï¼Œå¯æ˜¯æˆ‘è¿˜æ²¡æ„ŸçŸ¥åˆ° leader çš„çŠ¶æ€ ï¼Œä¾ç„¶è¿˜æ˜¯ä¹‹å‰çš„çŠ¶æ€ï¼šFOLLOWING / OBSERINGï¼Œæˆ‘å»å›å¤æ—¶</li></ul><h3 id="5"><a href="#5" class="headerlink" title="[5]"></a>[5]</h3><ul><li>æˆ‘ä½œä¸ºä¸€ä¸ªæ–° server ï¼Œå‘èµ·æŠ•ç¥¨æ—¶ï¼Œåˆ«äººå›å¤ç»™æˆ‘çš„ä¿¡æ¯ï¼Œä¼šåˆ°è¿™é‡Œ</li><li>æˆ‘åŠæ—¶å‘ç° ensemble é‡Œçš„ leader æŒ‚æ‰äº†ï¼Œå‘èµ·æ–°çš„é€‰ä¸¾æ—¶ï¼Œ åˆ«äººçš„å›å¤ä¼šæ¥è¿™é‡Œ</li><li>é€‰ä¸¾æ—¶ï¼Œæœ‰ä¸€åŠçš„ server å®Œæˆäº†é€‰ä¸¾ï¼Œæˆ‘å¹´çºªå¤§äº†ï¼Œé€Ÿåº¦æ…¢ï¼Œå‘èµ·æŠ•ç¥¨åï¼Œåˆ«äººçš„å›å¤</li><li>æˆ‘ä½œä¸º Follower ï¼Œè·‘ç€è·‘ç€ï¼Œç«Ÿç„¶æŒ‚æ‰äº†ï¼Œé‡æ–°æ‹‰èµ·æ¥æ—¶ï¼Œä¹Ÿä¼šå¦‚æ­¤</li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> middlewares </category>
          
      </categories>
      
      
        <tags>
            
            <tag> zookeeper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TODO</title>
      <link href="/mine/todo/"/>
      <url>/mine/todo/</url>
      
        <content type="html"><![CDATA[<h1 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h1><ul><li><p><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8">ğŸ“</span> todo äº‹é¡¹</p></li><li><p><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f389.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f389.png?v8">ğŸ‰</span> å®Œæˆäº‹é¡¹</p></li></ul><h3 id="how-to-use"><a href="#how-to-use" class="headerlink" title="how-to-use"></a>how-to-use</h3><p><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8">ğŸ“</span> æ°¸ä¹… watch event çš„ä½¿ç”¨</p><p><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8">ğŸ“</span> zk çš„ dynamic é…ç½®ï¼ŒquorumPeer æœ‰ä¸€ä¸ª flagï¼š shuttingDowmLE ï¼Œå’Œ version æœ‰å…³ï¼Œè€Œ version è²Œä¼¼å’Œ dynamic çš„é…ç½®æœ‰å…³ç³»ï¼Œçœ‹çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠè¿™ä¸€å—ç†ä¸€ç†</p><h3 id="zab"><a href="#zab" class="headerlink" title="zab"></a>zab</h3><p><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8">ğŸ“</span> zk çš„ zab åè®®ä¸­ï¼Œä¸€é¡¹å†³è®®çš„äº§ç”Ÿæµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ ä»¥ paxos ç®—æ³•æ¥è¯´ï¼Œ zk ä¸­çš„ leader åœ¨ç¬¬ä¸€é˜¶æ®µ prepare çš„æ—¶å€™ï¼Œä¼šå…ˆå¾æ±‚è¶…è¿‡åŠæ•°çš„ follower çš„åŒæ„ï¼Œä¹‹åå†åœ¨ propose é˜¶æ®µå»çœŸæ­£æäº¤ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¼šè¢«å„ä¸ª follower é€‰ä¸­ï¼Œä¸€é¡¹å†³è®®ç”Ÿæˆã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> others </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mine </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Part 2 -- Using ZooKeeper Now</title>
      <link href="/zookeeper/how-to-use/"/>
      <url>/zookeeper/how-to-use/</url>
      
        <content type="html"><![CDATA[<h1 id="ZooKeeper-lt-äºŒ-gt-å®‰è£…ä½¿ç”¨"><a href="#ZooKeeper-lt-äºŒ-gt-å®‰è£…ä½¿ç”¨" class="headerlink" title="ZooKeeper <äºŒ> å®‰è£…ä½¿ç”¨"></a>ZooKeeper &lt;äºŒ&gt; å®‰è£…ä½¿ç”¨</h1><p>ZooKeeper versionï¼š 3.6.0</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>æœ¬ç¤ºä¾‹å‡åœ¨ <strong><code>CentOS Linux release 8.1.1911 (Core)</code></strong> ä¸‹è¿›è¡Œ</p><p>åŒæ—¶éœ€è¦ä¿è¯å½“å‰æœºå™¨å«æœ‰ java ç¯å¢ƒï¼Œjava å®‰è£…æ­¥éª¤å¯å‚è€ƒ <a href="https://iyuhp.top/linux/install/#Java-11">è¿™é‡Œ</a></p><h4 id="1-ä¸‹è½½"><a href="#1-ä¸‹è½½" class="headerlink" title="1. ä¸‹è½½"></a>1. ä¸‹è½½</h4><p>é¦–å…ˆåˆ° <a href="http://zookeeper.apache.org/releases.html" target="_blank" rel="noopener">Apache Download</a> å¯»æ‰¾åˆé€‚çš„ç‰ˆæœ¬ï¼Œè¿™é‡Œä»¥ 3.6.0 ä¸ºä¾‹ï¼Œä¸‹è½½</p><pre class=" language-shell"><code class="language-shell">wget https://downloads.apache.org/zookeeper/current/apache-zookeeper-3.6.0-bin.tar.gz</code></pre><h4 id="2-è§£å‹"><a href="#2-è§£å‹" class="headerlink" title="2. è§£å‹"></a>2. è§£å‹</h4><pre><code>tar -xvf apache-zookeeper-3.6.0-bin.tar.gz</code></pre><h4 id="3-å•æœºç‰ˆå¯åŠ¨"><a href="#3-å•æœºç‰ˆå¯åŠ¨" class="headerlink" title="3. å•æœºç‰ˆå¯åŠ¨"></a>3. å•æœºç‰ˆå¯åŠ¨</h4><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200403152324.png-growing" alt="zookeeper config"></p><p>å¦‚å›¾ç¤ºï¼Œæˆ‘åœ¨è§£å‹å®Œåï¼Œå°†é‚£ä¸²é•¿é•¿çš„ç›®å½•åï¼Œé‡å‘½åä¸º zk1ï¼Œ åŒæ—¶åˆ cp äº† zk2 å’Œ zk3ï¼Œcp zoo_sample.cfg ä¸º zoo.cfg</p><pre class=" language-shell"><code class="language-shell"># ä¿®æ”¹åç§°mv apache-zookeeper-3.6.0-bin zk1# cp ä¸¤ä»½ï¼Œä¸ºåé¢çš„ä¼ªé›†ç¾¤æ­å»ºåšå‡†å¤‡cp -r zk1 zk2 cp -r zk1 zk3# å¢åŠ  zoo.cfg é…ç½®cd zk1 &&  cp conf/zoo_sample.cfg zoo.cfg</code></pre><p>è¿™é‡Œæˆ‘æ²¡æœ‰ä¿®æ”¹ä»»ä½•åœ°æ–¹ï¼Œç›´æ¥ start</p><pre class=" language-shell"><code class="language-shell">./bin/zkServer.sh start/usr/bin/javaZooKeeper JMX enabled by defaultUsing config: /home/dylan/tmp/zookeeper/zk1/bin/../conf/zoo.cfgStarting zookeeper ... STARTED</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œ zk1 å·²ç»å¯åŠ¨ï¼Œæˆ‘ä»¬éªŒè¯ä¸€ä¸‹ï¼š</p><pre class=" language-shell"><code class="language-shell">./bin/zkServer.sh status/usr/bin/javaZooKeeper JMX enabled by defaultUsing config: /home/dylan/tmp/zookeeper/zk1/bin/../conf/zoo.cfgClient port found: 2181. Client address: localhost.Mode: standalone</code></pre><p>é€šè¿‡ <code>zkServer.sh status</code> ï¼Œèƒ½çœ‹åˆ° zk å·²ç»æ­£å¸¸å¯åŠ¨ï¼ŒMode ä¸º standalone ï¼Œå½“æˆ‘ä»¬é…ç½® ensemble æ—¶ï¼Œè¿™ä¸ª Mode å°±ä¼šå˜æˆ Leader/Follower/Observer</p><h4 id="4-å•æœºä¼ªé›†ç¾¤ç‰ˆ"><a href="#4-å•æœºä¼ªé›†ç¾¤ç‰ˆ" class="headerlink" title="4. å•æœºä¼ªé›†ç¾¤ç‰ˆ"></a>4. å•æœºä¼ªé›†ç¾¤ç‰ˆ</h4><p>å‰é¢æˆ‘ä»¬å·²ç» cp äº† 3 ä¸ª zkï¼Œç°åœ¨æˆ‘ä»¬å†æ·»åŠ ä¸€ä¸ª observer èŠ‚ç‚¹ï¼ŒåŒæ—¶ï¼Œåœ¨å„ä¸ª dataDir æ–°å»º <code>myid</code> æ–‡ä»¶ï¼Œå¹¶å†™å…¥å€¼ï¼Œå¦‚  zk1 çš„ dataDir ä¸º <code>/tmp/zk1</code> ï¼Œåˆ™æˆ‘ä»¬æ‰§è¡Œï¼š <code>echo 1 &gt; /tmp/zk1/myid</code></p><h5 id="4-1-å››ä»½é…ç½®å¦‚ä¸‹ï¼š"><a href="#4-1-å››ä»½é…ç½®å¦‚ä¸‹ï¼š" class="headerlink" title="4.1 å››ä»½é…ç½®å¦‚ä¸‹ï¼š"></a>4.1 å››ä»½é…ç½®å¦‚ä¸‹ï¼š</h5><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200404043709.png-growing" alt="ensemble config"></p><p>å…¶ä¸­æ¶‰åŠåˆ°çš„é…ç½®é¡¹æœ‰ï¼š</p><ul><li><p>tickTimeï¼šzk ä¸­çš„è®¡æ—¶å•å…ƒï¼Œå•ä½æ¯«ç§’(milliseconds)ï¼Œå¿ƒè·³é—´éš”ï¼Œsession timeout = 2å€ tickTime(é»˜è®¤)</p></li><li><p>initLimitï¼šensemble åˆå§‹åŒ–æ—¶ï¼Œserver(Follower/Observer) ä¸ Leader è¿›è¡Œè¿æ¥çš„æœ€å¤§æ—¶é•¿ï¼Œè¶…è¿‡è¯¥æ—¶é—´å¦‚æœè¿˜æœªè¿æ¥æˆåŠŸï¼Œåˆ™å®£å‘Šè¿æ¥å¤±è´¥ã€‚å¯¹äº Follower è€Œè¨€ï¼Œåˆ™æ˜¯è¿æ¥å¹¶åŒæ­¥åˆ° Leader çš„æ—¶é—´ã€‚å¦‚æœ zookeeper é›†ç¾¤ç®¡ç†çš„æ•°æ®é‡å¾ˆå¤§ï¼Œåˆ™æ ¹æ®éœ€è¦å¢åŠ è¿™ä¸ªå€¼</p></li><li><p>syncLimitï¼š åŒæ­¥æ—¶é—´ï¼Œå¦‚æœ Follower åœ¨ syncLimit æ—¶é—´å†…æœªå®ŒæˆåŒæ­¥ï¼Œåˆ™å°†è¢« Leader ä¸¢å¼ƒ</p></li><li><p>dataDirï¼šzk ç”¨äºå­˜æ”¾æ•°æ®çš„åœ°æ–¹ï¼Œ<code>myid</code> æ–‡ä»¶ä¹Ÿå­˜æ”¾åœ¨è¿™ä¸ªåœ°æ–¹ã€‚zk å®˜æ–¹å»ºè®®è¯¥ç›®å½•åº”è¯¥æ˜¯ä¸€ä¸ªä¸“é—¨ä¸º zk äº‹åŠ¡æ—¥å¿—å‡†å¤‡çš„ç›®å½•ï¼š</p></li></ul><blockquote><p>To get low latencies on updates it is important to have a dedicated transaction log directory. By default transaction logs are put in the same directory as the data snapshots and myid file. The dataLogDir parameters indicates a different directory to use for the transaction logs.</p></blockquote><ul><li><p>clientPortï¼š ç›‘å¬å®¢æˆ·ç«¯è¿æ¥çš„ç«¯å£ã€‚å¦‚æœä½ çš„å®¢æˆ·ç«¯ä½¿ç”¨çš„ä¸æ˜¯è¿™ä¸ªç«¯å£ï¼Œé‚£è¿™é‡Œå°±è¦æ”¹äº†ã€‚è¿™é‡Œå› ä¸ºåœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œæ‰€ä»¥æ”¹æˆäº†ä¸åŒçš„ç«¯å£</p></li><li><p>peerTypeï¼šé…ç½®äº† <code>peerType=observer</code> çš„ serverï¼Œå°†æˆä¸º observerï¼Œæœ¬ä¾‹ä¸­çš„ zk4 å°†æˆä¸º observer</p></li><li><p>observerMasterPortï¼š é»˜è®¤æƒ…å†µä¸‹ï¼Œ Observer ä» Leader è·å¾—æ–° proposalï¼Œ å¯ç”¨è¯¥é…ç½®åï¼Œobserver å°†ä» Follower è·å¾— proposalã€‚Follower å°†ä¼šç›‘å¬è¯¥ç«¯å£ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œèƒ½å‡è½» Leader çš„å‹åŠ›ã€‚æˆ‘ä¸Šé¢é…ç½®çš„å€¼ä¸ç›¸åŒï¼Œæ˜¯å› ä¸ºæˆ‘åœ¨å•æœºä¸Šï¼Œå¦‚æœé…ç½®ç›¸åŒï¼Œä¼šå‡ºç°ç«¯å£å†²çªï¼Œå®é™…è¿™é‡Œåº”è¯¥æ˜¯åŒä¸€ä¸ªç«¯å£ã€‚</p></li></ul><blockquote><p>By default, Observers connect to the Leader of the quorum along its quorum port and this is how they learn of all new proposals on the ensemble. There are benefits to allowing Observers to connect to the Followers instead as a means of plugging into the commit stream in place of connecting to the Leader. It shifts the burden of supporting Observers off the Leader and allow it to focus on coordinating the commit of writes. This means better performance when the Leader is under high load, particularly high network load such as can happen after a leader election when many Learners need to sync. It reduces the total network connections maintained on the Leader when there are a high number of observers. Activating Followers to support Observers allow the overall number of Observers to scale into the hundreds. On the other end, Observer availability is improved since it will take shorter time for a high number of Observers to finish syncing and start serving client traffic.</p></blockquote><ul><li>server.1=127.0.0.1:2284:3884:observer ï¼š ä¸ºæ–¹ä¾¿ä»‹ç»æˆ‘ä»¬æŠŠè¿™é‡Œæ”¹å†™æˆå¦‚ä¸‹å½¢å¼ï¼š<ul><li>server.myid=net:port1:port2:observerï¼Œ åˆ™</li><li>myidï¼š myidï¼Œéœ€è¦ä¸è¯¥ server dataDir ä¸‹ <code>myid</code> æ–‡ä»¶ä¸­çš„å€¼ä¿æŒä¸€è‡´(è¿™ä¸ªæ–‡ä»¶éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»º)</li><li>netï¼š è¯¥ server çš„ host</li><li>port1ï¼šç”¨äº peer åˆ° peer çš„ TCP é€šä¿¡ï¼Œ peer å³ä¸€ä¸ª zk serverï¼›ä»¥åŠå’Œ Leader ä¹‹é—´çš„é€šä¿¡ï¼Œè¿™ä¸ªç«¯å£ï¼Œäº‹å®ä¸Šï¼Œåªæœ‰ server æˆä¸º Leader åæ‰ä¼šå»ç›‘å¬ã€‚è™½ç„¶æ–‡æ¡£è¯´æ˜¯ peer to peerï¼Œ ä½†ä»”ç»†çœ‹ä¸‹æºç å’Œå®è·µï¼Œè¿™ä¸ªç«¯å£ç¡®å®æ˜¯ Leader ç”¨æ¥å’Œå„ server é€šä¿¡ç”¨çš„</li><li>port2ï¼š é€‰ä¸¾æœŸé—´ï¼Œå„ä¸ª server ä¹‹é—´çš„ TCP é€šä¿¡ç«¯å£ï¼Œå³é€‰ä¸¾ä½¿ç”¨çš„ç«¯å£</li><li>observerï¼š è¡¨æ˜è¯¥ server ä¸º observer</li><li><strong>3.6.0</strong> ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <strong>multiple addresses</strong> ï¼Œ ç»“æ„å¦‚ä¸‹</li><li>server.myid=net1:port1:port2|net2:port1:port2ï¼Œ å³é€šè¿‡åˆ†éš”ç¬¦( <strong>|</strong> )æ¥åˆ†å‰²ä¸åŒçš„ address</li></ul></li><li><em>leaderServes</em> ï¼šLeader æ˜¯å¦å¯ä»¥è¿æ¥ clientï¼Œé»˜è®¤ä¸º trueï¼Œä¸º false æ—¶ï¼Œè¡¨æ˜ Leader åªéœ€è¦ä¸“æ³¨äºååŒ(coordination)ã€‚å¦‚æœå†™è¯·æ±‚è¿œé«˜äºè¯»è¯·æ±‚ï¼Œå¯ä»¥è®¾ç½®ä¸º falseã€‚</li><li>æ›´å¤šé…ç½®ï¼Œè¯·å‚è€ƒ <a href="http://zookeeper.apache.org/doc/r3.6.0/zookeeperAdmin.html" target="_blank" rel="noopener">è¿™é‡Œ</a> ï¼Œ <a href="http://zookeeper.apache.org/doc/r3.6.0/zookeeperObservers.html" target="_blank" rel="noopener">è¿™é‡Œ</a> ï¼Œè¿˜æœ‰ <a href="http://zookeeper.apache.org/doc/r3.6.0/zookeeperReconfig.html" target="_blank" rel="noopener">è¿™é‡Œ</a></li></ul><h5 id="4-2-å¯åŠ¨"><a href="#4-2-å¯åŠ¨" class="headerlink" title="4.2 å¯åŠ¨"></a>4.2 å¯åŠ¨</h5><p>åˆ†åˆ«æ‰§è¡Œ(æ³¨æ„ä¸‹æ‰§è¡Œç›®å½•)</p><pre class=" language-bash"><code class="language-bash">./zk1/bin/zkServer.sh start</code></pre><p>ä¸Šé¢æ²¡æœ‰æ›´æ”¹æ—¥å¿—ä½ç½®ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ ./zk1/logs ä¸‹é¢æ‰¾åˆ°</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200404031221.png-growing" alt="zookeeper starting"></p><p>å½“åªå¯åŠ¨äº† zk1 æ—¶ï¼Œæ—¥å¿—å¦‚ä¸Šæ‰€ç¤ºï¼Œå®ƒåœ¨å°è¯•å’Œ zk2 ï¼Œzk3 é€šä¿¡æ—¶ï¼Œä¼šä¸€ç›´å¤±è´¥ï¼Œå½“æˆ‘ä»¬å¯åŠ¨äº† zk2 å’Œ zk3 æ—¶ï¼Œæ•´ä¸ªé›†ç¾¤å°±ä¼šç¨³å®šä¸‹æ¥ã€‚</p><p>å› ä¸ºå•æœºç‰ˆçš„é—®é¢˜ï¼Œè¿™é‡Œ zk4 ï¼Œå³ observer çš„ observerMasterPort é…ç½®ä¸º 2481ï¼Œå³ zk1 ï¼Œæ‰€ä»¥å¦‚æœ zk1 å½“é€‰ä¸º Leader ï¼Œæ­¤æ—¶ zk4 ä¼šç–¯ç‹‚åˆ·æ—¥å¿—ï¼ŒæŠ¥ connection refusedï¼Œåˆ«é—®æˆ‘æ€ä¹ˆçŸ¥é“çš„ï¼ï¼ï¼</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200404044913.png-growing" alt="ensemble listening ports"></p><p>é€šè¿‡è¿™å¼ å›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ° ï¼Œzk1 æˆåŠŸå½“é€‰äº† leaderï¼Œåˆ™å®ƒç›‘å¬çš„ç«¯å£æœ‰ï¼š</p><ul><li>3881ï¼šç”¨äºé€‰ä¸¾çš„ç«¯å£ï¼Œä»»ä½•æ—¶å€™éƒ½ä¼šå»ç›‘å¬</li><li>2281ï¼šç”¨äºå’Œå…¶ä»– server é€šä¿¡çš„ç«¯å£ï¼Œå³å‰æ–‡çš„ port1</li><li>2481ï¼š ä½œä¸º leaderï¼Œå®ƒå·²ç»ä¸ç”¨å»ç›‘å¬è¿™ä¸ª observerMasterPort äº†ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬çœ‹ä¸åˆ°</li><li>2181ï¼š ç”¨äºå’Œå®¢æˆ·ç«¯é€šä¿¡çš„ç«¯å£ï¼Œæˆ‘ä»¬æ²¡æœ‰é…ç½® <em>leaderServes=false</em>ï¼Œæ‰€ä»¥ leader è¿˜éœ€è¦å“åº” client </li></ul><p>Follower ç›‘å¬çš„ç«¯å£æœ‰(è¿™é‡Œä»¥ zk2 ä¸ºä¾‹)ï¼š</p><ul><li>3882ï¼šé€‰ä¸¾ç«¯å£ï¼Œæ—¶åˆ»ä¿æŒç›‘å¬ï¼Œä¸‡ä¸€ leader æŒ‚äº†ï¼Œé€‰äº†æˆ‘åš leader å‘¢ï¼</li><li>2482ï¼šobserverMasterPortï¼Œè´Ÿè´£å’Œ observer é€šä¿¡çš„ TCP ç«¯å£</li><li>2182ï¼šå’Œ client äº¤äº’çš„ TCP ç«¯å£</li></ul><h5 id="4-3-ç®€å•ä½¿ç”¨"><a href="#4-3-ç®€å•ä½¿ç”¨" class="headerlink" title="4.3 ç®€å•ä½¿ç”¨"></a>4.3 ç®€å•ä½¿ç”¨</h5><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ä¸åŠ []ä¸­å†…å®¹ï¼Œé»˜è®¤è¿æ¥åˆ° 2181 ç«¯å£</span>./zk1/bin/zkCli.sh <span class="token punctuation">[</span>-server localhost:2182<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># è¾“å…¥ help ï¼Œä¼šæ‰“å°å‡ºå‘½ä»¤</span><span class="token comment" spellcheck="true"># å¯ä»¥çœ‹åˆ° create ç›¸å…³: create [-s] [-e] [-c] [-t ttl] path [data] [acl]</span><span class="token comment" spellcheck="true"># æˆ‘ä»¬ç”¨ create åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹,å…¶ä¸­ data ä¸º "zk_test_data"ï¼Œ acl æˆ‘ä»¬æš‚æ—¶ä¸è®¾ç½®</span>create /zk_test <span class="token string">"zk_test_data"</span><span class="token comment" spellcheck="true"># é€šè¿‡ ls / èƒ½åˆ°èŠ‚ç‚¹å·²ç»åˆ›å»º</span><span class="token function">ls</span> /<span class="token comment" spellcheck="true"># get è·å–èŠ‚ç‚¹ä¿¡æ¯, -s å‚æ•°ä¼šæŠŠæ•´ä¸ªèŠ‚ç‚¹ä¿¡æ¯ zxid ç­‰æ‰“å°å‡ºæ¥</span>get -s /zk_test<span class="token comment" spellcheck="true"># æ›´å¤šå‘½ä»¤è¯·ç™¾åº¦/Google</span><span class="token comment" spellcheck="true"># ä½¿ç”¨åˆ°æ­¤ç»“æŸ</span></code></pre><h2 id="ACL"><a href="#ACL" class="headerlink" title="ACL"></a>ACL</h2><p>ACL æœ‰å…³çš„å®˜æ–¹æ–‡æ¡£è¯·ç‚¹å‡» <a href="http://zookeeper.apache.org/doc/r3.6.0/zookeeperProgrammers.html#sc_ZooKeeperAccessControl" target="_blank" rel="noopener">è¿™é‡Œ</a></p><p>æ‰€è°“ ACL ï¼Œå³ Access Control Lists ï¼Œè®¿é—®æ§åˆ¶åˆ—è¡¨ã€‚åœ¨ zk ä¸­ï¼Œç”¨æ¥æ§åˆ¶è®¿é—® znodeã€‚</p><h3 id="1-ACL-æ„æˆ"><a href="#1-ACL-æ„æˆ" class="headerlink" title="1. ACL æ„æˆ"></a>1. ACL æ„æˆ</h3><blockquote><p>&lt;scheme&gt;:&lt;id&gt;:&lt;perms&gt;</p></blockquote><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// org.apache.zookeeper.data.ACL</span><span class="token keyword">public</span> <span class="token function">ACL</span><span class="token punctuation">(</span>    <span class="token keyword">int</span> perms<span class="token punctuation">,</span>    org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>zookeeper<span class="token punctuation">.</span>data<span class="token punctuation">.</span>Id id<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>perms<span class="token operator">=</span>perms<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token operator">=</span>id<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// org.apache.zookeeper.data.Id</span><span class="token keyword">public</span> <span class="token function">Id</span><span class="token punctuation">(</span>    String scheme<span class="token punctuation">,</span>    String id<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>scheme<span class="token operator">=</span>scheme<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token operator">=</span>id<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// org.apache.zookeeper.ZooDefs.Perms </span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Perms</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> READ <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> WRITE <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> CREATE <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> DELETE <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> ADMIN <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> ALL <span class="token operator">=</span> READ <span class="token operator">|</span> WRITE <span class="token operator">|</span> CREATE <span class="token operator">|</span> DELETE <span class="token operator">|</span> ADMIN<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>é€šè¿‡æºç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°, ACL = Id + perms æ„æˆ , è€Œ Id = scheme + id</p><h3 id="2-Perms"><a href="#2-Perms" class="headerlink" title="2. Perms"></a>2. Perms</h3><p>åŒæ ·ç”±æºç å¯ä»¥çœ‹åˆ° <strong>perms</strong> ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ç§:</p><ul><li>read</li><li>write</li><li>create</li><li>delete</li><li>admin : you can set permissions , æ¯•ç«Ÿæ˜¯ admin,ä½ å¯ä»¥èƒ¡ä½œéä¸º</li><li>allï¼š æ‰€æœ‰æƒé™</li></ul><h3 id="3-å†…ç½®æƒé™æ–¹æ¡ˆ"><a href="#3-å†…ç½®æƒé™æ–¹æ¡ˆ" class="headerlink" title="3. å†…ç½®æƒé™æ–¹æ¡ˆ"></a>3. å†…ç½®æƒé™æ–¹æ¡ˆ</h3><p>zookeeper å†…ç½®çš„ scheme æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p><ul><li><p>worldï¼š å³ä»»ä½•äººéƒ½å¯ä»¥æ‹¥æœ‰ä½ è®¾ç½®çš„æƒé™ï¼Œ&lt;world&gt;:&lt;anyone&gt;&lt;perms&gt;</p></li><li><p>digestï¼š&lt;digets&gt;:&lt;username:password&gt;:&lt;perms&gt; , è¿™é‡Œçš„ passwordï¼Œ æ˜¯æŒ‡ base64 ç¼–ç çš„ sha1 å¯†ç æ‘˜è¦ï¼Œå¡«å…¥ ACL ä¸­ã€‚æ¯”å¦‚ username ä¸º dylan , å¯†ç ä¸º 123456ï¼Œ åˆ™è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š </p><pre class=" language-bash"><code class="language-bash"><span class="token keyword">echo</span> -n dylan:123456 <span class="token operator">|</span> openssl dgst -binary -sha1 <span class="token operator">|</span> openssl base64</code></pre><p>åˆ™æœ€ç»ˆ scheme åº”è¯¥é•¿è¿™ä¸ªæ ·å­ï¼š </p><blockquote><p> digest:dylan:7i6SL+m6GkW2OYpURnpkay0UdBc=:crwda</p></blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200404065646.png-growing" alt="digest NoAuth"></p></li><li><p>ipï¼šä½¿ç”¨å®¢æˆ·ç«¯ä¸»æœº IP ä½œä¸º ACL ID èº«ä»½ã€‚ ACL è¡¨è¾¾å¼çš„å½¢å¼ä¸º addr / bitsï¼Œå…¶ä¸­ addr çš„æœ€é«˜æœ‰æ•ˆä½ä¸å®¢æˆ·ç«¯ä¸»æœº IP çš„æœ€é«˜æœ‰æ•ˆä½ç›¸åŒ¹é…ã€‚å¦‚ï¼š <code>ip:127.0.0.1/16:crwda</code>   è¿™é‡Œæ–‡æ¡£è¯´æœ€é«˜æœ‰æ•ˆä½ä¸ client ä¸»æœº ip æœ€é«˜æœ‰æ•ˆä½è¦ç›¸åŒ¹é…ï¼Œä¸è¿‡æˆ‘å®é™…è¯•äº†ä¸‹ï¼Œä¸åŒ¹é…ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œè¿™é‡Œæš‚æ—¶å­˜ç–‘ã€‚</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200404070529.png-growing" alt="acl ip"></p></li><li><p>authï¼š æ—  idï¼Œ å¯¹æ‰€æœ‰å·²è®¤è¯çš„ç”¨æˆ·å¼€æ”¾ã€‚å½¢å¦‚ <code>auth::crwda</code> ï¼Œè¿™é‡Œå³ä½¿è®¾ç½®äº† idï¼Œä¹Ÿä¼šè¢«å¿½ç•¥æ‰ï¼</p></li><li><p>x509ï¼šä½¿ç”¨ <strong>x509</strong> è¯ä¹¦è¿›è¡Œ client ç«¯éªŒè¯ï¼Œä½¿ç”¨è¯¥æ–¹æ¡ˆæ—¶ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®å¦‚ä¸‹é€‰é¡¹ ï¼Œå…·ä½“å‚è§ <a href="http://zookeeper.apache.org/doc/r3.6.0/zookeeperAdmin.html" target="_blank" rel="noopener">è¿™é‡Œ</a></p><blockquote><p>zookeeper.ssl.keyStore.location</p><p>zookeeper.ssl.trustStore.location</p><p>zookeeper.ssl.keyStore.password</p><p>zookeeper.ssl.trustStore.password</p></blockquote></li></ul><p>äº‹å®ä¸Šï¼Œè¿˜æœ‰ <code>sasl</code>ï¼Œä½ å¯ä»¥åœ¨ zoo.cfg ä¸­è¿›è¡Œé…ç½®ï¼š</p><blockquote><p>authProvider.1=org.apache.zookeeper.server.auth.SASLAuthenticationProvider</p></blockquote><p>ä»¥åŠ <code>super</code>  ï¼ï¼ï¼ </p><h2 id="Watch"><a href="#Watch" class="headerlink" title="Watch"></a>Watch</h2><p>Watch æœ‰å…³çš„å®˜æ–¹æ–‡æ¡£è¯·å‚è€ƒ <a href="http://zookeeper.apache.org/doc/r3.6.0/zookeeperProgrammers.html#ch_zkWatches" target="_blank" rel="noopener">è¿™é‡Œ</a></p><p>zk çš„ watch æœºåˆ¶ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ <a href="../introduction/">è¿™ç¯‡æ–‡ç« </a> æåˆ°çš„å¾ˆå¤šåº”ç”¨çš„ä¿è¯ä¹‹ä¸€ï¼Œæ­£å¼å› ä¸º zk çš„ watch æœºåˆ¶æä¾›äº†è¿™äº›ä¿è¯ï¼Œæˆ‘ä»¬æ‰èƒ½è¯´ï¼Œè¿™æ ·åšï¼Œæ˜¯å¯ä»¥çš„ã€‚</p><p>é‚£ä¹ˆï¼Œzk çš„ watch æœºåˆ¶ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿåˆæä¾›äº†å“ªäº›ä¿è¯å‘¢ï¼Ÿ</p><p>zk watch event ï¼Œå½“ watch çš„ æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œwatch event ä¼š <strong>ä¸€æ¬¡è§¦å‘</strong> ï¼Œå‘é€ç»™è®¾ç½®äº† watch event çš„å®¢æˆ·ç«¯ã€‚</p><ul><li>one-time trigger ï¼š å½“è®¾ç½®çš„ watch event è¢«å¤„ç½šæ—¶ï¼Œè§¦å‘ä¸”ä»…è§¦å‘ä¸€æ¬¡ã€‚å½“è¿™ä¸ªèŠ‚ç‚¹å†æ¬¡æ”¹å˜æ—¶ï¼Œä¸ä¼šäºŒæ¬¡è§¦å‘ï¼Œé™¤éå†æ¬¡è®¾ç½® watch event(<strong>3.6 ä¸­å·²ç»å¢åŠ äº†æ°¸ä¹…ï¼Œæ°¸ä¹…é€’å½’ç±»å‹çš„ watch</strong>)</li><li>send to the clientï¼šwatch event ä¼šè¢«å¼‚æ­¥çš„å‘é€è¢« clientï¼Œç”±äºç½‘ç»œå»¶è¿Ÿç­‰é—®é¢˜ï¼Œä¼šå¯¼è‡´å„ä¸ª client æ”¶åˆ° event çš„æ—¶é—´å·®å¼‚ï¼Œ zk ä¿è¯ <strong>ä¸€ä¸ª client æ°¸è¿œä¸ä¼šåœ¨ watch event åˆ°æ¥å‰ï¼Œè§‚å¯Ÿåˆ°æ•°æ®çš„å˜æ›´ï¼Œåªæœ‰åœ¨ client ç›‘å¬åˆ° event åï¼Œæ‰èƒ½æ„ŸçŸ¥åˆ°æ•°æ®çš„å˜åŒ–</strong> </li><li>the data for which the watch was setï¼šè¿™é‡ŒæŒ‡ zk ä¸åŒçš„ watch event ï¼Œä¼šäº§ç”Ÿä¸åŒçš„æ•ˆæœã€‚è¿™é‡Œä¸‹æ–‡ä¼šä»‹ç»åˆ°</li></ul><h3 id="1-watch-event-type"><a href="#1-watch-event-type" class="headerlink" title="1. watch event type"></a>1. watch event type</h3><p>æˆ‘ä»¬åœ¨ <code>org.apache.zookeeper.Watcher.Event.EventType</code> èƒ½çœ‹åˆ°ï¼Œ 3.6 ç‰ˆæœ¬æ€»å…±æœ‰å¦‚ä¸‹å‡ ç§ watch eventï¼š</p><ul><li>Noneï¼šæ—  watch</li><li>NodeCreatedï¼šé€šè¿‡ exists() æ·»åŠ ï¼Œå½“è¿™ä¸ªèŠ‚ç‚¹è¢«åˆ›å»ºåï¼Œå‘å‡º watch event</li><li>NodeDeletedï¼šé€šè¿‡ exists , getData , getChildren æ·»åŠ </li><li>NodeDataChangedï¼šexists å’Œ getData æ·»åŠ </li><li>NodeChildrenChangedï¼š getChildren æ·»åŠ </li><li>DataWatchRemovedï¼š exists å’Œ getData æ·»åŠ </li><li>ChildWatchRemovedï¼šgetChildren æ·»åŠ </li><li>PersistentWatchRemovedï¼špersistent watch æ·»åŠ ï¼Œ <font color="red">3.6.0</font> ä¸­ï¼Œä¸“é—¨æœ‰ addWatch æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥æŒ‡å®š watcher ç±»å‹ï¼Œå…·ä½“éœ€è¦å‚è€ƒä½¿ç”¨ zk clientï¼š<ul><li>PERSISTENT ï¼š æŒä¹… watch ï¼Œdata change å’Œ children change å‡ä¼šè¢«è§¦å‘</li><li>PERSISTENT_RECURSIVEï¼šæŒä¹…é€’å½’ watchï¼Œä¼š watch ç»™å®š path çš„ children</li></ul></li></ul><h3 id="2-zookeeper-guarantees-about-watches"><a href="#2-zookeeper-guarantees-about-watches" class="headerlink" title="2. zookeeper guarantees about watches"></a>2. zookeeper guarantees about watches</h3><ul><li>zk(å‡†ç¡®è¯´æ˜¯ zk client) ä¿è¯ watch event çš„æ´¾å‘æ˜¯æœ‰åºçš„</li><li>zk client åœ¨æ”¶åˆ° znode çš„ watch event ä¹‹åæ‰èƒ½çœ‹åˆ°è¯¥ znode çš„æ–°æ•°æ®</li><li>zk ä¸­ watch event çš„é¡ºåºä¸ zk çœ‹åˆ°çš„æ›´æ–°é¡ºåºä¸€è‡´ã€‚å³ zk ä¸­çš„ watch event é¡ºåºä¸ zk çš„æ›´æ–°é¡ºåºç›¸å¯¹åº”</li></ul><p>åŸºäº watch event çš„ç‰¹ç‚¹ï¼Œæœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š</p><ul><li>å¦‚æœä½ ä½¿ç”¨ä¸€æ¬¡æ€§çš„ watch eventï¼Œåˆ™åœ¨å†æ¬¡ watch znode çš„æ—¶å€™ï¼Œä½ éœ€è¦åšå¥½é—æ¼è¯¥ znode å¯èƒ½å‡ºç°çš„å¤šæ¬¡å˜æ›´çš„æƒ…å†µã€‚å› ä¸ºåœ¨ä½ å†æ¬¡æ·»åŠ  watch event çš„æ—¶å€™ï¼Œè¿™ä¸ª znode å¯èƒ½å·²ç»è¢«æ”¹å˜äº†å¥½å‡ æ¬¡äº†ã€‚</li><li>watch event æ˜¯ one-time trigger ï¼Œ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ æ—¢é€šè¿‡ exists åˆé€šè¿‡ getData è®¾ç½®äº† watch event ï¼Œé‚£ä¹ˆä½ æœ€ç»ˆåªä¼šè·å¾—ä¸€ä¸ª watch event äº‹ä»¶ã€‚</li></ul><h2 id="To-Be-Continue"><a href="#To-Be-Continue" class="headerlink" title="To Be Continue"></a>To Be Continue</h2><ol><li>FastLeaderElection</li><li>Zab åè®®è¯¦è§£</li><li>éƒ¨åˆ†æºç è§£æ</li><li>watch æºç è§£æ</li></ol><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> middlewares </category>
          
      </categories>
      
      
        <tags>
            
            <tag> zookeeper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Part 1 -- ZOOKEEPER æ¦‚è¦</title>
      <link href="/zookeeper/introduction/"/>
      <url>/zookeeper/introduction/</url>
      
        <content type="html"><![CDATA[<h1 id="ZooKeeper-lt-ä¸€-gt-åº”ç”¨åœºæ™¯"><a href="#ZooKeeper-lt-ä¸€-gt-åº”ç”¨åœºæ™¯" class="headerlink" title="ZooKeeper  < ä¸€ > åº”ç”¨åœºæ™¯"></a>ZooKeeper  &lt; ä¸€ &gt; åº”ç”¨åœºæ™¯</h1><blockquote><p>A Distributed Coordination Service for Distributed Applications</p></blockquote><p>è¿™æ˜¯ ZooKeeper å®˜æ–¹æ–‡æ¡£ä¸Šçš„ä¸€å¥è¯ï¼Œæ„ä¸ºï¼š ä¸€æ¬¾ä¸ºåˆ†å¸ƒå¼åº”ç”¨è€Œç”Ÿçš„åˆ†å¸ƒå¼ååŒæœåŠ¡ã€‚</p><p>ZooKeeper versionï¼š 3.6.0</p><h2 id="ZooKeeper-æ¶æ„"><a href="#ZooKeeper-æ¶æ„" class="headerlink" title="ZooKeeper æ¶æ„"></a>ZooKeeper æ¶æ„</h2><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200403025045.jpg-growing" alt="ZooKeeper Architecture"></p><p>zk é›†ç¾¤é€šå¸¸åŒ…å«</p><h3 id="1-è§’è‰²"><a href="#1-è§’è‰²" class="headerlink" title="1. è§’è‰²"></a>1. è§’è‰²</h3><ul><li>Leaderï¼šæˆ–è€…å« Master <ul><li>zké›†ç¾¤(å®˜æ–¹ç§°ä¹‹ä¸º ensemble) ä¸­ï¼ŒåŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ª leaderï¼Œå¦‚æœæœ‰å¤šä¸ªï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º è„‘è£‚(ç½‘ç»œåˆ†åŒºå¯èƒ½äº§ç”Ÿè¿™ç§æƒ…å†µ)</li><li>leader èŠ‚ç‚¹è´Ÿè´£ ensemble ä¸­æ‰€æœ‰çš„å†™æ“ä½œï¼Œå®Œæˆåå¹¿æ’­ç»™å„ä¸ªèŠ‚ç‚¹</li><li>leader èŠ‚ç‚¹è´Ÿè´£å‘èµ·å¹¶ç»´æŠ¤ä¸å„ä¸ª follower/observer çš„å¿ƒè·³ã€‚å¦‚æœ leader å®•æœºï¼Œfollower æ”¶ä¸åˆ°å¿ƒè·³ï¼Œå°±ä¼šå‘èµ·é€‰ä¸¾</li></ul></li><li>Followerï¼š<ul><li>è´Ÿè´£ä¸ä¹‹è¿æ¥çš„ client çš„è¯»è¯·æ±‚</li><li>è´Ÿè´£å°†å†™è¯·æ±‚è½¬å‘ç»™ leader</li><li>å“åº” leader çš„å¿ƒè·³</li><li>å‚ä¸é€‰ä¸¾</li></ul></li><li>Observerï¼šä¸å‚ä¸æŠ•ç¥¨ï¼å…¶ä»–ä¸ Follower åŠŸèƒ½ä¸€è‡´</li></ul><h3 id="2-ç»„ä»¶"><a href="#2-ç»„ä»¶" class="headerlink" title="2. ç»„ä»¶"></a>2. ç»„ä»¶</h3><h4 id="2-1-ZNode-zookeeper-data-node"><a href="#2-1-ZNode-zookeeper-data-node" class="headerlink" title="2.1 ZNode(zookeeper data node)"></a>2.1 ZNode(zookeeper data node)</h4><p>åœ¨ <code>org.apache.zookeeper.CreateMode</code> æšä¸¾ç±»ä¸­ï¼Œå…±æœ‰ 7 ä¸­ znode ç±»å‹ï¼Œæˆ‘ä»¬ä¸€ä¸€ä»‹ç»ï¼š</p><ul><li>PERSISTENT ï¼š flag=0ï¼ŒæŒä¹…èŠ‚ç‚¹ï¼Œé™¤éä¸»åŠ¨åˆ é™¤ï¼Œå¦åˆ™ä¸€ç›´å­˜åœ¨</li><li>PERSISTENT_SEQUENTIAL ï¼š flag = 2ï¼ŒæŒä¹…é¡ºåºèŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹ä¼šå¸¦ä¸Šä¸€ä¸ªå•è°ƒé€’å¢çš„ 10 ä½åºåˆ—å·</li><li>EPHEMERAL ï¼šflag = 1ï¼Œä¸´æ—¶èŠ‚ç‚¹ï¼Œä¼šè¯ç»“æŸå³è¢«åˆ é™¤</li><li>EPHEMERAL_SEQUENTIAL ï¼šflag = 3ï¼Œä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼Œä¼šè¯ç»“æŸå³è¢«åˆ é™¤</li><li>CONTAINER ï¼š flag = 4ï¼Œ å®¹å™¨èŠ‚ç‚¹ï¼Œå½“è¯¥èŠ‚ç‚¹ä¸‹æ‰€æœ‰å­èŠ‚ç‚¹è¢«åˆ é™¤åï¼Œ è¯¥èŠ‚ç‚¹å°†åœ¨å°†æ¥çš„æŸä¸ªæ—¶åˆ»è¢«åˆ é™¤</li><li>PERSISTENT_WITH_TTL ï¼š flag = 5ï¼Œè¯¥èŠ‚ç‚¹åœ¨å®¢æˆ·ç«¯æ–­å¼€æ—¶ä¸ä¼šè¢«åˆ é™¤ï¼Œä½†è‹¥åœ¨ç»™å®šçš„ TTL èŒƒå›´å†…æ²¡æœ‰ä¿®æ”¹ï¼Œä¸”æ²¡æœ‰å­èŠ‚ç‚¹æ—¶ï¼Œ å°†è¢«åˆ é™¤</li><li>PERSISTENT_SEQUENTIAL_WITH_TTL ï¼š flag = 6ï¼Œ åŒä¸Šï¼Œå¤šäº†é¡ºåº</li></ul><h4 id="2-2-ACL"><a href="#2-2-ACL" class="headerlink" title="2.2 ACL"></a>2.2 ACL</h4><p><a href="../how-to-use/#toc-heading-6">ç‚¹å‡»è¿™é‡Œ</a></p><h4 id="2-3-Watcher"><a href="#2-3-Watcher" class="headerlink" title="2.3 Watcher"></a>2.3 Watcher</h4><p><a href="../how-to-use/#toc-heading-10">ç‚¹å‡»è¿™é‡Œ</a></p><h4 id="2-4-ZAB"><a href="#2-4-ZAB" class="headerlink" title="2.4 ZAB"></a>2.4 ZAB</h4><p><a href="../zab/">ç‚¹å‡»è¿™é‡Œ</a></p><h2 id="ZooKeeper-å¸¸ç”¨åº”ç”¨åœºæ™¯"><a href="#ZooKeeper-å¸¸ç”¨åº”ç”¨åœºæ™¯" class="headerlink" title="ZooKeeper å¸¸ç”¨åº”ç”¨åœºæ™¯"></a>ZooKeeper å¸¸ç”¨åº”ç”¨åœºæ™¯</h2><h3 id="1-å‘½åæœåŠ¡"><a href="#1-å‘½åæœåŠ¡" class="headerlink" title="1. å‘½åæœåŠ¡"></a>1. å‘½åæœåŠ¡</h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œzk çš„é¡ºåºèŠ‚ç‚¹ç‰¹æ€§ï¼Œå°±æ˜¯åˆ›å»ºçš„èŠ‚ç‚¹ååï¼Œä¼šè¢«åŠ ä¸Šä¸€ä¸ªå•è°ƒé€’å¢çš„ 10 ä½åºåˆ—å·ã€‚åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å…¨å±€ç»Ÿä¸€å‘½åæœåŠ¡ã€‚</p><ol><li><p>client1 å‘ /_namespace/_type1 èŠ‚ç‚¹ä¸‹åˆ›å»º _name é¡ºåºèŠ‚ç‚¹ï¼Œæ‹¼æ¥åï¼Œ _namespace_type1_name0000000001 </p></li><li><p>client2 å‘ /_namespace/_type2 èŠ‚ç‚¹ä¸‹åˆ›å»º  _name é¡ºåºèŠ‚ç‚¹ï¼Œä¼šè·å¾—ï¼Œ  _namespace_type2_name0000000002</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200403122544.png-growing" alt="zk namespace server"></p></li></ol><p>è¿™æ ·å°±å®ç°äº†ç»Ÿä¸€å‘½å </p><h3 id="2-åˆ†å¸ƒå¼é”"><a href="#2-åˆ†å¸ƒå¼é”" class="headerlink" title="2. åˆ†å¸ƒå¼é”"></a>2. åˆ†å¸ƒå¼é”</h3><p>åˆ†å¸ƒå¼é”åœ¨è¿™é‡Œå¯ä»¥åˆ†ä¸ºä¸¤ç§</p><ul><li>æŠ¢å å¼</li><li>éæŠ¢å å¼</li></ul><p>å¯¹äº<strong>æŠ¢å å¼åˆ†å¸ƒå¼é”</strong>è€Œè¨€ï¼Œå¯ä»¥åˆ©ç”¨ zk çš„ä¸´æ—¶èŠ‚ç‚¹ç‰¹æ€§ã€‚</p><p>æ¯ä¸ªéœ€è¦ Lock çš„ client å‘ zk çš„ /lock èŠ‚ç‚¹ä¸‹åˆ›å»º /get_lock å­èŠ‚ç‚¹(ä¸´æ—¶èŠ‚ç‚¹)ï¼Œåˆ›å»ºæˆåŠŸçš„ client è·å¾—é”ï¼Œå®Œæˆååˆ é™¤è¯¥ä¸´æ—¶èŠ‚ç‚¹ã€‚</p><p>å…¶ä»– client åœ¨åˆ›å»ºå¤±è´¥åï¼Œwatch è¯¥èŠ‚ç‚¹ï¼Œä¸€æ—¦å‘ç°è¢«åˆ é™¤ï¼Œå†æ¬¡è¯•å›¾åˆ›å»º /get_lock ï¼ŒæˆåŠŸå³å¯è·å¾—é”ã€‚</p><p>å¯¹äºéæŠ¢å å¼è€Œè¨€ï¼Œå¯ä»¥åˆ©ç”¨ zk çš„ä¸´æ—¶é¡ºåºèŠ‚ç‚¹ç‰¹æ€§ã€‚</p><p>æ¯ä¸ªéœ€è¦ Lock çš„ client ï¼Œåœ¨ /lock èŠ‚ç‚¹ä¸‹åˆ›å»º /get_lock ä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼ŒæˆåŠŸåè·å– /lock èŠ‚ç‚¹ä¸‹æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œå¦‚æœåºå·æ˜¯æœ€å°çš„ï¼Œåˆ™è·å–é”ï¼Œå¦åˆ™ watch ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ”¶åˆ° delete event åå³å¯è·å¾— lockï¼Œä½¿ç”¨å®Œåˆ é™¤èŠ‚ç‚¹ï¼Œé‡Šæ”¾é”</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200403121745.png-growing" alt="lock flow"></p><h3 id="3-å‘å¸ƒè®¢é˜…"><a href="#3-å‘å¸ƒè®¢é˜…" class="headerlink" title="3. å‘å¸ƒè®¢é˜…"></a>3. å‘å¸ƒè®¢é˜…</h3><p>æœåŠ¡å‘ç°ï¼Œé…ç½®ä¸­å¿ƒï¼Œéƒ½æ˜¯ä¸€æ ·ã€‚</p><p>è¿™é‡Œä»¥ dubbo zookeeper registry çš„å®ç°ä¸ºä¾‹ï¼Œå¦‚ä½•åˆ©ç”¨ zk çš„ ä¸´æ—¶èŠ‚ç‚¹ï¼Œæ¥å®ŒæˆæœåŠ¡å‘ç°</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200403123158.jpg-growing" alt="Dubbo ZooKeeper Registry Flow"></p><p>è¿™é‡Œä»¤ /root = /dubbo/com.foo.BarService</p><ul><li><p>é¦–å…ˆå¯åŠ¨æœåŠ¡æä¾›è€…ï¼Œä¼šå‘ zk çš„ /root/providers èŠ‚ç‚¹ä¸‹ï¼Œå†™å…¥è‡ªå·±çš„ URL åœ°å€(ä¸´æ—¶èŠ‚ç‚¹)</p></li><li><p>ç„¶åå¯åŠ¨æœåŠ¡æ¶ˆè´¹è€…ï¼Œä¼šå¯¹ /root/providers æ·»åŠ  watchï¼Œæˆ–è€…è¯´æ˜¯è®¢é˜…ï¼ŒåŒæ—¶å‘ /root/consumers èŠ‚ç‚¹ä¸‹å†™å…¥è‡ªå·±çš„ URL åœ°å€(ä¸´æ—¶èŠ‚ç‚¹)</p></li><li><p>ç›‘æ§ä¸­å¿ƒ(ä¸€èˆ¬ä¸º dubbo admin)å¯åŠ¨ï¼Œwatch æˆ–è€…è¯´è®¢é˜…æ•´ä¸ª /root èŠ‚ç‚¹çš„ childrenï¼Œè¿™æ ·ï¼Œå½“ provider æˆ–è€… consumer å‘ç”Ÿå˜åŠ¨æ—¶ï¼Œæˆ‘ä»¬å°±èƒ½åŠæ—¶çš„é€šè¿‡ dubbo admin è§‚å¯Ÿåˆ°</p></li></ul><h3 id="4-Master-é€‰ä¸¾"><a href="#4-Master-é€‰ä¸¾" class="headerlink" title="4. Master é€‰ä¸¾"></a>4. Master é€‰ä¸¾</h3><p>æ‰€è°“ Master é€‰ä¸¾ï¼Œè¿™é‡Œè¯´çš„å¹¶ä¸æ˜¯ zk çš„ leader é€‰ä¸¾ã€‚</p><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸‹ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šé‡åˆ°å®šæ—¶ä»»åŠ¡è¿™ç§åœºæ™¯ã€‚æ¯”å¦‚åœ¨å‡Œæ™¨å››ç‚¹(å‡Œæ™¨å†ä¹Ÿæ²¡æœ‰å››ç‚¹äº†â€¦ )ç»Ÿè®¡æ˜¨å¤©çš„å•†å“æŠ¥è¡¨ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ª server å»è·‘å°±å¥½äº†ã€‚è¿™é‡Œå°±å¯ä»¥åˆ©ç”¨ zk çš„ä¸´æ—¶èŠ‚ç‚¹ç‰¹æ€§ã€‚</p><p>åŒæ ·çš„ï¼Œæ¯å° server åœ¨ run job æ—¶ï¼Œå…ˆå» zk æ³¨å†Œä¸€ä¸ªç‰¹å®šä¸´æ—¶èŠ‚ç‚¹ï¼Œæ¯”å¦‚ <code>/item/_statistics</code> ï¼Œç”±åˆ›å»ºæˆåŠŸçš„ server å»æ‰§è¡Œå°±å¥½</p><h3 id="5-others"><a href="#5-others" class="headerlink" title="5. others"></a>5. others</h3><ul><li>é›†ç¾¤ç›‘æ§ï¼š åšæ³•ç±»ä¼¼ï¼Œæ¯å° server åˆ°æŒ‡å®šèŠ‚ç‚¹ä¸‹(å¦‚ _monitor)æ³¨å†Œä¸€ä¸ª ephemeral ç±»å‹èŠ‚ç‚¹ï¼Œç›‘æ§ç«¯è´Ÿè´£ watch _monitor ,å½“æœ‰æœºå™¨åŠ å…¥æˆ–è€…æ‰çº¿ï¼Œå°±ä¼šæ”¶åˆ°é€šçŸ¥</li><li>åˆ†å¸ƒå¼é˜Ÿåˆ—(FIFO)ï¼šåˆ©ç”¨ zk çš„ä¸´æ—¶æœ‰åºèŠ‚ç‚¹ç‰¹æ€§ï¼Œåœ¨æŒ‡å®šèŠ‚ç‚¹ä¸‹åˆ›å»ºä¸´æ—¶æœ‰åºèŠ‚ç‚¹åè·å–æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œå¦‚æœè‡ªå·±åºå·æœ€å°ï¼Œåˆ™æ‰§è¡Œ</li><li>è´Ÿè½½å‡è¡¡ï¼šåˆ©ç”¨ä¸´æ—¶èŠ‚ç‚¹ç‰¹æ€§ï¼Œserver åœ¨æŒ‡å®šèŠ‚ç‚¹åˆ›å»ºä¸´æ—¶èŠ‚ç‚¹ï¼Œå®¢æˆ·ç«¯è¯»å–èŠ‚ç‚¹ä¸‹æ‰€æœ‰å­èŠ‚ç‚¹åˆ—è¡¨ï¼Œé€‰æ‹© server æœåŠ¡</li></ul><h2 id="ISSUE"><a href="#ISSUE" class="headerlink" title="ISSUE"></a>ISSUE</h2><p><strong>New in 3.6.0:</strong> Clients can also set permanent, recursive watches on a znode that are not removed when triggered and that trigger for changes on the registered znode as well as any children znodes recursively.</p><p>3.6.0 å·²ç»å¼€å§‹æ”¯æŒæ°¸ä¹…çš„ watch äº†</p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="http://zookeeper.apache.org/doc/r3.6.0/index.html" target="_blank" rel="noopener">ZooKeeper å®˜æ–¹æ–‡æ¡£ r3.6.0</a></p><p><a href="https://github.com/apache/zookeeper" target="_blank" rel="noopener">GITHUB</a></p><p><a href="http://dubbo.apache.org/zh-cn/docs/user/references/registry/zookeeper.html" target="_blank" rel="noopener">Dubbo ZooKeeper Registry</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> middlewares </category>
          
      </categories>
      
      
        <tags>
            
            <tag> zookeeper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Part 0 -- PAXOS</title>
      <link href="/zookeeper/paxos/"/>
      <url>/zookeeper/paxos/</url>
      
        <content type="html"><![CDATA[<h1 id="ZooKeeper-lt-é›¶-gt-Paxos-ç®—æ³•æµ…æ"><a href="#ZooKeeper-lt-é›¶-gt-Paxos-ç®—æ³•æµ…æ" class="headerlink" title="ZooKeeper<é›¶> Paxos ç®—æ³•æµ…æ"></a>ZooKeeper&lt;é›¶&gt; Paxos ç®—æ³•æµ…æ</h1><p>æœ¬æ–‡åŸºäº <a href="https://zh.wikipedia.org/wiki/Paxos%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">Wiki Paxos ç®—æ³•</a> æˆæ–‡</p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Paxos ç®—æ³•ç”± Lamport å¤§ç¥äº 1990 å¹´æå‡ºçš„ä¸€ç§åŸºäºæ¶ˆæ¯ä¼ é€’ä¸”å…·æœ‰é«˜åº¦å®¹é”™ç‰¹æ€§çš„å…±è¯†ç®—æ³•ã€‚</p><p>Mike Burrows(Google Chubby ä½œè€…)æ›¾è¯´è¿‡ï¼š</p><blockquote><p>there is only one consensus protocol, and thatâ€™s Paxos</p></blockquote><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒèŠ‚ç‚¹é€šä¿¡åˆ†ä¸ºä¸¤ç§æ¨¡å‹</p><ul><li>å…±äº«å†…å­˜</li><li>æ¶ˆæ¯ä¼ é€’</li></ul><p>åŸºäºæ¶ˆæ¯ä¼ é€’æ¨¡å‹çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå¿…ç„¶éœ€è¦è€ƒè™‘å¦‚ä¸‹é—®é¢˜</p><ul><li>æ¶ˆæ¯ä¸¢å¤±</li><li>æ¶ˆæ¯é‡å¤</li><li>æ¶ˆæ¯å»¶è¿Ÿ</li><li>â€¦</li></ul><p>åœ¨ä¸è€ƒè™‘æ‹œå åº­é”™è¯¯çš„æƒ…å†µä¸‹ï¼ŒPaxos ç®—æ³•è§£å†³çš„é—®é¢˜å°±æ˜¯</p><blockquote><p>åœ¨ä¸€ä¸ªå¯èƒ½å‘ç”Ÿä¸Šè¿°å¼‚å¸¸çš„åˆ†å¸ƒå¼åœºæ™¯ä¸­ï¼Œå¦‚ä½•å°±æŸä¸€ä¸ªå€¼è¾¾æˆä¸€è‡´ï¼Œ</p><p>ä¿è¯ä¸è®ºå‘ç”Ÿä»¥ä¸Šä»»ä½•å¼‚å¸¸ï¼Œéƒ½ä¸ä¼šç ´åå†³è®®çš„å…±è¯†ã€‚</p><p>å¦‚åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œè‹¥å„èŠ‚ç‚¹åˆå§‹çŠ¶æ€ä¸€è‡´ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ‰§è¡Œç›¸åŒçš„</p><p>æ“ä½œåºåˆ—ï¼Œé‚£ä¹ˆæœ€åèƒ½å¾—åˆ°ä¸€ä¸ªä¸€è‡´çš„çŠ¶æ€ã€‚</p><p>ä¸ºä¿è¯æ¯ä¸ªèŠ‚ç‚¹æ‰§è¡Œç›¸åŒçš„å‘½ä»¤åºåˆ—ï¼Œéœ€è¦åœ¨æ¯ä¸€æ¡æŒ‡ä»¤ä¸Šæ‰§è¡Œä¸€ä¸ªâ€œå…±è¯†ç®—æ³•â€</p><p> â€“  <a href="https://zh.wikipedia.org/wiki/Paxosç®—æ³•" target="_blank" rel="noopener">WIKI Paxos ç®—æ³•</a></p></blockquote><h2 id="è§’è‰²"><a href="#è§’è‰²" class="headerlink" title="è§’è‰²"></a>è§’è‰²</h2><p>åœ¨ Paxos ç®—æ³•ä¸­ï¼Œè§’è‰²ï¼š</p><ul><li>proposer : è´Ÿè´£æå‡ºææ¡ˆï¼Œç›¸å½“äº zk ä¸­çš„ leader</li><li>acceptorï¼š è´Ÿè´£æ¥å—ææ¡ˆï¼Œç›¸å½“äº zk ä¸­çš„ follower</li><li>learnerï¼šè´Ÿè´£å­¦ä¹ ææ¡ˆï¼Œç›¸å½“äº zk ä¸­çš„ learner</li></ul><p>åœ¨å…·ä½“çš„å®ç°ä¸­ï¼Œä¸€ä¸ªè¿›ç¨‹å¯èƒ½ä¸æ­¢å……å½“ä¸€ç§è§’è‰²</p><p>æœ¬æ–‡ä¸­ä½¿ç”¨çš„åè¯ï¼š</p><ul><li><p>quorumï¼š è¶…è¿‡åŠæ•°çš„ acceptor ç»„æˆçš„é›†åˆ(æœ€æ—©ç§°ä¹‹ä¸º majorityï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨ quorun)</p></li><li><p>proposalï¼š ææ¡ˆï¼Œç”± proposal æå‡ºï¼ŒåŒ…å«ç¼–å·å’Œå€¼ï¼š proposal(n,v)</p></li><li><p>valueï¼šå†³è®®ï¼Œè¢«æ‰¹å‡†çš„ææ¡ˆï¼ŒåŒæ ·åŒ…æ‹¬ç¼–å·å’Œå€¼ï¼švalue(n,v)</p></li></ul><h2 id="åŸºå‡†çº¦æŸ"><a href="#åŸºå‡†çº¦æŸ" class="headerlink" title="åŸºå‡†çº¦æŸ"></a>åŸºå‡†çº¦æŸ</h2><p>é¦–å…ˆç”± proposer æå‡º proposal(n,v)ï¼Œacceptor æ¥åˆ°ææ¡ˆåï¼Œå¯ä»¥é€‰æ‹©æ¥å—ææ¡ˆï¼Œå½“è¯¥ proposal è·å¾—äº† quorum (å¤§å¤šæ•° acceptor)çš„æ”¯æŒåï¼Œåˆ™è¯¥ proposal è¢«æ‰¹å‡†(chosen)ï¼Œæˆä¸º valueï¼Œç”± learner è¿›è¡Œå­¦ä¹ ã€‚</p><p>é‚£ä¹ˆï¼Œ Paxos è¦è§£å†³çš„é—®é¢˜å¯ä»¥å½’çº³ä¸ºï¼š</p><ul><li>åªæœ‰è¢« proposer æå‡ºçš„ææ¡ˆ(proposal)æ‰èƒ½è¢«é€‰å®š</li><li>ä¸€æ¬¡ Paxos æ‰§è¡Œï¼Œåªèƒ½æœ‰ä¸€ä¸ªå€¼(v)è¢«é€‰å®š</li><li>learner åªèƒ½è·å¾—è¢«æ‰¹å‡†çš„ææ¡ˆ(value)</li></ul><h2 id="æ¨å¯¼"><a href="#æ¨å¯¼" class="headerlink" title="æ¨å¯¼"></a>æ¨å¯¼</h2><p>Lamport å¤§ç¥é€šè¿‡ä¸æ–­åŠ å¼ºä¸Šè¿°çš„ä¸‰ä¸ªçº¦æŸ(ä¸»è¦æ˜¯ç¬¬äºŒä¸ªçº¦æŸ)ï¼Œè·å¾—äº† Paxos ç®—æ³•ã€‚</p><h3 id="1-P1"><a href="#1-P1" class="headerlink" title="1. P1"></a>1. P1</h3><p>å½“åªæœ‰ä¸€ä¸ª acceptor å­˜åœ¨æ—¶ï¼Œacceptor ä¼šé€‰æ‹©å®ƒæ”¶åˆ°çš„ç¬¬ä¸€ä¸ª proposal ä½œä¸º value(é€‰å®šçš„ææ¡ˆ)ï¼Œææ¡ˆæµç¨‹ç»“æŸã€‚</p><p>ç„¶è€Œï¼Œä¸€ä¸ª acceptor ä¼šå¯¼è‡´å•ç‚¹é—®é¢˜ï¼Œå³è¿™ä¸ª acceptor æŒ‚æ‰åï¼Œæ•´ä¸ªåˆ†å¸ƒå¼é›†ç¾¤å°±æ— æ³•å·¥ä½œ(zk é€šè¿‡ ZAB åè®®è§£å†³äº†å•ç‚¹é—®é¢˜ï¼Œä¸è¿‡åœ¨é€‰ä¸¾çš„è¿‡ç¨‹ä¸­ï¼Œä»ç„¶æ˜¯å¤š acceptor)ã€‚</p><p>å¤š acceptor æ—¶ï¼Œ proposer å‘ acceptor é›†åˆ (acceptors) å‘é€ proposalï¼Œå½“æœ‰è¶³å¤Ÿå¤šçš„ acceptor æ¥å—æ—¶ï¼Œè¿™ä¸ª proposal å°±è¢«é€‰å®šï¼Œæˆä¸ºå†³è®®(value)ã€‚</p><p>è¿™é‡Œçš„è¶³å¤Ÿå¤šï¼Œæˆ‘ä»¬è®¤ä¸ºæ˜¯è¶…è¿‡åŠæ•°çš„ acceptor ï¼Œäº¦å³å‰æ–‡çš„ quorunã€‚</p><p>å› ä¸ºä¸¤ç»„ quorumï¼Œå¿…ç„¶è‡³å°‘åŒ…å«åŒä¸€ä¸ª acceptorï¼Œ å¦‚æœä¸€ä¸ª acceptor æœ€å¤šåªèƒ½é€šè¿‡ä¸€ä¸ªææ¡ˆï¼Œé‚£ä¹ˆå°±èƒ½ä¿è¯æœ€ç»ˆåªæœ‰ä¸€ä¸ªææ¡ˆè¢«é€‰å®šã€‚</p><p>æˆ‘ä»¬å¸Œæœ›åœ¨å³ä½¿åªæœ‰ä¸€ä¸ªææ¡ˆè¢«æå‡ºçš„æƒ…å†µä¸‹ï¼Œä»ç„¶èƒ½äº§ç”Ÿ valueï¼Œç”±æ­¤æˆ‘ä»¬å¾—åˆ° P1:</p><blockquote><p><strong>P1: ä¸€ä¸ª acceptor å¿…é¡»æ¥å—å®ƒç¬¬ä¸€æ¬¡æ”¶åˆ°çš„ææ¡ˆ</strong></p></blockquote><p>æ³¨æ„ï¼Œè¿™é‡Œçš„ P1 æ˜¯ä¸å®Œå¤‡çš„ã€‚å½“ acceptor ä¸ªæ•°ä¸ºå¶æ•°ï¼Œåˆæ°å¥½ä¸€åŠ acceptor æ¥å— A æè®®ï¼Œå¦ä¸€åŠæ¥å— B æè®®æ—¶ï¼Œæ­¤æ—¶æ— æ³•äº§ç”Ÿå†³è®®ã€‚</p><p>ææ¡ˆè¢«é€‰å®šéœ€è¦åŠæ•°ä»¥ä¸Š acceptor é€šè¿‡ï¼Œæ„å‘³ç€ï¼Œä¸€ä¸ª acceptor å¿…é¡»èƒ½é€šè¿‡ä¸æ­¢ä¸€ä¸ªææ¡ˆã€‚å½“ä¸€ä¸ªå…·æœ‰ v å€¼çš„ææ¡ˆè¢« quorum é€šè¿‡ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºææ¡ˆè¢«é€‰å®šã€‚</p><h3 id="2-P2"><a href="#2-P2" class="headerlink" title="2. P2"></a>2. P2</h3><p>æˆ‘ä»¬åŸºäºä¸Šæ–‡ä»¥åŠåŸºå‡†çº¦æŸ 2ï¼š</p><blockquote><p>ä¸€æ¬¡ Paxos æ‰§è¡Œï¼Œåªèƒ½æœ‰ä¸€ä¸ªå€¼(v)è¢«é€‰å®š</p></blockquote><p>å¯ä»¥çœ‹åˆ°ï¼Œ Paxos å¹¶ä¸è¦æ±‚åªæ‰¹å‡†ä¸€ä¸ª proposalï¼Œä¹Ÿå°±æ˜¯è¯´å¯èƒ½ä¼šæ‰¹å‡†å¤šä¸ªææ¡ˆã€‚åªè¦ææ¡ˆçš„å€¼ï¼Œå³ proposal.v ä¸€è‡´ï¼Œå°±ä¸è¿èƒŒåŸºå‡†çº¦æŸ 2 ï¼Œäºæ˜¯æˆ‘ä»¬å¾—å‡º</p><blockquote><p><strong>P2: ä¸€æ—¦ä¸€ä¸ªå…·æœ‰ v å€¼çš„ææ¡ˆ proposal(n,v) è¢«æ‰¹å‡†ï¼Œåˆ™ä¹‹åæ‰¹å‡†çš„ææ¡ˆå¿…é¡»å…·æœ‰ v å€¼</strong></p></blockquote><p>è¿™é‡Œçš„ä¹‹åï¼Œä¸€èˆ¬éƒ½æ˜¯é€šè¿‡ä¸€ä¸ªå…¨å±€åºå·(zk ä¸­æŒ‡ zxid)ï¼Œæ¥è¿›è¡Œåˆ¤æ–­</p><h3 id="3-P2a"><a href="#3-P2a" class="headerlink" title="3. P2a"></a>3. P2a</h3><p>æ‰¹å‡†ä¸€ä¸ª valueï¼Œæ„å‘³ç€å¤šä¸ª acceptor æ¥å—äº†è¿™ä¸ª valueï¼Œå› æ­¤å¯ä»¥å¯¹ P2 è¿›è¡ŒåŠ å¼ºï¼š</p><blockquote><p>P2aï¼šä¸€æ—¦ä¸€ä¸ª proposal(n,v) è¢«æ‰¹å‡†ï¼Œåˆ™ä¹‹åä»»ä½• acceptor å†æ¬¡æ¥å—çš„ææ¡ˆï¼Œå¿…é¡»ä¹Ÿå…·æœ‰ v å€¼</p></blockquote><p>æ»¡è¶³ P2a ,å³æ»¡è¶³ P2</p><p>ä½†æ˜¯ç”±äºé€šä¿¡æ˜¯å¼‚æ­¥çš„ï¼Œå½“å·²ç»äº§ç”Ÿ value åï¼Œä¸€ä¸ª proposer å’Œ acceptor åˆšè‹é†’ï¼Œè€Œè¿™ä¸ª proposer æå‡ºäº†ä¸€ä¸ªæ–°çš„ proposal(n1,v1) ææ¡ˆï¼Œæ ¹æ® P1 ï¼Œè¿™ä¸ª acceptor åº”è¯¥æ¥å—ï¼Œä½†æ ¹æ® P2aï¼Œåˆä¸åº”è¯¥æ¥å—ï¼æ€ä¹ˆåŠï¼Ÿ</p><h3 id="4-P2b"><a href="#4-P2b" class="headerlink" title="4. P2b"></a>4. P2b</h3><p>æˆ‘ä»¬æƒ³åˆ°åœ¨ proposer ç«¯è¿›è¡Œé™åˆ¶ï¼š</p><blockquote><p>P2bï¼šä¸€æ—¦ä¸€ä¸ª proposal(n,v) è¢«æ‰¹å‡†ï¼Œåˆ™ä¹‹åä»»ä½• proposer æå‡ºçš„ææ¡ˆï¼Œå¿…é¡»å…·æœ‰ v å€¼</p></blockquote><p>ä¸€ä¸ªææ¡ˆè¢« acceptor æ¥å—å‰ï¼Œéœ€è¦ç”± proposer æå‡ºï¼Œå› æ­¤ï¼Œ æ»¡è¶³ P2b ==&gt; P2a ==&gt; P2</p><p>å¦‚ä½•ä¿è¯ P2b å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å‡è®¾ proposal(m,v) ææ¡ˆè¢«é€‰å®šï¼Œæ ¹æ® P2bï¼Œ åˆ™æœ‰ proposal(n,vâ€™)ï¼Œå½“ n &gt; m æ—¶ï¼Œ vâ€™ = v .</p><p>é‚£ä¹ˆï¼Œå¦‚ä½•æ¥ä¿è¯ vâ€™ = v å‘¢ï¼Ÿ</p><h3 id="5-P2c"><a href="#5-P2c" class="headerlink" title="5. P2c"></a>5. P2c</h3><blockquote><p>P2cï¼šè‹¥ proposal(n,v) è¢«æå‡ºï¼Œåˆ™å­˜åœ¨ä¸€ä¸ª quorum æ»¡è¶³ä»¥ä¸‹ä¸­çš„ä»»ä¸€æ¡ä»¶ï¼š</p><p>â€‹    a)  quorum ä¸­æ‰€æœ‰ acceptor éƒ½æœªæ¥å—ç¼–å·å°äº n çš„ææ¡ˆ</p><p>â€‹    b)  quorum ä¸­æ‰€æœ‰ acceptor å·²ç»æ¥å—æ‰€æœ‰ç¼–å·å°äº n çš„ææ¡ˆä¸­ï¼Œæœ€å¤§çš„é‚£ä¸ªææ¡ˆ v å€¼</p></blockquote><p>è¯æ˜è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><blockquote><p>å‡è®¾å…·æœ‰value vçš„ææ¡ˆmè·å¾—æ‰¹å‡†ï¼Œå½“n=m+1æ—¶ï¼Œé‡‡ç”¨åè¯æ³•ï¼Œå‡å¦‚ææ¡ˆnä¸å…·æœ‰value vï¼Œè€Œæ˜¯å…·æœ‰value wï¼Œæ ¹æ®P2cï¼Œåˆ™å­˜åœ¨ä¸€ä¸ªå¤šæ•°æ´¾S1ï¼Œè¦ä¹ˆä»–ä»¬ä¸­æ²¡æœ‰äººæ¥å—è¿‡ç¼–å·å°äºnçš„ä»»ä½•ææ¡ˆï¼Œè¦ä¹ˆä»–ä»¬å·²ç»æ¥å—çš„æ‰€æœ‰ç¼–å·å°äºnçš„ææ¡ˆä¸­ç¼–å·æœ€å¤§çš„é‚£ä¸ªææ¡ˆæ˜¯value wã€‚ç”±äºS1å’Œé€šè¿‡ææ¡ˆmæ—¶çš„å¤šæ•°æ´¾Cä¹‹é—´è‡³å°‘æœ‰ä¸€ä¸ªå…¬å…±çš„acceptorï¼Œæ‰€ä»¥ä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶éƒ½ä¸æˆç«‹ï¼Œå¯¼å‡ºçŸ›ç›¾ä»è€Œæ¨ç¿»å‡è®¾ï¼Œè¯æ˜äº†ææ¡ˆnå¿…é¡»å…·æœ‰value vï¼›</p><p>è‹¥ï¼ˆm+1ï¼‰..ï¼ˆN-1ï¼‰æ‰€æœ‰ææ¡ˆéƒ½å…·æœ‰value vï¼Œé‡‡ç”¨åè¯æ³•ï¼Œå‡å¦‚æ–°ææ¡ˆNä¸å…·æœ‰value vï¼Œè€Œæ˜¯å…·æœ‰value wâ€™,æ ¹æ®P2cï¼Œåˆ™å­˜åœ¨ä¸€ä¸ªå¤šæ•°æ´¾S2ï¼Œè¦ä¹ˆä»–ä»¬æ²¡æœ‰æ¥å—è¿‡m..ï¼ˆN-1ï¼‰ä¸­çš„ä»»ä½•ææ¡ˆï¼Œè¦ä¹ˆä»–ä»¬å·²ç»æ¥å—çš„æ‰€æœ‰ç¼–å·å°äºNçš„ææ¡ˆä¸­ç¼–å·æœ€å¤§çš„é‚£ä¸ªææ¡ˆæ˜¯value wâ€™ã€‚ç”±äºS2å’Œé€šè¿‡mçš„å¤šæ•°æ´¾Cä¹‹é—´è‡³å°‘æœ‰ä¸€ä¸ªå…¬å…±çš„acceptorï¼Œæ‰€ä»¥è‡³å°‘æœ‰ä¸€ä¸ªacceptoræ›¾ç»æ¥å—äº†mï¼Œä»è€Œä¹Ÿå¯ä»¥æ¨å‡ºS2ä¸­å·²æ¥å—çš„æ‰€æœ‰ç¼–å·å°äºnçš„ææ¡ˆä¸­ç¼–å·æœ€å¤§çš„é‚£ä¸ªææ¡ˆçš„ç¼–å·èŒƒå›´åœ¨m..ï¼ˆN-1ï¼‰ä¹‹é—´ï¼Œè€Œæ ¹æ®åˆå§‹å‡è®¾ï¼Œm..ï¼ˆN-1ï¼‰ä¹‹é—´çš„æ‰€æœ‰ææ¡ˆéƒ½å…·æœ‰value vï¼Œæ‰€ä»¥S2ä¸­å·²æ¥å—çš„æ‰€æœ‰ç¼–å·å°äºnçš„ææ¡ˆä¸­ç¼–å·æœ€å¤§çš„é‚£ä¸ªææ¡ˆè‚¯å®šå…·æœ‰value vï¼Œå¯¼å‡ºçŸ›ç›¾ä»è€Œæ¨ç¿»æ–°ææ¡ˆnä¸å…·æœ‰value vçš„å‡è®¾ã€‚æ ¹æ®æ•°å­¦å½’çº³æ³•ï¼Œæˆ‘ä»¬è¯æ˜äº†è‹¥æ»¡è¶³P2cï¼Œåˆ™P2bä¸€å®šæ»¡è¶³ã€‚</p><p>â€”- <a href="https://zh.wikipedia.org/wiki/Paxos%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">WIKI</a></p></blockquote><p>ä¸ºäº†ç»´æŠ¤ P2c çš„ä¸å˜æ€§ï¼Œå½“ä¸€ä¸ª proposer æå‡º proposal(n,v) æ—¶ï¼Œå¿…é¡»è¦çŸ¥é“æŸä¸€ä¸ªå°†è¦æˆ–è€…å·²ç»è¢« quorum é€šè¿‡çš„ç¼–å·å°äº n çš„æœ€å¤§ç¼–å·çš„ææ¡ˆå€¼ã€‚</p><p>æˆ‘ä»¬éœ€è¦é™å®šã€Œå°†è¦é€šè¿‡ã€çš„æƒ…å†µï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ— æ³•é¢„æµ‹æœªæ¥ã€‚è¿™è¡¨ç¤ºï¼Œproposer ä¼šè¯·æ±‚ acceptor ä¸å†æ¥å—ä»»ä½•ç¼–å·å°äº n çš„ææ¡ˆã€‚</p><h3 id="6-ç®—æ³•"><a href="#6-ç®—æ³•" class="headerlink" title="6. ç®—æ³•"></a>6. ç®—æ³•</h3><p>ä¸Šé¢çš„åˆ†æï¼Œå¯ä»¥æ¨å‡ºå¦‚ä¸‹ç®—æ³•ï¼š</p><h4 id="1-Proposer"><a href="#1-Proposer" class="headerlink" title="1. Proposer"></a>1. Proposer</h4><h5 id="1-1-prepare"><a href="#1-1-prepare" class="headerlink" title="1.1 prepare"></a>1.1 prepare</h5><ul><li>proposer æäº¤ proposal(n,v) ç»™ acceptors</li><li>proposer è¦æ±‚ acceptor åšå‡ºå¦‚ä¸‹æ‰¿è¯ºï¼š<ul><li>ä¿è¯ä¸å†é€šè¿‡ä»»ä½•å°äºç¼–å· n çš„ææ¡ˆ</li><li>å¦‚æœå­˜åœ¨å·²é€šè¿‡çš„ç¼–å·å°äº n çš„ææ¡ˆï¼Œå°†é€šè¿‡çš„å°äº n çš„æœ€å¤§ç¼–å·ææ¡ˆè¿”å›</li></ul></li></ul><h5 id="1-2-commit-propose"><a href="#1-2-commit-propose" class="headerlink" title="1.2 commit/propose"></a>1.2 commit/propose</h5><ul><li>æ”¶åˆ°è¶…è¿‡åŠæ•°çš„ ack å›å¤ï¼Œåˆ™äº§ç”Ÿ proposal(n, v)ï¼Œè¿™é‡Œçš„ v æ˜¯æ‰€æœ‰å“åº”ä¸­ç¼–å·æœ€å¤§çš„ææ¡ˆçš„ v å€¼ï¼Œè‹¥å“åº”ä¸­ä¸åŒ…å«ï¼Œåˆ™ç”± proposer è‡ªå·±é€‰æ‹©</li></ul><h4 id="2-Acceptor"><a href="#2-Acceptor" class="headerlink" title="2. Acceptor"></a>2. Acceptor</h4><blockquote><p>P1aï¼š acceptor å¯ä»¥æ¥å—ä¸€ä¸ªç¼–å·ä¸º n çš„ææ¡ˆï¼Œåªè¦å®ƒè¿˜æœªå“åº”ä»»ä½•ç¼–å·å¤§äº n çš„ prepare è¯·æ±‚</p></blockquote><p>å¯ä»¥çœ‹å‡ºï¼š P1a è•´æ¶µ P1</p><h5 id="2-1-prepare"><a href="#2-1-prepare" class="headerlink" title="2.1 prepare"></a>2.1 prepare</h5><ul><li>æ”¶åˆ° propser çš„ prepare(n.v) è¯·æ±‚ï¼Œå¦‚æœç¼–å· n &gt; æ‰€æœ‰å“åº”ä¸­æœ€å¤§çš„ææ¡ˆç¼–å·ï¼Œè¿”å›å·²ç»é€šè¿‡çš„æœ€å¤§ç¼–å·çš„ææ¡ˆ(æ²¡æœ‰å¯ä»¥è¿”å› nil)</li></ul><h5 id="2-2-commit-accept"><a href="#2-2-commit-accept" class="headerlink" title="2.2 commit/accept"></a>2.2 commit/accept</h5><ul><li>æ”¶åˆ° proposer çš„ accept è¯·æ±‚åï¼Œå¦‚æœæ²¡æœ‰å¯¹ç¼–å·å¤§äº n çš„ prepare è¯·æ±‚åšå‡ºè¿‡å“åº”ï¼Œå°±æ¥å—è¿™ä¸ªææ¡ˆ</li></ul><h4 id="3-æ•´ä½“æè¿°"><a href="#3-æ•´ä½“æè¿°" class="headerlink" title="3. æ•´ä½“æè¿°"></a>3. æ•´ä½“æè¿°</h4><h5 id="3-1-prepare-é˜¶æ®µï¼š"><a href="#3-1-prepare-é˜¶æ®µï¼š" class="headerlink" title="3.1 prepare é˜¶æ®µï¼š"></a>3.1 prepare é˜¶æ®µï¼š</h5><ul><li>proposer  å‘é€ prepare(n,v) ç»™ acceptors</li><li>acceptor æ”¶åˆ° prepare(n,v) åï¼Œå¦‚æœ n å¤§äºå®ƒå·²ç»å“åº”çš„æ‰€æœ‰ prepare è¯·æ±‚ç¼–å·ï¼Œ åˆ™ä¿è¯ä¸å† <font color="#ff0000">accept</font> ä»»ä½•ç¼–å·å°äº n çš„ææ¡ˆï¼ŒåŒæ—¶å°†å·²ç»é€šè¿‡çš„æœ€å¤§ç¼–å·çš„ææ¡ˆ(å¦‚æœå­˜åœ¨)å›å¤ã€‚(è¿™é‡Œå·²ç»é€šè¿‡ï¼ŒæŒ‡çš„æ˜¯è¯¥ acceptor æ¥å—çš„ææ¡ˆï¼Œè€Œä¸æ˜¯ prepare å“åº”çš„ææ¡ˆ)</li></ul><h5 id="3-2-propose-é˜¶æ®µï¼š"><a href="#3-2-propose-é˜¶æ®µï¼š" class="headerlink" title="3.2 propose é˜¶æ®µï¼š"></a>3.2 propose é˜¶æ®µï¼š</h5><ul><li>proposer åœ¨æ”¶åˆ°å¤§å¤šæ•° acceptors çš„å›å¤åï¼Œæ ¹æ®å›å¤ï¼Œè·å–å›å¤ä¸­ç¼–å·æœ€å¤§çš„ value(å¦‚æœæ‰€æœ‰å›å¤ä¸­ï¼Œéƒ½æ²¡æœ‰ï¼Œåˆ™ value å¯è‡ªè¡Œç¡®å®š)ï¼Œå‘ acceptors å‘é€ accept(n,v) è¯·æ±‚</li><li>åœ¨ä¸è¿èƒŒ acceptor å¯¹å…¶ä»– proposer çš„æ‰¿è¯ºä¸‹ï¼Œacceptor æ¥å—è¿™ä¸ªææ¡ˆï¼Œå¦åˆ™æ‹’ç»ã€‚æ¢å¥è¯è¯´ï¼Œå³ å¦‚æœ acceptor æ”¶åˆ°ä¸€ä¸ªé’ˆå¯¹ç¼–å· n çš„ææ¡ˆçš„ accept è¯·æ±‚ï¼Œ<strong>åªè¦å®ƒè¿˜æœªå¯¹ç¼–å·å¤§äº n çš„ prepare è¯·æ±‚ä½œå‡ºå“åº”ï¼Œå®ƒå°±å¯ä»¥é€šè¿‡è¿™ä¸ªææ¡ˆ</strong>ã€‚</li></ul><h3 id="7-æµç¨‹å›¾"><a href="#7-æµç¨‹å›¾" class="headerlink" title="7. æµç¨‹å›¾"></a>7. æµç¨‹å›¾</h3><p>æˆ‘ä»¬ä»¥ä¸¤ä¸ª proposer å’Œ 3 ä¸ª acceptor ä¸ºä¾‹ã€‚</p><p>prepare é˜¶æ®µï¼Œä¸»è¦æœ‰ä¸¤ä¸ªæ–¹æ³•</p><ul><li>prepare(n, expected_v) ï¼š ç”± proposer å‘èµ·ä¸€ä¸ªç¼–å·ä¸º nï¼Œå€¼ä¸º expected_v çš„è¯·æ±‚</li><li>promise(ack, accepted_n, accepted_v)ï¼šç”± acceptor è¿”å›ï¼Œack ä¸ºåº”ç­”ï¼Œaccepted_n ä¸º acceptor å·²ç»é€šè¿‡ææ¡ˆçš„æœ€å¤§ç¼–å·ï¼Œaccepted_v ä¸ºå¯¹åº”çš„å€¼ï¼Œæ²¡æœ‰åˆ™ä¸º nil</li></ul><p>accept/propose é˜¶æ®µï¼Œä¹Ÿæ˜¯ä¸¤ä¸ªæ–¹æ³•</p><ul><li>propose(nï¼Œexpected_v)ï¼šåœ¨è¯¥ proposer æ”¶åˆ°è¶…è¿‡åŠæ•° ack åï¼Œå‘èµ· propose(n,expected_v) è¯·æ±‚ï¼Œexpected_v ä¸ºæ”¶åˆ°çš„åº”ç­”ä¸­ï¼Œæœ€å¤§ç¼–å·çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±æ˜¯è‡ªå·±çš„å€¼</li><li>accept(ack, error)ï¼š åœ¨ä¸è¿èƒŒå¯¹å…¶ä»– proposer çš„æ‰¿è¯ºä¸‹ï¼Œacceptor æ¥å—è¿™ä¸ªææ¡ˆï¼Œè¿”å›(ack, nil)ï¼Œ å¦åˆ™è¿”å› (ack, error)</li></ul><p><em>æ³¨</em> ï¼š è¿™é‡Œ<em>ä¸è¿èƒŒå¯¹å…¶ä»– proposer çš„æ‰¿è¯º</em>  ï¼ŒæŒ‡çš„æ˜¯</p><ul><li>ä¸å“åº”ç¼–å·æ¯” n å°çš„ææ¡ˆ</li><li>ä¸æ¥å—ç¼–å·æ¯” n å°çš„ææ¡ˆ</li></ul><p>WIKI ä¸­è¯´</p><blockquote><p>acceptor æ”¶åˆ° prepare æ¶ˆæ¯åï¼Œå¦‚æœææ¡ˆçš„ç¼–å·å¤§äºå®ƒå·²ç»å›å¤çš„æ‰€æœ‰ prepare æ¶ˆæ¯(å›å¤æ¶ˆæ¯è¡¨ç¤ºæ¥å—accept)ï¼Œåˆ™ acceptor å°†è‡ªå·±ä¸Šæ¬¡æ¥å—çš„ææ¡ˆå›å¤ç»™ proposerï¼Œå¹¶æ‰¿è¯ºä¸å†å›å¤å°äº n çš„ææ¡ˆ</p></blockquote><p>è¿™é‡Œçš„<strong>æ‰¿è¯ºä¸å†å›å¤å°äº n çš„ææ¡ˆ</strong> ï¼Œå³æŒ‡ä¸Šé¢çš„ä¸¤ä¸ªä¸ã€‚</p><p>åœ¨ acceptor æ”¶åˆ° accept è¯·æ±‚å‰ï¼Œå¦‚æœæ”¶åˆ°äº† prepare(n+1, vâ€™)ï¼Œé‚£ä¸ªè¿™ä¸ª accept è¯·æ±‚åˆ™ä¸ä¼šè¢«åº”ç­”ï¼Œæˆ–è€…è¿”å›ä¸€ä¸ª error</p><h4 id="prepare"><a href="#prepare" class="headerlink" title="prepare"></a>prepare</h4><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200402124723.png-growing" alt="prepare phrase"></p><p>P1 å’Œ P2 åˆ†åˆ«å‘ A1/A2, A2/A3 å‘é€ prepare è¯·æ±‚ï¼ŒA1/A3 éƒ½æ˜¯æ­£å¸¸åº”ç­”ï¼ŒåŒæ—¶å°†å„è‡ªçš„åº”ç­”è®°å½•ä¿®æ”¹ã€‚</p><p>A2 å…ˆæ”¶åˆ° P1 prepare è¯·æ±‚ï¼Œresponsed_n ç½®ä¸º 1ï¼Œ åŒæ—¶ç»™ä¸ P1 ackï¼Œ åæ”¶åˆ° P2 prepare(2, 2)ï¼Œæ ¹æ®è§„åˆ™ï¼ŒP2 çš„ææ¡ˆç¼–å· 2 å¤§äº P1 çš„ç¼–å· 1ï¼Œæ‰€ä»¥ï¼ŒA2 å°† responsed_n ç½®ä¸º 2ï¼Œ åŒæ—¶å›å¤ ackã€‚è¿™é‡Œ A2 åœ¨æ­¤ä¹‹å‰ï¼Œå¹¶æ²¡æœ‰æ‰¹å‡†ï¼Œå³ accept ä»»ä½•ææ¡ˆï¼Œæ‰€ä»¥å›å¤çš„ promise åº”è¯¥ä¸º promise(ack, nil, nil)</p><p>é‚£ä¹ˆæ­¤æ—¶ P1 å’Œ P2 éƒ½å¾—åˆ°äº†åŠæ•°ä»¥ä¸Šçš„ ack ï¼Œéƒ½å¯ä»¥è¿›è¡Œ accept è¯·æ±‚ã€‚</p><h4 id="propose-accept"><a href="#propose-accept" class="headerlink" title="propose/accept"></a>propose/accept</h4><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200402134022.png-growing" alt="accept phrase"></p><p>åœ¨ç¬¬äºŒé˜¶æ®µ</p><p>P1ï¼Œ å‘ A1, A2, A3 å‘èµ· propose(1, 1) è¯·æ±‚ï¼Œ å…¶ä¸­ï¼š</p><ul><li>A1ï¼š åœ¨ P2 å‘é€è¯·æ±‚ä¹‹å‰ï¼Œæ”¶åˆ°äº† P1 çš„ propose è¯·æ±‚ï¼Œåœ¨æ­¤ä¹‹å‰åªæ”¶åˆ°è¿‡ P1 çš„ prepare è¯·æ±‚ï¼Œæœªå¯¹ç¼–å·å¤§äº 1 çš„ prepare è¯·æ±‚åšå‡ºè¿‡å›åº”ï¼Œéµå®ˆæ‰¿è¯ºï¼Œæ¥å—äº† P1 çš„è¯·æ±‚ï¼Œå›å¤ ackï¼Œ accept(ack, nil, nil)</li><li>A2/A3ï¼šå·²ç»æ”¶åˆ°è¿‡ P2 çš„ prepare è¯·æ±‚ï¼Œä¸” P2 ç¼–å· 2ï¼Œ å¤§äº 1ï¼Œä¸å›å¤ P1 æˆ–å›å¤ error</li></ul><p>æ‰€ä»¥ P1 å¾—åˆ° A1 çš„ ack ï¼Œæœªè¶…è¿‡åŠæ•°</p><p>P2ï¼Œ å‘ A1ï¼Œ A3 å‘èµ· propose(2, 2) è¯·æ±‚ï¼Œå…¶ä¸­ï¼š</p><ul><li>A1ï¼š æœªä½œå‡ºè¿‡å¤§äº 2 çš„ prepare å“åº”ï¼Œæ¥å— P2 çš„è¯·æ±‚ï¼Œä¿®æ”¹ responsed_nï¼Œaccepted_n/v åŒæ—¶è¿”å› accept(ack)</li><li>A3ï¼šåŒæ ·æœªè¿èƒŒæ‰¿è¯ºï¼Œä¿®æ”¹ responsed_n, accepted_n/v ï¼Œ è¿”å› accept(ack)</li></ul><p>P2 æ”¶åˆ°åŠæ•°ä»¥ä¸Šçš„ ack ï¼Œææ¡ˆè¢«é€‰ä¸­ã€‚</p><p>ä¹‹å A1 å†æ¬¡å»å‘èµ·ææ¡ˆçš„æ—¶å€™ï¼Œæ­¤æ—¶ n ä¼šé€’å¢åˆ° 3ï¼Œåœ¨ prepare(3,1) é˜¶æ®µï¼Œä¼šæ”¶åˆ° A1ï¼ŒA3 çš„ ackï¼Œå½¢å¦‚ propose(ack, 2, 2)ï¼Œ A1 æ”¶åˆ°åŠæ•°è¯·æ±‚åï¼Œä»ä¸­æŒ‘å‡ºç¼–å·ä¸å¤§äº 3 çš„æœ€å¤§ç¼–å·ï¼ŒåŒæ—¶ä¿®æ”¹è‡ªå·±çš„å€¼ï¼Œ ä» 1 å˜ä¸º 2ï¼Œå†æ¬¡å‘é€ prepare(3,2)ï¼Œä¼šå¾—åˆ°è¶…è¿‡åŠæ•°çš„ ack ï¼Œ ææ¡ˆè¢«é€‰ä¸­ï¼Œç»“æŸã€‚</p><p>æœ¬è½® paxos ä¸­ï¼Œæœ€ç»ˆé€‰æ‹©çš„å€¼ä¸º 2</p><h3 id="8-Paxos-æ´»é”-LiveLock"><a href="#8-Paxos-æ´»é”-LiveLock" class="headerlink" title="8. Paxos  æ´»é”(LiveLock)"></a>8. Paxos  æ´»é”(LiveLock)</h3><p>æˆ‘ä»¬ä»¥ P1, P2 + A ä¸ºä¾‹</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200402140130.png-growing" alt="prepare phrase LiveLock"></p><p>å¦‚å›¾ç¤ºï¼Œæ¯æ¬¡ P1 æˆ– P2 propose æ—¶ï¼Œ æ€»æ˜¯ä¼šå‘ç°æ›´é«˜çš„ prepare ç¼–å·ï¼Œä»è€Œä¸æ–­è¿›è¡Œ prepare ã€‚</p><p>ä¸€èˆ¬è¿™ç§æƒ…å†µå¾ˆå°‘è§ï¼Œå¯ä»¥é€šè¿‡ <em>éšå³ç¡çœ -é‡è¯•</em> çš„æ–¹æ³•é¿å…</p><h2 id="Multi-Paxos"><a href="#Multi-Paxos" class="headerlink" title="Multi-Paxos"></a>Multi-Paxos</h2><h2 id="Fast-Paxos"><a href="#Fast-Paxos" class="headerlink" title="Fast-Paxos"></a>Fast-Paxos</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://zh.wikipedia.org/wiki/Paxos%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">WIKI Paxos ç®—æ³•</a></li><li><a href="https://github.com/oldratlee/translations/tree/master/paxos-made-simple" target="_blank" rel="noopener">Paxos Made Simple ç¿»è¯‘ç¨¿</a></li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> middlewares </category>
          
      </categories>
      
      
        <tags>
            
            <tag> algorithm </tag>
            
            <tag> zookeeper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Build Your Own Blog</title>
      <link href="/tools/blog/"/>
      <url>/tools/blog/</url>
      
        <content type="html"><![CDATA[<h1 id="hexo-æ­å»ºä¸ªäººåšå®¢"><a href="#hexo-æ­å»ºä¸ªäººåšå®¢" class="headerlink" title="hexo æ­å»ºä¸ªäººåšå®¢"></a>hexo æ­å»ºä¸ªäººåšå®¢</h1><ul><li><p><a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank" rel="noopener">hexo-theme-matery</a> </p></li><li><p><a href="https://github.com/blinkfox/hexo-theme-matery/blob/develop/README_CN.md" target="_blank" rel="noopener">README</a></p></li><li><p><a href="https://github.com/hexojs/hexo" target="_blank" rel="noopener">Hexo</a></p></li></ul><h2 id="BLOG-åœ°å€"><a href="#BLOG-åœ°å€" class="headerlink" title="BLOG åœ°å€"></a>BLOG åœ°å€</h2><p><a href="https://iyuhp.top">iyuhpâ€™s blog</a> </p><h2 id="åŸºæœ¬ä»‹ç»"><a href="#åŸºæœ¬ä»‹ç»" class="headerlink" title="åŸºæœ¬ä»‹ç»"></a>åŸºæœ¬ä»‹ç»</h2><p>æœ¬ blog ä½¿ç”¨ <a href="https://github.com/hexojs/hexo" target="_blank" rel="noopener">HEXO</a> æ­å»ºï¼Œ <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank" rel="noopener">MATERY</a> ä½œä¸ºä¸»é¢˜ï¼Œ nginx ä½œé™æ€ä»£ç†ï¼Œæ­é… HTTPS ä½¿ç”¨ã€‚</p><h2 id="æ­å»ºæ­¥éª¤"><a href="#æ­å»ºæ­¥éª¤" class="headerlink" title="æ­å»ºæ­¥éª¤"></a>æ­å»ºæ­¥éª¤</h2><h3 id="1-å®‰è£…-hexo-cli"><a href="#1-å®‰è£…-hexo-cli" class="headerlink" title="1. å®‰è£… hexo-cli"></a>1. å®‰è£… hexo-cli</h3><p>å®‰è£…ä¹‹å‰ï¼Œè¯·ç¡®è®¤æœ¬æœºå·²ç»æœ‰ node ç¯å¢ƒï¼Œå¯é€‰æ‹©å®‰è£… cnpmã€‚</p><pre class=" language-shell"><code class="language-shell">cnpm install -g hexo-cli</code></pre><h3 id="2-åˆå§‹åŒ–ä¸€ä¸ª-project"><a href="#2-åˆå§‹åŒ–ä¸€ä¸ª-project" class="headerlink" title="2. åˆå§‹åŒ–ä¸€ä¸ª project"></a>2. åˆå§‹åŒ–ä¸€ä¸ª project</h3><pre class=" language-shell"><code class="language-shell">hexo init blogcd blogcnpm i</code></pre><p>æ­¤æ—¶ï¼Œé€šè¿‡ <code>tree . -L 1</code> å‘½ä»¤æŸ¥çœ‹</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401073032.png-growing" alt="image-20200401073027300"></p><ul><li><p>_config.yml: ç½‘ç«™çš„é…ç½®ä¿¡æ¯ï¼Œ ç»å¤§éƒ¨åˆ†çš„é…ç½®ï¼Œéƒ½åœ¨è¿™é‡Œä¿®æ”¹ï¼Œè¿™é‡Œçš„é…ç½®æ˜¯ä½ è‡ªå·±çš„é…ç½®</p></li><li><p>scaffoldsï¼š æ¨¡æ¿æ–‡ä»¶å¤¹ï¼Œæ–°å»ºæ–‡ç« æ—¶ï¼Œ æ ¹æ®å…¶ä¸­çš„æ¨¡æ¿è¿›è¡Œå¡«å……ç›¸å…³å†…å®¹ï¼Œå¯ä»¥åœ¨ _config.yml ä¸­é…ç½®é€‰æ‹©ä½¿ç”¨å“ªç§æ¨¡æ¿</p></li><li><p>sourceï¼šç”¨æˆ·å­˜æ”¾èµ„æºçš„åœ°æ–¹ã€‚ é™¤  _posts æ–‡ä»¶å¤¹ä¹‹å¤–ï¼Œå¼€å¤´å‘½åä¸º _ (ä¸‹åˆ’çº¿)çš„æ–‡ä»¶ã€æ–‡ä»¶å¤¹å’Œéšè—çš„æ–‡ä»¶å°†ä¼šè¢«å¿½ç•¥ã€‚Markdown å’Œ HTML æ–‡ä»¶ä¼šè¢«è§£æå¹¶æ”¾åˆ° public æ–‡ä»¶å¤¹ï¼Œè€Œå…¶ä»–æ–‡ä»¶ä¼šè¢«æ‹·è´è¿‡å»</p></li><li><p>themesï¼šä¸»é¢˜æ–‡ä»¶å¤¹ï¼Œ hexo æ ¹æ®ä¸»é¢˜æ¥ç”Ÿæˆé™æ€é¡µé¢ï¼Œä¸»é¢˜ç›®ä¸­ä¹Ÿä¼šæœ‰ä¸€ä¸ª _config.yml é…ç½®æ–‡ä»¶ï¼Œæ˜¯å…³äºä¸»é¢˜çš„é…ç½®</p></li></ul><h3 id="3-ä½¿ç”¨ä¸»é¢˜"><a href="#3-ä½¿ç”¨ä¸»é¢˜" class="headerlink" title="3. ä½¿ç”¨ä¸»é¢˜"></a>3. ä½¿ç”¨ä¸»é¢˜</h3><p>å…³äº matery ä¸»é¢˜çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒ <a href="https://github.com/blinkfox/hexo-theme-matery/blob/develop/README_CN.md" target="_blank" rel="noopener">è¿™é‡Œ</a> ã€‚</p><p>æˆ‘ä»¬æŠŠä¸‹è½½ä¸‹æ¥çš„ç¨³å®šç‰ˆæœ¬ copy åˆ° themes ç›®å½•ä¸‹ï¼Œç„¶ååœ¨ _config.yml ä¸­æŒ‡å®šä¸»é¢˜ä¸º <code>hexo-theme-matery</code> , åŒæ—¶å‚è€ƒ matery æ–‡æ¡£ï¼Œå®Œæˆå…¶ä»–é…ç½®åï¼Œæ‰§è¡Œ <code>hexo s</code> æœ¬åœ°å¯åŠ¨åï¼ŒæŸ¥çœ‹æ•ˆæœã€‚</p><p>ä½¿ç”¨ä¸»é¢˜çš„æ–¹å¼æœ‰ï¼š</p><ol><li><p>ç›´æ¥ä¸‹è½½åæ·»åŠ </p></li><li><p>æˆ–è€… git clone åˆ° theme ç›®å½•ä¸‹</p></li><li><p>æˆ–è€… é€šè¿‡ git submodule</p><pre class=" language-shell"><code class="language-shell">git submodule add https://github.com/blinkfox/hexo-theme-matery.git themes/hexo-theme-matery</code></pre></li></ol><h3 id="4-æ–°å»ºæ–‡ç« "><a href="#4-æ–°å»ºæ–‡ç« " class="headerlink" title="4. æ–°å»ºæ–‡ç« "></a>4. æ–°å»ºæ–‡ç« </h3><p>åœ¨ <a href="https://hexo.io/zh-cn/docs/configuration" target="_blank" rel="noopener">è¿™é‡Œ</a> å¯ä»¥æŸ¥çœ‹åˆ°å…³äº hexo çš„å„ç§å‘½ä»¤ã€‚</p><p>ä½¿ç”¨ *<em><code>hexo new --path folder/article "Oh Beautiful"</code> *</em>ï¼Œä¼šåœ¨å½“å‰ source/_post ç›®å½•ä¸‹(è¿™é‡Œæ ¹æ®ä½ é…ç½®é‡Œçš„ default_layoutï¼Œä¼šåœ¨å¯¹åº”çš„ç›®å½•ä¸‹æ–°å»º)æ–°å»ºä¸€ä¸ª folder ç›®å½•ï¼Œfolder ç›®å½•ä¸­æ–°å»º article.md æ–‡ä»¶ï¼Œ title ä¸º Oh Beautiful ã€‚<br>è¿™ä¸ªå‘½ç›¸æ¯”è¾ƒäºç›´æ¥ new ï¼Œ å¥½å¤„æ˜¯èƒ½æŠŠæ–‡ç« æŒ‰ç…§ç›®å½•è¿›è¡Œåˆ†ç±»ã€‚</p><p>è¿™é‡Œè´´ä¸€ä»½æˆ‘çš„ scaffold é‡Œ post.md çš„ layoutï¼š</p><pre><code>---title: {{ title }}date: {{ date }}author: peifengimg: {{ zhankeng }}top: truecover: truecoverImg: {{ zhankeng }}password: passwordpasswordpasswordtoc: truemathjax: falsesummary: {{ zhankeng }}categories: Markdowntags:  - Typora  - Markdown---</code></pre><p>å®˜ç½‘å…³äº new å‘½ä»¤çš„ä»‹ç»</p><p>æ›´å¤šé…ç½®è¯´æ˜è¯·å‚è€ƒ <a href="https://hexo.io/zh-cn/docs/configuration" target="_blank" rel="noopener">è¿™é‡Œ</a></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401070947.png-growing" alt="image-20200401070945664"></p><h3 id="5-ä½¿ç”¨è¯„è®ºæ’ä»¶"><a href="#5-ä½¿ç”¨è¯„è®ºæ’ä»¶" class="headerlink" title="5. ä½¿ç”¨è¯„è®ºæ’ä»¶"></a>5. ä½¿ç”¨è¯„è®ºæ’ä»¶</h3><p>hexo çš„è¯„è®ºæ’ä»¶æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚ gitalkï¼Œgitmentï¼Œdisqus(å›½å†…åŸºæœ¬å¯ä»¥ä¸è€ƒè™‘)ï¼Œvaline ç­‰ï¼Œæˆ‘çœ‹äº†å„ç§æ•ˆæœï¼Œ valine å’Œ gitalk æ¯”è¾ƒæ»¡æ„ã€‚</p><p>valine éœ€è¦å…ˆåˆ° <a href="https://www.leancloud.cn/" target="_blank" rel="noopener">LeanCloud</a> ä¸Šæ³¨å†Œè´¦å·ï¼Œå®ƒä¼šæä¾›ç»™å¼€å‘è€…ä¸€ä¸ª <strong>1G</strong> çš„å…è´¹å­˜å‚¨ç©ºé—´( <a href="https://www.leancloud.cn/pricing/" target="_blank" rel="noopener">è®¡ä»·æ–¹æ¡ˆ</a>)ï¼Œè¶…å‡ºéƒ¨åˆ† 0.10 å…ƒ / GB / å¤©ã€‚ ä¸ªäºº blogï¼Œæ„Ÿè§‰è‚¯å®šæ˜¯å¤Ÿç”¨çš„(è¿™é‡Œä¸å¾—ä¸æ„Ÿå¹ï¼Œæœç„¶æ˜¯èƒ½è–…ç¾Šæ¯›ï¼Œå°±è–…ç¾Šæ¯›å•Šï¼Œå•Šå“ˆå“ˆå“ˆ)ï¼Œå› ä¸ºå…¶å®ä¸ä¼šæœ‰å¤šå°‘äººæ¥è¯„è®ºçš„ï¼ï¼ï¼</p><p>ä¸è¿‡æˆ‘å¯¹äº valine çš„æƒé™æ§åˆ¶æœ‰ç‚¹ä¸æ»¡æ„ã€‚å› ä¸ºæˆ‘æœ¬èº«æœ‰åå°æœåŠ¡æ”¯æ’‘ï¼Œåç»­æ‰“ç®—å¯¹ valine åšç‚¹æ”¹åŠ¨ï¼Œæ‰€æœ‰è¯„è®ºç”±æˆ‘è‡ªå·±é€’äº¤ç»™ leancloudï¼Œè¿™æ ·å°±ä¸ç”¨æš´éœ² leancloud çš„ ak å’Œ sk äº†ã€‚å½“ç„¶ï¼Œè¿™æ˜¯é™æ€ blog çš„é€šç—…ï¼Œæœ¨çš„åŠæ³•ã€‚</p><p>è€Œ gitalkï¼Œåˆ™æ˜¯åŸºäº github issue åšçš„å®ç°ï¼Œæ‰€æœ‰çš„è¯„è®ºï¼Œå…¶å®éƒ½æ˜¯ github ä¸Šä¸€ä¸ª repo çš„ issueã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘å…¶å®ä¸ç”¨å…³å¿ƒè¿™ä¸ª repo çš„æœ€ç»ˆç»“å±€ä¼šæ€æ ·ï¼Œå¤§ä¸äº†æˆ‘åˆ äº†é‡å»ºä¸€ä¸ªæ–° repo å‘—ã€‚</p><p>å½“ç„¶ï¼Œgitalk æœ‰ä¸¤ä¸ªé—®é¢˜</p><ol><li>ç½‘ç»œé—®é¢˜ï¼Œç»å¸¸æ€§å‡ºç° Network Error ä¹‹ç±»çš„é—®é¢˜</li><li>æƒé™é—®é¢˜ï¼Œç”¨æˆ·ç•™è¨€æ—¶ï¼Œgitalk ä¼šè¦æ±‚ç”¨æˆ·ç»™ä¸ååˆ†å¤§çš„æƒé™ï¼Œå¦‚æœè¿™ä¸ª blog åšä¸»æ‹¿åˆ°æƒé™åï¼Œåšäº†ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„äº‹æƒ…ï¼Œå¯å°±ä¸å¤ªå¥½äº†ã€‚ã€‚ã€‚æˆ‘å°±ç¢°åˆ°è‡ªåŠ¨ fork åšä¸»é¡¹ç›®çš„</li></ol><p>å…³äº gitalk çš„ä½¿ç”¨ï¼š</p><p><a href="https://github.com/gitalk/gitalk/blob/master/readme-cn.md" target="_blank" rel="noopener">gitalk æ–‡æ¡£</a></p><ol><li>åœ¨ <a href="https://github.com/settings/applications/new" target="_blank" rel="noopener">New Oauth</a> ä¸Šæ–°å»ºä¸€ä¸ªæˆæƒåº”ç”¨</li></ol><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401073717.png-growing" alt="image-20200401073715809"></p><p>callback URLï¼Œ è¿™é‡Œè¯´ä¸‹ï¼Œæ ¹æ® oauth2 åè®®ï¼Œè¿™ä¸ª callback URL å°±æ˜¯å®Œæˆæˆæƒåçš„å›è°ƒåœ°å€ï¼Œè¿™é‡Œå¯ä»¥å¡«å†™è‡ªå·±ç½‘ç«™çš„é¦–é¡µã€‚</p><ol start="2"><li>å®Œæˆåä¼šæ‹¿åˆ° client id å’Œ client secretï¼Œå¡«å…¥åˆ° theme ä¸‹çš„ _config.yml å³å¯ã€‚</li></ol><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401073826.png-growing" alt="image-20200401073822373"></p><ul><li>repoï¼š å³ä½ çš„è¯„è®ºæäº¤çš„åœ°æ–¹ï¼Œä¸€ä¸ª github repo</li><li>owner: ä½  repo æ‰€å±çš„ç»„ç»‡æˆ–è€…ä¸ªäºº</li><li>admin: å¯¹è¿™ä¸ª repo æœ‰å†™æƒé™çš„äºº</li></ul><p>ç„¶åä½ å°±èƒ½æ„‰å¿«çš„ä½¿ç”¨è¯„è®ºåŠŸèƒ½äº†</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401073953.png-growing" alt="image-20200401073951830"></p><h3 id="6-å…¶ä»–ä¼˜åŒ–"><a href="#6-å…¶ä»–ä¼˜åŒ–" class="headerlink" title="6. å…¶ä»–ä¼˜åŒ–"></a>6. å…¶ä»–ä¼˜åŒ–</h3><h4 id="6-1-å›¾ç‰‡æ‡’åŠ è½½"><a href="#6-1-å›¾ç‰‡æ‡’åŠ è½½" class="headerlink" title="6.1 å›¾ç‰‡æ‡’åŠ è½½"></a>6.1 å›¾ç‰‡æ‡’åŠ è½½</h4><h4 id="6-2-ä»£ç å‹ç¼©"><a href="#6-2-ä»£ç å‹ç¼©" class="headerlink" title="6.2 ä»£ç å‹ç¼©"></a>6.2 ä»£ç å‹ç¼©</h4><h4 id="6-3-SEO-ä¼˜åŒ–"><a href="#6-3-SEO-ä¼˜åŒ–" class="headerlink" title="6.3 SEO ä¼˜åŒ–"></a>6.3 SEO ä¼˜åŒ–</h4><p>å‚è€ƒ <a href="https://blog.sky03.cn/posts/42790.html" target="_blank" rel="noopener">hexo ä¼˜åŒ–</a></p><h4 id="6-4-CDN-åŠ é€Ÿ"><a href="#6-4-CDN-åŠ é€Ÿ" class="headerlink" title="6.4 CDN åŠ é€Ÿ"></a>6.4 CDN åŠ é€Ÿ</h4><p>å…³äº CDN åŠ é€Ÿï¼Œä¹Ÿæ˜¯é€šè¿‡ github + <a href="https://www.jsdelivr.com/" target="_blank" rel="noopener">jsDelivr</a> å®Œæˆã€‚å…·ä½“æ“ä½œå°±æ˜¯ï¼Œåœ¨å‘å¸ƒä»£ç çš„æ—¶å€™ï¼Œå¦‚æœæœ¬èº«å°±æ‰˜ç®¡åœ¨ github ä¸Šï¼Œé‚£æœ€æ–¹ä¾¿ï¼Œç›´æ¥åœ¨ theme ä¸»é¢˜ä¸‹çš„ _config.yml ä¸­é…ç½® <code>jsDelivr.url</code> å³å¯ï¼Œå½¢å¦‚ï¼š</p><pre><code># å¦‚ä½ çš„ repo åœ°å€ï¼š https://github.com/A/B# åˆ™è¿™é‡Œçš„åœ°å€å°±è¿™æ ·å¡«å†™https://cdn.jsdelivr.net/gh/A/B</code></pre><p>å†æ¬¡è®¿é—®çš„æ—¶å€™ï¼Œ å°±ä¼šå»è¿™é‡Œè®¿é—®é™æ€èµ„æºäº†ã€‚<br>æˆ‘ä¸ªäººåªæŠŠä¸€éƒ¨åˆ†å¦‚ css/js/libs æ”¾åˆ°äº† github ä¸Šï¼Œå…¶ä»–çš„ï¼Œæ”¾åœ¨è‡ªå·±çš„ ecs ä¸Šã€‚<br>å…³äº SEO ä¼˜åŒ–ï¼Œ ä¸Šé¢çš„æ–‡ç« ä¹Ÿå†™çš„å¾ˆè¯¦ç»†äº†ï¼Œ æˆ‘ä¸ªäººåªé…ç½®äº† google çš„ï¼Œ baidu è¦åšå„ç§è®¤è¯ï¼Œå°±æ‡’å¾—é…äº†ï¼Œå•Šå“ˆå“ˆå“ˆã€‚</p><h3 id="7-ç™¾åº¦ç»Ÿè®¡"><a href="#7-ç™¾åº¦ç»Ÿè®¡" class="headerlink" title="7. ç™¾åº¦ç»Ÿè®¡"></a>7. ç™¾åº¦ç»Ÿè®¡</h3><p><a href="https://tongji.baidu.com/web/10000169496/welcome/login" target="_blank" rel="noopener">ç™¾åº¦ç»Ÿè®¡</a> å¯ä»¥ç”¨æ¥åˆ†æç½‘ç«™å„ä¸ªç»´åº¦çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è®¿é—®äººæ•°ï¼Œ pvï¼Œ uv ç­‰ã€‚<br>ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œ å…ˆåœ¨ <a href="https://tongji.baidu.com/web/10000169496/welcome/login" target="_blank" rel="noopener">è¿™é‡Œ</a> æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œåˆ›å»ºä¸€ä¸ªåº”ç”¨ï¼Œè·å– idï¼Œ ç„¶ååˆ° theme ä¸‹çš„ baiduAnalytics é‚£å¼€å¯å¹¶é…ç½® id ï¼Œå³å¯çœ‹åˆ°ä¸€äº›ç»Ÿè®¡ä¿¡æ¯äº†ã€‚</p><h3 id="8-end"><a href="#8-end" class="headerlink" title="8. end"></a>8. end</h3><p>è‡³æ­¤ï¼Œåœ¨æœ¬åœ°å°±èƒ½å¾ˆæ–¹ä¾¿çš„è®¿é—®äº†</p><h2 id="åŸŸå"><a href="#åŸŸå" class="headerlink" title="åŸŸå"></a>åŸŸå</h2><p>åœ¨ <a href="https://wanwang.aliyun.com/domain/" target="_blank" rel="noopener">åŸŸåæ³¨å†Œ</a> è¿™é‡Œå¯ä»¥æŒ‘é€‰ä¸€ä¸ªåˆé€‚çš„åŸŸåï¼Œ æˆ‘å½“æ—¶ä¹°çš„æ—¶å€™ï¼Œ<em>.top</em>  åç¼€ä¸‰å¹´ï¼Œå¥½åƒæ‰å‡ åå—é’±ã€‚æ³¨å†Œå®Œæˆåï¼Œçœ‹ä½ è‡ªå·±é€‰æ‹©ï¼Œè¦ä¸è¦å¤‡æ¡ˆã€‚å¦‚æœé€‰æ‹©å¤‡æ¡ˆï¼Œéœ€è¦æ‰“å°ä¸€å¼ è¡¨æ ¼ï¼Œå¡«å®Œåæ‹ç…§ä¸Šä¼ ï¼Œä¹‹ååˆ°é˜¿é‡Œäº‘å¤‡æ¡ˆï¼Œé˜¿é‡Œäº‘ä¼šå…è´¹é‚®å¯„ä¸€å¼ è“è‰²çš„å¹•å¸ƒ(å°±æ˜¯ä¸€å¼ è“è‰²çš„çº¸â€¦)ï¼Œç„¶åä½ éœ€è¦æ‹ç…§ä¸Šä¼ ã€‚æ•´ä¸ªè¿‡ç¨‹å¤§çº¦ä¸€ä¸ªç¤¼æ‹œå·¦å³èƒ½æå®šã€‚ä¸éœ€è¦èŠ±é’±ã€‚</p><h2 id="æœåŠ¡å™¨"><a href="#æœåŠ¡å™¨" class="headerlink" title="æœåŠ¡å™¨"></a>æœåŠ¡å™¨</h2><p>ä½†æ˜¯é˜¿é‡Œäº‘ææ´»åŠ¨ï¼Œæˆ‘é€‰è´­äº†ä¸€å°ï¼Œ å¾ˆä¾¿å®œäº†ã€‚ç°åœ¨ä¸çŸ¥é“æ˜¯ä»€ä¹ˆæƒ…å†µ</p><h2 id="SSL-è¯ä¹¦"><a href="#SSL-è¯ä¹¦" class="headerlink" title="SSL è¯ä¹¦"></a>SSL è¯ä¹¦</h2><p>å…è´¹çš„ SSL è¯ä¹¦ï¼Œæä¾›å•†ä¹Ÿå¾ˆå¤šï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯ <a href="https://freessl.cn/" target="_blank" rel="noopener">FreeSSL</a> ï¼Œ é€‰æ‹© Letâ€™s Encrypt V2 ï¼Œ å¯ä»¥ææ³›åŸŸåè¯ä¹¦ï¼Œè¿™ä¸ªè¿˜æ˜¯å¾ˆå¼€å¿ƒçš„ã€‚</p><p>å¦‚æœä½ ä¸éœ€è¦æ³›åŸŸåï¼Œ åªæ˜¯å•åŸŸåï¼Œé‚£å®Œå…¨å¯ä»¥ç›´æ¥åˆ°é˜¿é‡Œäº‘/è…¾è®¯äº‘ç­‰å„ä¸ªå¹³å°å…è´¹ç”³è¯·ï¼Œéƒ½æ˜¯ä¸€å¹´çš„å…è´¹ç”³è¯·ã€‚è¿˜å¾ˆæ–¹ä¾¿ã€‚</p><p>åœ¨ freeSSL ä¸Šç”³è¯·è¯ä¹¦çš„æ—¶å€™ï¼Œä»–ä¼šç»™ä½ å‡ ä¸ª TXT ç±»å‹çš„ DNS è§£æï¼Œè¿™ä¸ªéœ€è¦é…ç½®åˆ°ä½ çš„ DNS æœåŠ¡å•†é‚£é‡Œã€‚</p><p>é˜¿é‡Œäº‘çš„è¯ï¼Œ åœ¨ <a href="https://dc.console.aliyun.com/next/index?spm=a2c1d.8251892.favorites.ddomain.784c5b76NZRlLv#/domain/list/all-domain" target="_blank" rel="noopener">è¿™é‡Œ</a> åº”è¯¥èƒ½æ‰¾åˆ°é…ç½®</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401074420.png-growing" alt="image-20200401074419037"></p><p>æ–°æ·»åŠ åï¼ŒåŸºæœ¬éƒ½æ˜¯ç«‹å³ç”Ÿæ•ˆçš„ã€‚(è™½ç„¶è¯´çš„æ˜¯ 10 åˆ†é’Ÿç”Ÿæ•ˆï¼Œè¿˜æ˜¯ç›¸å½“è°¦è™šçš„)</p><p>ä¸è¿‡ç”³è¯·çš„ SSL æœ‰æ•ˆæœŸï¼Œ<font color="#ff0000"><strong>åªæœ‰ä¸‰ä¸ªæœˆ</strong></font> ï¼ï¼ï¼æ³¨æ„éœ€è¦å®šæœŸæ›´æ¢</p><h2 id="Nginx-é…ç½®-1-14-1"><a href="#Nginx-é…ç½®-1-14-1" class="headerlink" title="Nginx é…ç½® (1.14.1)"></a>Nginx é…ç½® (1.14.1)</h2><p>åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œ éœ€è¦ä¸€ä¸ª(å¤‡æ¡ˆçš„)åŸŸåï¼Œä¸€å°æœåŠ¡å™¨(ecs)ï¼Œä»¥åŠ ssl è¯ä¹¦</p><p>Linux ä¸‹å®‰è£… nginxï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œcentos 8 å¯ä»¥ç›´æ¥é€šè¿‡ <code>sudo dnf install nginx -y</code> å®‰è£…</p><p>è¿™é‡Œå¤šè¯´ä¸€å¥ï¼Œ dnf ç›¸æ¯”è¾ƒäº yumï¼Œè¦æ›´å¥½ç”¨ï¼ŒæŒ‰ç…§å†å²è§„çŸ©ï¼Œ yum åœ¨å°†æ¥ï¼Œåº”è¯¥ä¼šè¢« dnf å–ä»£ã€‚</p><p>å†å¤šè¯´ä¸€å¥ï¼Œ centos 8 ï¼Œç»ˆäºä¸å†ä¾èµ– python2.7 äº†ï¼Œvim çš„åŸºç¡€ç‰ˆæœ¬ä¹Ÿæ˜¯ 8.0ï¼Œå¯¹äºæƒ³è¦å®‰è£… YCM çš„ç«¥é‹æ¥è¯´ï¼Œä¹Ÿç®—æ˜¯ä¸€ä¸ªä¸é”™çš„å¥½æ¶ˆæ¯ã€‚</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401074825.png-growing" alt="image-20200401074823558"></p><p>æˆ‘çš„ nginx ç›®å½•é•¿è¿™æ ·ã€‚</p><p>åœ¨ nginx.conf ä¸­ï¼Œ include conf.d ç›®å½•ä¸‹æ‰€æœ‰çš„ *.conf çš„é…ç½®æ–‡ä»¶ï¼Œè¿™ç®—å¾ˆå¸¸è§çš„é…ç½®æ–¹æ¡ˆï¼Œå¯¹äºå¤šåº”ç”¨æ¥è¯´ï¼Œå¯ä»¥å„è‡ªç»´æŠ¤å„è‡ªçš„ conf æ–‡ä»¶ã€‚</p><p>æˆ‘ä»¬åœ¨ <a href="https://ssl-config.mozilla.org/#server=nginx&amp;version=1.14.1&amp;config=intermediate&amp;openssl=1.1.1d&amp;guideline=5.4" target="_blank" rel="noopener">è¿™é‡Œ</a> èƒ½æ‰¾åˆ°ä¸€ä»½ä¸é”™çš„ nginx é…ç½®ï¼Œç”± mozilla æ¨èçš„é…ç½®</p><p>è¿™æ˜¯ nginx.conf çš„å®Œæ•´é…ç½®ä»¥åŠ https ä¼˜åŒ–ã€‚</p><pre class=" language-nginx"><code class="language-nginx"><span class="token comment" spellcheck="true"># ...</span><span class="token comment" spellcheck="true"># åŠ è½½ nginx æ¨¡å—</span><span class="token keyword">include</span> <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>modules<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span><span class="token keyword">http</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true"># ...</span>    <span class="token keyword">sendfile</span>            on<span class="token punctuation">;</span>    <span class="token keyword">tcp_nopush</span>          on<span class="token punctuation">;</span>    <span class="token keyword">tcp_nodelay</span>         on<span class="token punctuation">;</span>    <span class="token keyword">keepalive_timeout</span>   <span class="token number">65</span><span class="token punctuation">;</span>    <span class="token keyword">types_hash_max_size</span> <span class="token number">2048</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># å…¨å±€ ssl è¯ä¹¦é…ç½®</span>    <span class="token keyword">ssl_certificate</span>      <span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>nginx<span class="token operator">/</span>server_ssl<span class="token punctuation">.</span>crt<span class="token punctuation">;</span>    <span class="token keyword">ssl_certificate_key</span>  <span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>nginx<span class="token operator">/</span>private<span class="token operator">/</span>server_ssl<span class="token punctuation">.</span>key<span class="token punctuation">;</span>    <span class="token keyword">ssl_certificate</span>     <span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>nginx<span class="token operator">/</span>ssl_ecc<span class="token punctuation">.</span>crt<span class="token punctuation">;</span>    <span class="token keyword">ssl_certificate_key</span> <span class="token operator">/</span>etc<span class="token operator">/</span>pki<span class="token operator">/</span>nginx<span class="token operator">/</span>private<span class="token operator">/</span>ssl_ecc<span class="token punctuation">.</span>key<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># session é…ç½®</span>    <span class="token keyword">ssl_session_cache</span>    shared<span class="token punctuation">:</span><span class="token keyword">SSL</span><span class="token punctuation">:</span>10m<span class="token punctuation">;</span>    <span class="token keyword">ssl_session_timeout</span>  1d<span class="token punctuation">;</span>    ssl_session_tickets  off<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># åè®®é…ç½® ssl_ciphers ä»…ä½œç¤ºä¾‹ï¼Œå…·ä½“é…ç½®ä¸‹æ–‡æœ‰è¯´æ˜</span>    <span class="token keyword">ssl_protocols</span>       TLSv1<span class="token number">.2</span> TLSv1<span class="token number">.3</span><span class="token punctuation">;</span>    <span class="token keyword">ssl_prefer_server_ciphers</span>   off<span class="token punctuation">;</span>    <span class="token keyword">ssl_ciphers</span>         CDHE<span class="token operator">-</span>ECDSA<span class="token operator">-</span>AES128<span class="token operator">-</span>GCM<span class="token operator">-</span>SHA256<span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># TODO å¼€å¯ oscp</span>    <span class="token comment" spellcheck="true"># ssl_stapling      on;</span>    <span class="token comment" spellcheck="true"># ssl_stapling_verify       on;</span>    <span class="token comment" spellcheck="true"># ssl_trusted_certificate   ospc_file_path</span>    <span class="token comment" spellcheck="true"># common header è¯ä¹¦æœ‰æ•ˆæœŸé—®é¢˜ï¼Œè¿™é‡Œè®¾ç½® 7776000 </span>    <span class="token keyword">add_header</span> Strict<span class="token operator">-</span>Transport<span class="token operator">-</span>Security <span class="token string">"max-age=7776000;"</span> always<span class="token punctuation">;</span>    <span class="token keyword">add_header</span> X<span class="token operator">-</span>Frame<span class="token operator">-</span>Options <span class="token string">"SAMEORIGIN"</span> always<span class="token punctuation">;</span>    <span class="token keyword">add_header</span> X<span class="token operator">-</span>Xss<span class="token operator">-</span>Protection <span class="token string">"1; mode=block"</span> always<span class="token punctuation">;</span>    <span class="token keyword">add_header</span> X<span class="token operator">-</span>Content<span class="token operator">-</span>Type<span class="token operator">-</span>Options <span class="token string">"nosniff"</span> always<span class="token punctuation">;</span>    brotli on<span class="token punctuation">;</span>    brotli_static on<span class="token punctuation">;</span>    brotli_min_length   <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"># å¤§äºæˆ–ç­‰äº 50 å­—èŠ‚æ—¶æ‰ä¼šè¿›è¡Œå‹ç¼©</span>    brotli_comp_level   <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"># å‹ç¼©ç­‰çº§ é»˜è®¤ 6 è¶Šé«˜ cpu ç”¨çš„è¶Šå¤š</span>    brotli_buffers      <span class="token number">16</span> 8k<span class="token punctuation">;</span> <span class="token comment" spellcheck="true"># è¯·æ±‚ç¼“å†²åŒºçš„æ•°é‡å’Œå¤§å°</span>    brotli_types text<span class="token operator">/</span>plain text<span class="token operator">/</span>css text<span class="token operator">/</span>javascript application<span class="token operator">/</span>javascript text<span class="token operator">/</span>xml application<span class="token operator">/</span>xml image<span class="token operator">/</span>svg<span class="token operator">+</span>xml application<span class="token operator">/</span>json<span class="token punctuation">;</span>    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token punctuation">.</span>d<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="1-å…¨å±€-ssl-è¯ä¹¦é…ç½®"><a href="#1-å…¨å±€-ssl-è¯ä¹¦é…ç½®" class="headerlink" title="1. å…¨å±€ ssl è¯ä¹¦é…ç½®"></a>1. å…¨å±€ ssl è¯ä¹¦é…ç½®</h3><p>è¿™é‡Œé‡‡ç”¨çš„æ˜¯åŒè¯ä¹¦æ¨¡å¼ï¼ŒRSA å’Œ ECC ä¸¤ç§åŠ å¯†æ–¹å¼çš„è¯ä¹¦ã€‚å¦‚æœå„è‡ªçš„ conf æœ‰æ–°è¯ä¹¦ï¼Œç›´æ¥åœ¨å„è‡ªçš„ conf ä¸­é…ç½®ï¼Œä¼šè¦†ç›–æ‰å…¨å±€çš„é…ç½®</p><h3 id="2-session-é…ç½®"><a href="#2-session-é…ç½®" class="headerlink" title="2. session é…ç½®"></a>2. session é…ç½®</h3><p>ä¸€èˆ¬å¼€å¯æœåŠ¡ç«¯ session ç¼“å­˜ï¼Œ1M å¤§çº¦èƒ½ç¼“å­˜ 4000 ä¸ª sessionï¼Œè¿™é‡Œé…ç½®äº† 10M</p><h3 id="3-åè®®ä¼˜åŒ–"><a href="#3-åè®®ä¼˜åŒ–" class="headerlink" title="3. åè®®ä¼˜åŒ–"></a>3. åè®®ä¼˜åŒ–</h3><p>TLSv1.1ï¼Œ TLSv1.2ï¼ŒTLSv1.3ï¼Œ TLSv1.3 ç›¸è¾ƒäºå‰è€…ï¼Œ åšåˆ°äº†æ›´å®‰å…¨å’Œæ›´å¿«ï¼Œ å¦‚æœä½ ä¸éœ€è¦å‘å‰å…¼å®¹ï¼Œç›´æ¥é€‰æ‹© TLSv1.3 å°±å¥½äº†ã€‚æˆ‘æœ¬æ¥ä¹Ÿå¦‚æ­¤ï¼Œåæ¥å¯¹æ¥ gitee çš„ push hooks çš„æ—¶å€™ï¼Œå‘ç°æ¡æ‰‹ä¸€ç›´æŒ‚ï¼Œæ— å¥ˆï¼Œåˆé…ä¸Šäº† TLSv1.2</p><p>å…³äº <code>ssl_prefer_server_ciphers off</code>  è¿™ä¸ªé€‰é¡¹çš„æ›´å¤šè§£é‡Šï¼š<a href="https://github.com/mozilla/server-side-tls/issues/260" target="_blank" rel="noopener">GITHUB ISSUE</a></p><h3 id="4-add-header"><a href="#4-add-header" class="headerlink" title="4. add_header"></a>4. add_header</h3><p>æ˜¯ä¸€äº›åˆ—çš„å®‰å…¨é…ç½®å’Œ hsts é…ç½®</p><h3 id="5-brotli-å‹ç¼©"><a href="#5-brotli-å‹ç¼©" class="headerlink" title="5. brotli å‹ç¼©"></a>5. brotli å‹ç¼©</h3><p>ä¸€ç§å‹ç¼©ç®—æ³•ï¼Œæ¯”å¸¸ç”¨ gzip è¦æ›´ç»™åŠ›ã€‚ç›®å‰å‡ ä¹æ‰€æœ‰ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒäº† br ï¼Œä½†ä¸å…æœ‰æ¼ç½‘ä¹‹é±¼ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©åŒæ—¶æ”¯æŒ br å’Œ gzip ã€‚</p><p>åœ¨ä½¿ç”¨ br ä¹‹å‰ï¼Œéœ€è¦å…ˆç»™ nginx åŠ ä¸Š brotli æ¨¡å—ã€‚åœ¨ centos 8 ä¸‹ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</p><h4 id="5-1-ä¸‹è½½-nginx"><a href="#5-1-ä¸‹è½½-nginx" class="headerlink" title="5.1 ä¸‹è½½ nginx"></a>5.1 ä¸‹è½½ nginx</h4><p>å…·ä½“å“ªä¸ªç‰ˆæœ¬ï¼Œè§†ä½ å®‰è£…çš„ nginx ç‰ˆæœ¬è€Œå®šï¼Œå¯é€šè¿‡ <code>nginx -V</code> æŸ¥çœ‹ï¼Œ æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ <strong>nginx/1.14.1</strong> </p><pre class=" language-shell"><code class="language-shell"># è¿™ä¹‹å‰ï¼Œ ä½ å¯èƒ½éœ€è¦å®‰è£…ä¸€äº›åŸºç¡€å·¥å…·åŒ…sudo dnf install -y curl wget unzip socat bash-completion epel-release && sudo dnf groupinstall "Development Tools"sudo dnf install -y pcre pcre-devel zlib zlib-devel openssl openssl-develwget https://nginx.org/download/nginx-1.14.1.tar.gz && tar zxvf nginx-1.14.1.tar.gz</code></pre><h4 id="5-2-ä¸‹è½½-brotli"><a href="#5-2-ä¸‹è½½-brotli" class="headerlink" title="5.2 ä¸‹è½½ brotli"></a>5.2 ä¸‹è½½ brotli</h4><pre class=" language-shell"><code class="language-shell">git clone https://github.com/google/ngx_brotli.gitcd ngx_brotli && git submodule update --init</code></pre><h4 id="5-3-ç¼–è¯‘"><a href="#5-3-ç¼–è¯‘" class="headerlink" title="5.3 ç¼–è¯‘"></a>5.3 ç¼–è¯‘</h4><p>è¿™é‡Œè¦ååˆ†çš„æ³¨æ„ï¼Œæˆ‘ä»¬éœ€è¦ç¼–è¯‘çš„ <code>.so</code> æ–‡ä»¶ï¼Œæœ€ç»ˆæ˜¯æˆ‘ä»¬å·²ç»å®‰è£…çš„ nginx å»æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ make çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„ç¯å¢ƒé…ç½®éœ€è¦å’Œå·²å®‰è£…çš„ nginx ä¸€è‡´ã€‚</p><p>æˆ‘æœ€å¼€å§‹çš„æ—¶å€™æ²¡æœ‰æ³¨æ„åˆ°è¿™ä¸€ç‚¹ï¼Œè¸©äº†å‘ï¼Œæœ€å restart nginx çš„æ—¶å€™ï¼Œä¸€è‡´æŠ¥ <strong>is not binary compatible</strong> ä¹‹ç±»çš„é”™è¯¯</p><pre class=" language-shell"><code class="language-shell"># 1. è·å–å½“å‰è¿è¡Œ nginx çš„ç¯å¢ƒé…ç½®sudo nginx -V# è¿›å…¥ä¸‹è½½çš„ nginx æºç ç›®å½•æ“ä½œ# ä¸Šä¸€æ­¥ä¼šè¾“å‡º configure argumentsï¼Œæˆ‘ä»¬è®¾ä¸º Aï¼Œ æŠŠä»–ä»¬å…¨éƒ¨åŠ å…¥å…¶ä¸­# --add-dynamic-module=../ngx_brotli è¿™é‡Œçš„è·¯å¾„æ ¹æ®ä½ ä¸‹è½½ brotli çš„ä½ç½®è€Œå®š./configure A --add-dynamic-module=../ngx_brotli</code></pre><p>è¿™ä¸€æ­¥æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯èƒ½è¿˜ä¼šæŠ¥é”™ï¼Œä¸€èˆ¬éƒ½æ˜¯ç¼ºå°‘ä¾èµ–ã€‚å¦‚ï¼š</p><pre class=" language-shell"><code class="language-shell"># This is perl 5, version 26, subversion 3 (v5.26.3) built for x86_64-linux-thread-multi# Can't locate ExtUtils/Embed.pm in @INC (you may need to install the ExtUtils::Embed module).......# æ­¤æ—¶æ‰§è¡Œï¼šsudo dnf -y install perl-devel perl-ExtUtils-Embed# the HTTP image filter module requires the GD library# æ‰§è¡Œsudo dnf -y install gd gd-devel</code></pre><h4 id="5-4-cp-so-æ–‡ä»¶"><a href="#5-4-cp-so-æ–‡ä»¶" class="headerlink" title="5.4 cp .so æ–‡ä»¶"></a>5.4 cp .so æ–‡ä»¶</h4><p>ä¸Šä¸€æ­¥æ‰§è¡Œå®Œæˆåï¼Œ ä¼šåœ¨  nginx ä¸‹çš„ objs ç›®ä¸­ä¸­ç”Ÿæˆ </p><p><code>ngx_http_brotli_filter_module.so</code>   å’Œ <code>ngx_http_brotli_static_module.so</code> </p><p>ç›®æ ‡æ–‡ä»¶ï¼Œæˆ‘ä»¬æŠŠä»–ä»¬ç§»åŠ¨åˆ°åŸ nginx çš„ mudule ä¸­ã€‚ </p><p>å…ˆåœ¨ nginx.conf ä¸­çœ‹ modules.conf åœ¨å“ªé‡Œï¼š</p><p><code>include /usr/share/nginx/modules/*.conf;</code>  è¯´æ˜æ‰€æœ‰çš„ module é…ç½®æ–‡ä»¶éƒ½åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚</p><p>ç„¶åå»è¿™ä¸ªç›®å½•ï¼Œéšä¾¿ cat ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œ ä¼šè¾“å‡ºï¼š</p><pre class=" language-nginx"><code class="language-nginx">load_module <span class="token string">"/usr/lib64/nginx/modules/ngx_http_brotli_filter_module.so"</span><span class="token punctuation">;</span></code></pre><p>æ­¤æ—¶èƒ½çœ‹åˆ°ï¼Œæ‰€æœ‰ module çš„ .so æ–‡ä»¶ï¼Œéƒ½åœ¨è¿™ä¸ªåœ°æ–¹ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ª <code>.so</code> ä¹Ÿ cp è¿™ä¸ªç›®å½•</p><p>å½“ç„¶ï¼Œ ä½ ä¹Ÿå¯ä»¥æ”¾å…¥ä»»ä½•ä½ æƒ³æ”¾çš„ä½ç½®ï¼Œç„¶ååœ¨ç¼–å†™ .conf çš„æ—¶å€™ï¼ŒæŒ‡å®šè·¯å¾„å°±å¥½äº†ã€‚</p><h4 id="5-5-ç¼–å†™-conf-æ–‡ä»¶"><a href="#5-5-ç¼–å†™-conf-æ–‡ä»¶" class="headerlink" title="5.5 ç¼–å†™ .conf æ–‡ä»¶"></a>5.5 ç¼–å†™ .conf æ–‡ä»¶</h4><p>ç§»åŠ¨å®Œæˆåï¼ŒåŒæ ·çš„ï¼Œæˆ‘ä»¬åœ¨ modules ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼š</p><p> <code>mod-http-brotli-filter.conf</code>  å’Œ <code>mod-http-brotli-static.conf</code> </p><p>å†…å®¹åˆ†åˆ«ä¸ºï¼š</p><pre class=" language-nginx"><code class="language-nginx">load_module <span class="token string">"/usr/lib64/nginx/modules/ngx_http_brotli_filter_module.so"</span><span class="token punctuation">;</span></code></pre><p>å’Œ</p><pre class=" language-nginx"><code class="language-nginx">load_module <span class="token string">"/usr/lib64/nginx/modules/ngx_http_brotli_static_module.so"</span><span class="token punctuation">;</span></code></pre><p>å½“ç„¶ï¼Œä»¥ä¸Šæ‰€æœ‰çš„è·¯å¾„ï¼Œéƒ½ä»¥ä½ å®é™…çš„ç›®å½•ä¸ºå‡†</p><h4 id="5-6-é‡å¯å’ŒéªŒè¯"><a href="#5-6-é‡å¯å’ŒéªŒè¯" class="headerlink" title="5.6 é‡å¯å’ŒéªŒè¯"></a>5.6 é‡å¯å’ŒéªŒè¯</h4><p><code>sudo nginx -t</code>  è¾“å‡º ok å <code>sudo systemctl restart nginx</code>  </p><p>è¿™æ—¶é€šè¿‡é¡µé¢è®¿é—®ï¼Œèƒ½çœ‹åˆ° br å³è¯´æ˜ ok</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401081528.png-growing" alt="image-20200401081526690"></p><h3 id="6-blog-conf-é…ç½®-å¯ç”¨-http2"><a href="#6-blog-conf-é…ç½®-å¯ç”¨-http2" class="headerlink" title="6. blog conf é…ç½®[å¯ç”¨ http2]"></a>6. blog conf é…ç½®[å¯ç”¨ http2]</h3><pre class=" language-nginx"><code class="language-nginx"><span class="token keyword">server</span> <span class="token punctuation">{</span>        <span class="token keyword">listen</span>       <span class="token number">80</span><span class="token punctuation">;</span>        <span class="token keyword">server_name</span>  iyuhp<span class="token punctuation">.</span>top<span class="token punctuation">;</span>        <span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span><span class="token punctuation">;</span>        <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Real<span class="token operator">-</span>IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>        <span class="token keyword">proxy_set_header</span> REMOTE<span class="token operator">-</span>HOST <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>        <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">301</span> <span class="token keyword">https</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token variable">$host</span><span class="token variable">$request_uri</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token keyword">server</span> <span class="token punctuation">{</span>    <span class="token keyword">listen</span> <span class="token number">443</span> <span class="token keyword">ssl</span> http2<span class="token punctuation">;</span>    <span class="token keyword">listen</span> <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">443</span> <span class="token keyword">ssl</span> http2<span class="token punctuation">;</span>    <span class="token keyword">server_name</span> iyuhp<span class="token punctuation">.</span>top<span class="token punctuation">;</span>    <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>    <span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span><span class="token punctuation">;</span>    <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Real<span class="token operator">-</span>IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>    <span class="token keyword">proxy_set_header</span> REMOTE<span class="token operator">-</span>HOST <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>    <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>    <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>        <span class="token keyword">root</span>            <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token operator">/</span>growing<span class="token operator">-</span>blog<span class="token operator">/</span>public<span class="token punctuation">;</span>        <span class="token keyword">index</span>           <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">location</span> <span class="token operator">=</span> <span class="token operator">/</span>favicon<span class="token punctuation">.</span>png <span class="token punctuation">{</span>            <span class="token keyword">expires</span>     30d<span class="token punctuation">;</span>            <span class="token keyword">access_log</span>  off<span class="token punctuation">;</span>            <span class="token keyword">root</span>        <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">location</span> <span class="token operator">~</span><span class="token operator">*</span> <span class="token operator">^</span><span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>bmp<span class="token operator">|</span>swf<span class="token punctuation">)</span>$ <span class="token punctuation">{</span>            <span class="token keyword">expires</span>     15d<span class="token punctuation">;</span>            <span class="token keyword">access_log</span>  off<span class="token punctuation">;</span>            <span class="token keyword">root</span>        <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token operator">/</span>growing<span class="token operator">-</span>blog<span class="token operator">/</span>public<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># js/css ç­‰ï¼Œæˆ‘ä»¬å·²ç»æ‰˜ç®¡åˆ° jsDelivr ï¼Œè¿™é‡Œå°±ä¸ç”¨å†é…ç½®äº†</span>    <span class="token keyword">access_log</span>  <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>growing<span class="token operator">-</span>blog<span class="token operator">/</span>access<span class="token punctuation">.</span>log  main<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>æˆ‘ä»¬åœ¨ listen çš„æ—¶å€™ï¼Œå¦‚ä¸Šå›¾é…ç½® http2 å³å¯ï¼Œæ— éœ€ <code>ssl on</code>  </p><p>å‰©ä¸‹éƒ½æ˜¯å¸¸è§„é…ç½®ï¼Œ æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œ æ— éæ˜¯ç»™ä¸€äº›é™æ€æ–‡ä»¶æ·»åŠ ç¼“å­˜ï¼Œè¿™ä¸ªæ ¹æ®å®é™…æƒ…å†µé…ç½®å°±å¥½ã€‚</p><p>æˆ‘ä»¬æ‰“å¼€æ§åˆ¶å°ï¼Œèƒ½çœ‹åˆ° <em>Protocol</em>  ä¸€æ ï¼Œéƒ½æ˜¾ç¤ºä¸º <em>h2</em> ï¼Œè¯´æ˜é…ç½®ç”Ÿæ•ˆ</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401082103.png-growing" alt="image-20200401082101525"></p><h3 id="7-é™æµ-Deny"><a href="#7-é™æµ-Deny" class="headerlink" title="7. é™æµ + Deny"></a>7. é™æµ + Deny</h3><p>åœ¨ blog è·‘äº†å‡ å¤©ä¹‹åï¼Œæˆ‘æ— äº‹ä¹‹æ—¶ï¼Œçœ‹äº†çœ¼ nginx çš„æ—¥å¿—ï¼Œå‘ç°ç½‘ç»œä¸–ç•Œè¿˜æ˜¯å‡¶é™©å•Šã€‚</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200408220736.png-growing" alt="access.log"></p><p>é’ˆå¯¹å„å¼å„æ ·ä¹±ä¸ƒå…«ç³Ÿçš„çˆ¬è™«ï¼Œè¿˜æœ‰ä¸€äº›ç«¯å£æ‰«æå·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„é€šè¿‡ user-agent æ¥åšè¿‡æ»¤ï¼Œæ¯”å¦‚åœ¨ä½ çš„ server å±‚(å› ä¸ºåŒ…å« if è¯­å¥ï¼Œæ‰€ä»¥ http å±‚æ˜¯æ”¾ä¸äº†çš„)ï¼ŒåŠ ä¸€ä¸ª ua-deny.conf ä¹‹ç±»çš„æ–‡ä»¶</p><pre class=" language-nginx"><code class="language-nginx"><span class="token comment" spellcheck="true">#ç¦æ­¢Scrapyç­‰å·¥å…·çš„æŠ“å–</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$http_user_agent</span> <span class="token operator">~</span><span class="token operator">*</span> <span class="token punctuation">(</span>Scrapy<span class="token operator">|</span>Curl<span class="token operator">|</span>HttpClient<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">return</span> <span class="token number">444</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">#ç¦æ­¢æŒ‡å®šUAåŠUAä¸ºç©ºçš„è®¿é—®</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$http_user_agent</span> <span class="token operator">~</span><span class="token operator">*</span> <span class="token string">"tbox|Go http|FeedDemon|Indy Library|Alexa Toolbar|AskTbFXTV|AhrefsBot|CrawlDaddy|CoolpadWebkit|Java|Feedly|UniversalFeedParser|ApacheBench|Swiftbot|ZmEu|oBot|jaunty|Python-urllib|lightDeckReports Bot|YYSpider|DigExt|HttpClient|MJ12bot|heritrix|EasouSpider|Gather Analyze Provide|Ezooms|zgrab|^$"</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">return</span> <span class="token number">444</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>è¿™æ ·å°±å¯ä»¥æ ¹æ® ua è¿›è¡Œè¿‡æ»¤ã€‚</p><p>åŒæ—¶ï¼Œä¹Ÿå¯ä»¥åˆ†ææ—¥å¿—ï¼ŒæŸ¥æ‰¾å¼‚å¸¸çš„ ipï¼Œ ç„¶åç›´æ¥ deny æ‰ã€‚</p><pre class=" language-shell"><code class="language-shell">awk '{print $1}' ./access.log | sort  | uniq -c| sort -n</code></pre><p>æŠŠæ¶æ„ ip å†™å…¥åˆ°å¦‚ <code>ip_deny</code> æ–‡ä»¶ä¸­ï¼Œç„¶ååœ¨ http å±‚ï¼Œæˆ–è€… server å±‚ï¼Œ <code>include ip_deny;</code> ï¼Œå³å¯æ‹’ç»è¿™äº› ipã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥é™å®šå•ä¸ª ipï¼Œæˆ–è€… å•ä¸ª server çš„è®¿é—®</p><pre class=" language-nginx"><code class="language-nginx"><span class="token comment" spellcheck="true"># é™æµ</span><span class="token comment" spellcheck="true"># é™åˆ¶å•ä¸ª ip æ¯ç§’åæ¬¡è®¿é—®</span><span class="token comment" spellcheck="true"># è¿™é‡Œä»¥ binary_remote_addr ä½œä¸º keyï¼Œè¿›è¡Œå• ip é™æµ</span><span class="token keyword">limit_req_zone</span> <span class="token variable">$binary_remote_addr</span> zone<span class="token operator">=</span>one<span class="token punctuation">:</span>1m rate<span class="token operator">=</span>2r<span class="token operator">/</span>s<span class="token punctuation">;</span><span class="token keyword">limit_req</span>   zone<span class="token operator">=</span>one        burst<span class="token operator">=</span><span class="token number">3</span> nodelay<span class="token punctuation">;</span> <span class="token comment" spellcheck="true"># æ¯ç§’ä¸¤æ¬¡è¯·æ±‚ï¼Œä¼šç¼“å­˜ 3 æ¬¡ï¼Œè¶…è¿‡çš„è¯·æ±‚å³è¢«ä¸¢å¼ƒ</span>limit_req_status    <span class="token number">403</span><span class="token punctuation">;</span><span class="token keyword">limit_conn_zone</span> <span class="token variable">$binary_remote_addr</span> zone<span class="token operator">=</span>addr<span class="token punctuation">:</span>1m<span class="token punctuation">;</span><span class="token keyword">limit_conn</span> addr <span class="token number">3</span><span class="token punctuation">;</span>limit_conn_status   <span class="token number">403</span><span class="token punctuation">;</span></code></pre><p>ç¤ºä¾‹ä¸­ï¼Œå¯¹ ip è¿›è¡Œé™æµï¼Œæˆ‘ä»¬åŒæ—¶å¯ä»¥é’ˆå¯¹ server è¿›è¡Œé™æµï¼Œä½¿ç”¨ <code>$host</code> ä½œä¸º key å³å¯ã€‚</p><p><code>limit_req</code> å’Œ <code>limit_conn</code> åˆ†åˆ«é’ˆå¯¹è®¿é—®æ¬¡æ•°å’Œè®¿é—®è¿æ¥æ•°åšé™åˆ¶ã€‚ä¸Šè¿°é…ç½®å³ï¼š</p><p>å• ip æœ€å¤šæœ‰ 3 ä¸ªè¿æ¥ï¼Œå• ip æ¯ç§’æœ€å¤šå…è®¸ 2 æ¬¡è¯·æ±‚ï¼Œè¶…è¿‡çš„æ¬¡æ•°ï¼Œä¼šå…ˆç¼“å­˜åˆ° burst ä¸­ï¼Œä¼šç¼“å­˜ 3 æ¬¡ï¼Œè‹¥è¿˜æœ‰è¯·æ±‚ï¼Œåˆ™è¢«ä¸¢å¼ƒï¼Œè¿”å› 403ã€‚</p><h3 id="8-å¼€å¯-OSCP"><a href="#8-å¼€å¯-OSCP" class="headerlink" title="8.  å¼€å¯ OSCP"></a>8.  å¼€å¯ OSCP</h3><pre class=" language-shell"><code class="language-shell"># TODO å¼€å¯ oscpssl_stapling      on;ssl_stapling_verify       on;ssl_trusted_certificate   ospc_file_path</code></pre><p>æœ‰å…´è¶£çš„ç«¥é‹å¯ä»¥å¼€å¯è¯•ä¸‹ï¼Œ è¿™é‡Œæ³¨æ„ä¸‹ï¼Œä½ è¦å…ˆç”Ÿæˆ trusted certificate file ï¼Œ è¿™ä¸ª file æœ‰è¿‡æœŸæ—¶é—´ï¼Œæ‰€ä»¥ä½ éœ€è¦ä¸€ä¸ª cronjob æ¥å®šæ—¶æ›´æ–°å®ƒï¼Œåæ­£æˆ‘æ²¡æœ‰å¼€å¯å®ƒã€‚ã€‚ã€‚</p><h2 id="å›¾åºŠ"><a href="#å›¾åºŠ" class="headerlink" title="å›¾åºŠ"></a>å›¾åºŠ</h2><p>ä½¿ç”¨ä¸ƒç‰›äº‘ä½œä¸ºå›¾åºŠï¼Œ ä¸ƒç‰›äº‘æ³¨å†Œåï¼Œä¼šé€ 10G çš„å…è´¹ OSSï¼Œä½œä¸ºä¸€äº›å›¾ç‰‡çš„å­˜æ”¾ç‚¹ï¼Œååˆ†åˆé€‚(æ˜¯çš„ï¼Œæˆ‘å°±æ˜¯è¿™æ ·è–…ç¾Šæ¯›çš„ï¼)</p><ul><li><a href="https://uploader.iyuhp.top" target="_blank" rel="noopener">Uploader é“¾æ¥</a></li><li><a href="https://gitee.com/iyuhp-growing/growing-backend/tree/develop/qnyun" target="_blank" rel="noopener">Gitee ä»“åº“</a></li></ul><p>å®ç°æ¦‚è§ˆï¼š</p><ol><li>ä½¿ç”¨ golang æ­å»ºä¸€ä¸ªç®€å•çš„ web serverï¼Œä¸»è¦è´Ÿè´£ç™»å½•éªŒè¯å’Œåˆ†å‘ä¸ƒç‰›äº‘ OSS çš„ä¸Šä¼  Token</li><li>å‰ç«¯ä½¿ç”¨ <a href="https://www.dropzonejs.com/" target="_blank" rel="noopener">Dropzone</a> js ç»„ä»¶æ¥å®ç°ä¸Šä¼ </li><li>ä½¿ç”¨ä¸ƒç‰›äº‘çš„ <a href="https://developer.qiniu.com/kodo/api/1312/upload" target="_blank" rel="noopener">Http Upload</a> æ–¹å¼ä¸Šä¼ å›¾ç‰‡ï¼Œtoken ä» web sever æ‹¿ï¼Œä¸Šä¼ ä¸ç»è¿‡ web server</li></ol><p>å—¯ï¼Œ ä»Šå¤©çªç„¶å‘ç°äº†ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡çš„ä¸Šä¼ å·¥å…· <a href="https://github.com/Molunerfinn/PicGo" target="_blank" rel="noopener">PicGO</a> ï¼Œä¸è¿‡æˆ‘è‚¯å®šè¿˜æ˜¯ç”¨æˆ‘è‡ªå·±çš„è¿™ä¸ªäº†ï¼Œå•Šå“ˆå“ˆå“ˆ</p><h2 id="CICD"><a href="#CICD" class="headerlink" title="CICD"></a>CICD</h2><p>å¦‚æœä¸æ˜¯å’Œæˆ‘ä¸€æ ·ï¼Œæäº†å¾ˆå¤šä¹±ä¸ƒå…«ç³Ÿçš„ï¼Œæ— è®ºæ˜¯ github ï¼Œ è¿˜æ˜¯ giteeï¼Œéƒ½æä¾›äº†åŸºäº hexo çš„ cicdï¼Œåªéœ€è¦åœ¨è‡ªå·±çš„ _config.yml ä¸­é…ç½®ä¸‹ deploy (å¯èƒ½éœ€è¦æ·»åŠ ä¸€ä¸ª .travis.yml)  </p><p>æˆ‘ä¸ªäººåŸºäº Golang ï¼Œè‡ªå·±å®šåˆ¶äº†ä¸€ä¸ª cicd æµç¨‹ã€‚</p><p>é€šè¿‡ gitee çš„ push hooks eventï¼Œ æ‹‰å–æœ€æ–°ä»£ç ï¼Œç„¶åæ‰§è¡Œ blog ä¸­ build.sh è„šæœ¬ï¼Œè„šæœ¬ä¸»è¦åšäº†è¿™å‡ ä»¶äº‹æƒ…</p><ul><li>æ‰“å° hexo ç‰ˆæœ¬</li><li>æ‰§è¡Œ npm i</li><li>æ‰§è¡Œ gulp default , è¿›è¡Œç¼–è¯‘å‹ç¼©é™æ€æ–‡ä»¶</li><li>ç§»åŠ¨æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•</li></ul><p>æ‰§è¡Œå®Œåï¼Œ cicd ä¼šæ£€æµ‹æ˜¯å¦éœ€è¦æäº¤åˆ° githubï¼Œå¦‚æœéœ€è¦ï¼Œä¼šæ‰§è¡Œ git add git commit git push ä¸€ç³»åˆ—å‘½ä»¤ï¼Œæ‰§è¡Œå®Œæ¯•åï¼Œæ•´ä¸ªæµç¨‹å°±ç»“æŸã€‚</p><p>å¯¹äºæˆ‘çš„ uploader ï¼Œ cicd é¦–å…ˆä¼šæ‹‰å–ä»£ç ï¼Œæ‰“åŒ…é•œåƒï¼Œä¹‹åä¼šé€šè¿‡ docker ps æŸ¥çœ‹æ˜¯å¦æœ‰è¿›ç¨‹ï¼Œæœ‰çš„è¯ä¼šæ€æ­»ï¼Œæ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¹ˆéœ¸é“ï¼Œå®Œå…¨æ²¡æœ‰é‚£ä¹ˆä¸€ä¸ä¸çš„å¹³æ»‘ï¼Œæ€æ­»åï¼Œä¼šæŠŠæ–°çš„é•œåƒæ‹‰èµ·æ¥ï¼Œæ•´ä¸ªæµç¨‹ç»“æŸã€‚<br>æœ¬æ¥å‡†å¤‡æ‰“ç®—åŠ ä¸ªé€šçŸ¥åŠŸèƒ½ï¼Œä¸è¿‡æš‚æ—¶æ²¡æœ‰æ—¶é—´åšã€‚</p><p>è¿˜æœ‰ï¼Œååˆ†é‡è¦çš„å°±æ˜¯ï¼Œ æ‰€æœ‰çš„æ“ä½œéƒ½åœ¨åŒä¸€ä¸ªç›®å½•ï¼Œcicd æ¯ä¸€æ¬¡æ‰§è¡Œï¼Œéƒ½ä¼šå¼€ä¸€ä¸ªåç¨‹ï¼Œè¿™å¿…ç„¶ä¼šäº§ç”Ÿå†™æ–‡ä»¶å†²çªï¼Œè€ƒè™‘åˆ°åªæœ‰æˆ‘ä¸€ä¸ªäººç”¨ï¼Œå¹¶ä¸æ‰“ç®—æ”¹è¿™é‡Œã€‚</p><p>æ”¹è¿›ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æ¯æ¬¡ cicd çš„æ—¶å€™ï¼Œéƒ½äº§ç”Ÿä¸€ä¸ªæ–°ç›®å½•ï¼Œåªæ‹‰å–æœ€æ–°ä»£ç ï¼Œç„¶ååœ¨å„è‡ªçš„ç›®å½•ä¸­å»åšäº‹å°±å¥½äº†ã€‚å®Œäº‹å„¿æŠŠç›®å½•åˆ æ‰ï¼</p><p>å¯æ˜¯è€ƒè™‘åˆ°æˆ‘é‚£ 1C1G 50G çš„å¯æ€œèµ„æºï¼Œå“ï¼Œç®—äº†ï¼Œå’±ä¸æŠ˜è…¾ï¼ï¼ï¼</p><h2 id="å†™æ–‡ç« "><a href="#å†™æ–‡ç« " class="headerlink" title="å†™æ–‡ç« "></a>å†™æ–‡ç« </h2><p>windows ä¸‹ï¼Œå®é™…ä½“éªŒä¸‹æ¥ï¼Œè¿˜æ˜¯ç”¨  <a href="https://www.typora.io/" target="_blank" rel="noopener">Typora</a> + <a href="https://github.com/PicGo" target="_blank" rel="noopener">PicGo</a> æ¥çš„èˆ’æœ</p><p>å‰é¢åˆšè¯´å®Œ</p><blockquote><p>ä¸è¿‡æˆ‘è‚¯å®šæ˜¯ç”¨æˆ‘è‡ªå·±çš„è¿™ä¸ªäº†</p></blockquote><p>å—¯ï¼Œ çœŸé¦™â€¦â€¦</p><p>æ‰€ä»¥æˆ‘è‡ªå·±çš„ï¼Œå°±å¹³æ—¶ç”¨æ¥å­˜å­˜å›¾ç‰‡å•¥çš„å¥½äº†ï¼Œåæ­£éƒ½æ’¸å‡ºæ¥äº†ä¸æ˜¯ï¼</p><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><h3 id="1-bing-çˆ¬è™«"><a href="#1-bing-çˆ¬è™«" class="headerlink" title="1. bing çˆ¬è™«"></a>1. <del>bing çˆ¬è™«</del></h3><p>é€šè¿‡çˆ¬è™«çˆ¬å– bing é¦–é¡µå›¾ç‰‡ï¼Œæ”¾åˆ° banner ä¸­</p><p>å…¶å® bing å·²ç»ç»™äº†æˆ‘ä»¬é“¾æ¥ï¼Œæˆ‘ä»¬ç¨å¾®è§£æä¸‹å°±å¥½äº†ï¼Œé“¾æ¥åœ¨ <a href="https://cn.bing.com/HPImageArchive.aspx?format=js&amp;idx=%d&amp;n=100" target="_blank" rel="noopener">è¿™é‡Œ</a> </p><p>æˆ‘å–äº†åˆ—è¡¨å‰ 5 å¼ å›¾ï¼Œç„¶ååŠ ä¸Šæˆ‘è‡ªå·±çš„ä¸€å¼ ï¼Œè®¾ç½®æƒé‡ï¼Œç„¶åéšæœºã€‚æ¯æ¬¡åˆ·æ–°åï¼Œå°±ä¼šå»åå°éšæœºæ‹¿ä¸€å¼ å›¾çš„é“¾æ¥ã€‚</p><h3 id="2-æ’¸ä¸€ä¸ªç®€å•çš„-devops"><a href="#2-æ’¸ä¸€ä¸ªç®€å•çš„-devops" class="headerlink" title="2. æ’¸ä¸€ä¸ªç®€å•çš„ devops"></a>2. <del>æ’¸ä¸€ä¸ªç®€å•çš„ devops</del></h3><p>æœ¬åœ°æäº¤ä»£ç åˆ° gitee åï¼Œ ecs æ¥å»ä»£ç æ‰“åŒ…éƒ¨ç½²</p><h3 id="3-ä¸ƒç‰›äº‘å›¾åºŠ"><a href="#3-ä¸ƒç‰›äº‘å›¾åºŠ" class="headerlink" title="3. ä¸ƒç‰›äº‘å›¾åºŠ"></a>3. <del>ä¸ƒç‰›äº‘å›¾åºŠ</del></h3><p>æä¸€ä¸ªä¸Šä¼ ç•Œé¢ï¼Œç”¨æ¥å­˜å‚¨å›¾ç‰‡ï¼ŒåŒæ—¶è·å–å›¾ç‰‡è·¯å¾„</p><h2 id="ISSUE"><a href="#ISSUE" class="headerlink" title="ISSUE"></a>ISSUE</h2><h3 id="Q1-æ‰“å¼€çš„æ–‡ç« é¡µé¢ï¼Œéƒ½å˜æˆäº†ä¸‹è½½é¡µé¢â€¦"><a href="#Q1-æ‰“å¼€çš„æ–‡ç« é¡µé¢ï¼Œéƒ½å˜æˆäº†ä¸‹è½½é¡µé¢â€¦" class="headerlink" title="Q1 æ‰“å¼€çš„æ–‡ç« é¡µé¢ï¼Œéƒ½å˜æˆäº†ä¸‹è½½é¡µé¢â€¦"></a>Q1 æ‰“å¼€çš„æ–‡ç« é¡µé¢ï¼Œéƒ½å˜æˆäº†ä¸‹è½½é¡µé¢â€¦</h3><p>Aï¼šåœ¨ _config.yml ä¸­ permalink ï¼Œ ä¸€å®šè¦æ³¨æ„ç»“å°¾åŠ ä¸Šæ–œæ (/) !!! like thisï¼š <code>:title/</code></p><h3 id="Q2-Local-hexo-not-found-in-xxx"><a href="#Q2-Local-hexo-not-found-in-xxx" class="headerlink" title="Q2 Local hexo not found in xxx"></a>Q2 Local hexo not found in xxx</h3><pre><code>ERROR Local hexo not found in xxxERROR Try running: 'npm install hexo --save'</code></pre><p>Aï¼š å¼€ç©ç¬‘ï¼Œ æ˜æ˜å·²ç»è·‘äº†å‘½ä»¤ <code>sudo npm install -g hexo-cli</code> ï¼Œ ä½ è¿˜ç»™æˆ‘æç¤ºè¿™ä¸ªï¼Ÿ</p><p>å¯¹æˆ‘è€Œè¨€ï¼Œ æˆ‘æ˜¯å› ä¸ºæ–° clone ä¸‹æ¥çš„æ–‡ä»¶ï¼Œ è¿˜æ²¡æ‰§è¡Œ <code>npm i</code> ï¼Œ æ‰§è¡Œåï¼Œ å°± ok äº†ã€‚</p><p>ä½†æ˜¯æœè§£å†³æ–¹æ¡ˆçš„æ—¶å€™ï¼Œæœ‰äººè¯´æ˜¯å› ä¸º node_modules çš„é—®é¢˜ï¼Œè¦åˆ äº†é‡æ–° <code>npm i</code> ï¼Œå¯ä»¥ä¸€è¯•ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
            <tag> nginx </tag>
            
            <tag> https </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OAUTH2 Protocol</title>
      <link href="/others/oauth/"/>
      <url>/others/oauth/</url>
      
        <content type="html"><![CDATA[<h1 id="oauth2"><a href="#oauth2" class="headerlink" title="oauth2"></a>oauth2</h1><h2 id="oauth2-ä»‹ç»"><a href="#oauth2-ä»‹ç»" class="headerlink" title="oauth2 ä»‹ç»"></a>oauth2 ä»‹ç»</h2><p><a href="https://tools.ietf.org/html/rfc6749" target="_blank" rel="noopener">OATUH 2.0 RFC</a></p><p><a href="http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html" target="_blank" rel="noopener">OATUH 2.0 ç§‘æ™®</a></p><h2 id="oauth2-çš„å››ç§æˆæƒæ¨¡å¼"><a href="#oauth2-çš„å››ç§æˆæƒæ¨¡å¼" class="headerlink" title="oauth2 çš„å››ç§æˆæƒæ¨¡å¼"></a>oauth2 çš„å››ç§æˆæƒæ¨¡å¼</h2><h3 id="æˆæƒç æˆæƒæ¨¡å¼-Authorization-Code-Grant"><a href="#æˆæƒç æˆæƒæ¨¡å¼-Authorization-Code-Grant" class="headerlink" title="æˆæƒç æˆæƒæ¨¡å¼(Authorization Code Grant)"></a>æˆæƒç æˆæƒæ¨¡å¼(Authorization Code Grant)</h3><p>å‚è§ <a href="https://tools.ietf.org/html/rfc6749#section-4.1" target="_blank" rel="noopener">RFC Code Grant</a></p><h4 id="æµç¨‹å›¾"><a href="#æµç¨‹å›¾" class="headerlink" title="æµç¨‹å›¾"></a>æµç¨‹å›¾</h4><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401092604.png-growing" alt="code grant flow"></p><p>å¦‚å›¾ç¤º</p><ul><li>client ä¸ºç”¨æˆ·</li><li>user-agent ä¸€èˆ¬æŒ‡æµè§ˆå™¨</li><li>resource owner: èµ„æºæ‹¥æœ‰è€…</li><li>Authorization Server: è®¤è¯æœåŠ¡å™¨</li></ul><h4 id="æ­¥éª¤è§£é‡Š"><a href="#æ­¥éª¤è§£é‡Š" class="headerlink" title="æ­¥éª¤è§£é‡Š"></a>æ­¥éª¤è§£é‡Š</h4><h5 id="A"><a href="#A" class="headerlink" title="A)"></a>A)</h5><p>å®¢æˆ·ç«¯é€šè¿‡ä»£ç†(web browser) å‘èµ„æºæœåŠ¡å™¨è¯·æ±‚èµ„æºï¼Œuser agent ä»£ç†åˆ°æˆæƒæœåŠ¡å™¨ã€‚è¿™ä¸€æ­¥ï¼Œè¯·æ±‚é“¾æ¥ä¸€èˆ¬é•¿è¿™ä¸ªæ ·å­ï¼š</p><pre><code>https://xxx.com/oauth/authorize?  response_type=code&amp;  client_id=xxx&amp;  redirect_uri=client_call_uri&amp;  scope=base&amp;  state=xxx</code></pre><ul><li>response_type:  æŒ‡å®šæˆæƒç±»å‹ï¼Œè¿™é‡Œå›ºå®šä¸º <code>code</code> (ä¸‹é¢ä¼šæœ‰ passwordï¼Œtoken, client_credentials)</li><li>client_id: å®¢æˆ· idï¼Œ è¡¨æ˜è¯·æ±‚äººèº«ä»½</li><li>redirect_uri: æˆæƒåé‡å®šå‘çš„åœ°å€</li><li>scope: æˆæƒèŒƒå›´</li><li>state: é‡å®šå‘åï¼Œä¼šåŸæ ·è¿”å›ï¼Œ å¯ä»¥ç”¨æ¥é˜²æ­¢ csrf æ”»å‡»</li></ul><h5 id="B"><a href="#B" class="headerlink" title="B)"></a>B)</h5><p>æˆæƒæœåŠ¡å™¨è¦å¯¹èµ„æºæ‰€æœ‰è€…è¿›è¡Œèº«ä»½è®¤è¯å¹¶ç¡®è®¤èµ„æºæ‰€æœ‰è€…æ˜¯æˆäºˆè¿˜æ˜¯æ‹’ç»è¯¥è¯·æ±‚ã€‚</p><h5 id="C"><a href="#C" class="headerlink" title="C)"></a>C)</h5><p>æˆæƒæœåŠ¡å™¨è·³è½¬ redirect_uri ï¼Œ åŒæ—¶é™„å¸¦ä¸€ä¸ªæˆæƒç (code): <code>https://redirect_uri?code=xxx&amp;state=xxx</code></p><h5 id="D"><a href="#D" class="headerlink" title="D)"></a>D)</h5><p>ç”¨æˆ·æ ¹æ®è¿™ä¸ª code ï¼Œ è¯·æ±‚ tokenï¼Œ è¿™æ­¥çš„é“¾æ¥ä¸€èˆ¬é•¿è¿™ä¸ªæ ·å­ï¼š</p><pre><code>https://xxx/oauth/token? grant_type=authorization_code&amp; code=xxx&amp; redirect_uri=xxx&amp; client_id=xxx&amp; client_secret=xxx</code></pre><ul><li><p>grant_type: æˆæƒç±»å‹ï¼Œ è¿™é‡Œå›ºå®šä¸º <code>authorization_code</code></p></li><li><p>code: å°±æ˜¯ä½ åˆšåˆšæ‹¿åˆ°çš„ code</p></li><li><p>redirect_uri: è¿™ä¸€æ­¥è¦ä¿è¯è¿™é‡Œçš„ uri å’Œä¹‹å‰çš„ uri ä¸€è‡´</p></li><li><p>client_id &amp; client_secret :  èº«ä»½éªŒè¯</p></li></ul><h5 id="E"><a href="#E" class="headerlink" title="E)"></a>E)</h5><p>è¿”å› access tokenï¼Œ (æˆ–è€…å¸¦ä¸Š refresh token)</p><pre class=" language-json"><code class="language-json">HTTP/<span class="token number">1.1</span> <span class="token number">200</span> OKContent-Type<span class="token operator">:</span> application/json<span class="token punctuation">;</span>charset=UTF<span class="token number">-8</span>Cache-Control<span class="token operator">:</span> no-storePragma<span class="token operator">:</span> no-cache<span class="token punctuation">{</span>    <span class="token property">"access_token"</span><span class="token operator">:</span><span class="token string">"2YotnFZFEjr1zCsicMWpAA"</span><span class="token punctuation">,</span>    <span class="token property">"token_type"</span><span class="token operator">:</span><span class="token string">"example"</span><span class="token punctuation">,</span>    <span class="token property">"expires_in"</span><span class="token operator">:</span><span class="token number">3600</span><span class="token punctuation">,</span>    <span class="token property">"refresh_token"</span><span class="token operator">:</span><span class="token string">"tGzv3JOkF0XG5Qx2TlKWIA"</span><span class="token punctuation">,</span>    <span class="token property">"example_parameter"</span><span class="token operator">:</span><span class="token string">"example_value"</span><span class="token punctuation">}</span></code></pre><h3 id="éšè—æˆæƒæ¨¡å¼-Implicit-Grant"><a href="#éšè—æˆæƒæ¨¡å¼-Implicit-Grant" class="headerlink" title="éšè—æˆæƒæ¨¡å¼(Implicit Grant)"></a>éšè—æˆæƒæ¨¡å¼(Implicit Grant)</h3><p><a href="https://tools.ietf.org/html/rfc6749#section-4.2" target="_blank" rel="noopener">https://tools.ietf.org/html/rfc6749#section-4.2</a></p><p>ç•¥</p><h3 id="å¯†ç æˆæƒæ¨¡å¼-Resource-Owner-Password-Credentials-Grant"><a href="#å¯†ç æˆæƒæ¨¡å¼-Resource-Owner-Password-Credentials-Grant" class="headerlink" title="å¯†ç æˆæƒæ¨¡å¼(Resource Owner Password Credentials Grant)"></a>å¯†ç æˆæƒæ¨¡å¼(Resource Owner Password Credentials Grant)</h3><p><a href="https://tools.ietf.org/html/rfc6749#section-4.3" target="_blank" rel="noopener">https://tools.ietf.org/html/rfc6749#section-4.3</a></p><p>ç•¥</p><h3 id="å®¢æˆ·ç«¯å‡­è¯æˆæƒæ¨¡å¼-Client-Credentials-Grant"><a href="#å®¢æˆ·ç«¯å‡­è¯æˆæƒæ¨¡å¼-Client-Credentials-Grant" class="headerlink" title="å®¢æˆ·ç«¯å‡­è¯æˆæƒæ¨¡å¼(Client Credentials Grant)"></a>å®¢æˆ·ç«¯å‡­è¯æˆæƒæ¨¡å¼(Client Credentials Grant)</h3><p><a href="https://tools.ietf.org/html/rfc6749#section-4.4" target="_blank" rel="noopener">https://tools.ietf.org/html/rfc6749#section-4.4</a></p><p>ç•¥</p><h2 id="å¾®ä¿¡ç¤ºä¾‹"><a href="#å¾®ä¿¡ç¤ºä¾‹" class="headerlink" title="å¾®ä¿¡ç¤ºä¾‹"></a>å¾®ä¿¡ç¤ºä¾‹</h2><p><a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html#0" target="_blank" rel="noopener">å¾®ä¿¡ OAUTH 2.0 å¯¹æ¥æ–‡æ¡£</a></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401093011.png-growing" alt="wechat oauth2 flow"></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> others </category>
          
      </categories>
      
      
        <tags>
            
            <tag> protocol </tag>
            
            <tag> network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux åŸºç¡€ç¯å¢ƒæ­å»ºå®‰è£…æŒ‡åŒ—</title>
      <link href="/linux/install/"/>
      <url>/linux/install/</url>
      
        <content type="html"><![CDATA[<h1 id="Linux-åŸºç¡€ç¯å¢ƒå®‰è£…æŒ‡åŒ—"><a href="#Linux-åŸºç¡€ç¯å¢ƒå®‰è£…æŒ‡åŒ—" class="headerlink" title="Linux åŸºç¡€ç¯å¢ƒå®‰è£…æŒ‡åŒ—"></a>Linux åŸºç¡€ç¯å¢ƒå®‰è£…æŒ‡åŒ—</h1><p><a href="https://opsx.alibaba.com/mirror" target="_blank" rel="noopener">é˜¿é‡Œå·´å·´å¼€æºç«™ç‚¹</a>  </p><p>ä¸ªäººå®‰è£…ç¯å¢ƒä¸º <code>CentOS Linux release 7.6.1810 (Core)</code> </p><h2 id="zsh-amp-oh-my-zsh"><a href="#zsh-amp-oh-my-zsh" class="headerlink" title="zsh &amp; oh my zsh"></a>zsh &amp; oh my zsh</h2><ul><li><a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Installing-ZSH" target="_blank" rel="noopener">zsh å®‰è£…</a> </li></ul><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> yum -y update <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> yum -y <span class="token function">install</span> zsh</code></pre><ul><li><a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="noopener">oh my zsh å®‰è£…</a></li></ul><pre class=" language-bash"><code class="language-bash">sh -c <span class="token string">"<span class="token variable"><span class="token variable">$(</span>curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh<span class="token variable">)</span></span>"</span></code></pre><ul><li><a href="https://github.com/powerline/fonts" target="_blank" rel="noopener">powerline å®‰è£…</a></li></ul><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># install git if not exist</span><span class="token function">sudo</span> yum <span class="token function">install</span> -y <span class="token function">git</span><span class="token function">git</span> clone https://github.com/powerline/fonts.git --depth<span class="token operator">=</span>1<span class="token function">cd</span> fonts./install.sh<span class="token function">cd</span> <span class="token punctuation">..</span><span class="token function">rm</span> -fr fonts</code></pre><h2 id="add-user"><a href="#add-user" class="headerlink" title="add user"></a>add user</h2><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æ·»åŠ ç”¨æˆ·</span>adduser dylan<span class="token comment" spellcheck="true"># æ·»åŠ å¯†ç </span><span class="token function">passwd</span> dylan<span class="token comment" spellcheck="true"># sudo å‘½ä»¤æ·»åŠ </span><span class="token comment" spellcheck="true"># sudoers æ–‡ä»¶æŸ¥æ‰¾</span><span class="token function">whereis</span> sudoers<span class="token comment" spellcheck="true">#æ·»åŠ æ—¶ï¼Œ è¦æ³¨æ„ sudoers æ–‡ä»¶æ˜¯åªè¯»çš„ï¼Œ å…ˆä¿®æ”¹ä¸ºå¯å†™ï¼Œä¿®æ”¹å®Œæˆåå†å˜ä¸ºå¯è¯»</span><span class="token function">chmod</span> -v u+w /etc/sudoers<span class="token function">chmod</span> -v u-w /etc/sudoers<span class="token comment" spellcheck="true"># æŸ¥çœ‹ç»„</span><span class="token function">sudo</span> <span class="token function">cat</span> /etc/group <span class="token operator">|</span> <span class="token function">grep</span> wheel<span class="token comment" spellcheck="true"># æ·»åŠ ä¸€ä¸ªæ–°ç»„ group-test</span><span class="token function">sudo</span> <span class="token function">groupadd</span> group-test <span class="token comment" spellcheck="true"># å°†ç™»é™†ç”¨æˆ·åŠ å…¥åˆ° wheel ç”¨æˆ·ç»„ä¸­ï¼Œ -a : append</span><span class="token function">sudo</span> gpasswd -a <span class="token variable">$USER</span> wheel  <span class="token comment" spellcheck="true"># æ›´æ–° wheel ç»„</span>newgrp wheel  </code></pre><p>è¿™é‡Œä¸å»ºè®®ç›´æ¥å°†ç”¨äºèµ‹äºˆ root æƒé™ï¼Œä¸€èˆ¬çš„åšæ³•æ˜¯æ”¾å¼€ wheel ç»„ï¼Œå°†ç”¨æˆ·æ·»åŠ åˆ° wheel ç»„ï¼Œé€šè¿‡ <code>visudo</code>  å‘½ä»¤æ‰“å¼€ /etc/sudoers , å°†</p><blockquote><p>#Allows people in group wheel to run all commands</p><p>#%wheel  ALL=(ALL)       ALL</p></blockquote><p>ä¸­ %wheel å‰çš„ # å»æ‰ï¼Œ ç„¶åå°†ç”¨æˆ·æ·»åŠ åˆ° wheel ç»„ã€‚</p><h2 id="iptables"><a href="#iptables" class="headerlink" title="iptables"></a>iptables</h2><ol><li>å¼€/é‡å¯/å¼€æœºè‡ªå¯åŠ¨</li></ol><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl start iptables<span class="token function">sudo</span> systemctl restart iptables<span class="token function">sudo</span> systemctl <span class="token function">enable</span> iptables</code></pre><ol start="2"><li>ç¼–è¾‘ iptables æ–‡ä»¶</li></ol><p>åœ¨ <strong><code>/etc/sysconfig/iptables</code></strong>  æ–‡ä»¶ä¸­æ·»åŠ è§„åˆ™</p><h2 id="é…ç½®å…å¯†ç™»å½•"><a href="#é…ç½®å…å¯†ç™»å½•" class="headerlink" title="é…ç½®å…å¯†ç™»å½•"></a>é…ç½®å…å¯†ç™»å½•</h2><h3 id="1-ç”Ÿæˆ-ssh-ç§˜é’¥"><a href="#1-ç”Ÿæˆ-ssh-ç§˜é’¥" class="headerlink" title="1. ç”Ÿæˆ ssh ç§˜é’¥"></a>1. ç”Ÿæˆ ssh ç§˜é’¥</h3><p>å‚è€ƒ <a href="https://www.cnblogs.com/yanglang/p/9563496.html" target="_blank" rel="noopener">è¿™é‡Œ</a></p><pre class=" language-bash"><code class="language-bash">ssh-keygen -t rsa -C <span class="token string">"peifeng"</span> -f filepath</code></pre><ul><li>-t æŒ‡å®šå¯†é’¥ç±»å‹ï¼Œé»˜è®¤æ˜¯ rsa ï¼Œå¯ä»¥çœç•¥ã€‚</li><li>-C è®¾ç½®æ³¨é‡Šæ–‡å­—ï¼Œæ¯”å¦‚é‚®ç®±ã€‚</li><li>-f æŒ‡å®šå¯†é’¥æ–‡ä»¶å­˜å‚¨æ–‡ä»¶åã€‚é»˜è®¤ä¸º ~.ssh/ ç›®å½•<h3 id="2-é…ç½®å…å¯†ç™»å½•"><a href="#2-é…ç½®å…å¯†ç™»å½•" class="headerlink" title="2. é…ç½®å…å¯†ç™»å½•"></a>2. é…ç½®å…å¯†ç™»å½•</h3></li></ul><p>A æœºå™¨å…å¯†ç™»å½•åˆ° B æœºå™¨ï¼Œ é»˜è®¤éƒ½å·²ç”Ÿæˆ ssh ç§˜é’¥ã€‚</p><ol><li>ç™»å½• A æœºå™¨ï¼Œè¿è¡Œå‘½ä»¤ ssh-copy-id å‘é€æœ¬åœ° id_rsa.pub åˆ° B æœºå™¨çš„ ~/.ssh/authorized_keys æ–‡ä»¶ä¸­<pre class=" language-bash"><code class="language-bash">ssh-copy-id dylan@B_ip</code></pre></li></ol><ol start="2"><li>é…ç½® A æœºå™¨çš„ ~/.ssh/config æ–‡ä»¶(å¦‚æœæ²¡æœ‰ï¼Œ è¯·è‡ªå·±æ·»åŠ ï¼Œ æ³¨æ„è¯¥æ–‡ä»¶çš„æƒé™è‡³å°‘ä¸º 600 )ã€‚ å‚è€ƒ <a href="https://www.cnblogs.com/lingyejun/p/7367596.html" target="_blank" rel="noopener">è¿™é‡Œ</a><pre><code>Host A_alias HostName B_machine_ip User dylan Port 22 IdentityFile ~/.ssh/id_rsa</code></pre></li></ol><ul><li>Host åˆ«åï¼Œ ç™»å½•æ—¶ï¼Œ ç›´æ¥é€šè¿‡è¯¥åˆ«åç™»å½•</li><li>HostNameï¼š ä¸»æœºåæˆ–ä¸»æœº ip</li><li>Userï¼š ç™»å½•çš„ç”¨æˆ·å</li><li>Portï¼š ç«¯å£</li><li>IdentityFileï¼š ç§˜é’¥æ–‡ä»¶è·¯å¾„</li></ul><ol start="3"><li>ç™»å½•</li></ol><pre class=" language-bash"><code class="language-bash"><span class="token function">ssh</span> A_alias</code></pre><h2 id="docker-install"><a href="#docker-install" class="headerlink" title="docker install"></a>docker install</h2><p>å‚è€ƒ </p><ul><li><p><a href="https://docs.docker.com/install/linux/docker-ce/centos/" target="_blank" rel="noopener">https://docs.docker.com/install/linux/docker-ce/centos/</a> </p></li><li><p>stable åˆ—è¡¨ï¼š <a href="https://download.docker.com/linux/centos/7/x86_64/stable/Packages/" target="_blank" rel="noopener">https://download.docker.com/linux/centos/7/x86_64/stable/Packages/</a></p></li><li><p>é˜¿é‡Œäº‘ stable åˆ—è¡¨ï¼š <a href="https://mirrors.aliyun.com/docker-ce/linux/centos/7/x86_64/stable/Packages/" target="_blank" rel="noopener">https://mirrors.aliyun.com/docker-ce/linux/centos/7/x86_64/stable/Packages/</a></p></li></ul><h3 id="1-é€šè¿‡-docker-æº-å®‰è£…"><a href="#1-é€šè¿‡-docker-æº-å®‰è£…" class="headerlink" title="1. é€šè¿‡ docker æº å®‰è£…"></a>1. é€šè¿‡ docker æº å®‰è£…</h3><h4 id="1-1-ç§»é™¤è€ç‰ˆæœ¬ï¼Œ-å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å®‰è£…ï¼Œ-å¯ä»¥å¿½ç•¥"><a href="#1-1-ç§»é™¤è€ç‰ˆæœ¬ï¼Œ-å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å®‰è£…ï¼Œ-å¯ä»¥å¿½ç•¥" class="headerlink" title="1.1 ç§»é™¤è€ç‰ˆæœ¬ï¼Œ å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å®‰è£…ï¼Œ å¯ä»¥å¿½ç•¥"></a>1.1 ç§»é™¤è€ç‰ˆæœ¬ï¼Œ å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å®‰è£…ï¼Œ å¯ä»¥å¿½ç•¥</h4><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> yum remove docker \                  docker-client \                  docker-client-latest \                  docker-common \                  docker-latest \                  docker-latest-logrotate \                  docker-logrotate \                  docker-engine</code></pre><h4 id="1-2-å®‰è£…å¿…è¦çš„å·¥å…·"><a href="#1-2-å®‰è£…å¿…è¦çš„å·¥å…·" class="headerlink" title="1.2 å®‰è£…å¿…è¦çš„å·¥å…·"></a>1.2 å®‰è£…å¿…è¦çš„å·¥å…·</h4><p><code>yum-utils</code> provides the <code>yum-config-manager</code> utility, and <code>device-mapper-persistent-data</code> and <code>lvm2</code>are required by the <code>devicemapper</code> storage driver.</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> -y yum-utils \  device-mapper-persistent-data \  lvm2</code></pre><h4 id="1-3-è®¾ç½®å¯ç”¨çš„-docker-ce-repository"><a href="#1-3-è®¾ç½®å¯ç”¨çš„-docker-ce-repository" class="headerlink" title="1.3 è®¾ç½®å¯ç”¨çš„ docker-ce repository"></a>1.3 è®¾ç½®å¯ç”¨çš„ docker-ce repository</h4><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> yum-config-manager \    --add-repo \    https://download.docker.com/linux/centos/docker-ce.repo <span class="token comment" spellcheck="true">## è¿™é‡Œå¯ä»¥ä½¿ç”¨é˜¿é‡Œäº‘çš„ docker repo</span> <span class="token function">sudo</span> yum-config-manager \ --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo<span class="token function">sudo</span> yum makecache fast</code></pre><h4 id="1-4-å®‰è£…æœ€æ–°ç‰ˆ-docker-ceï¼Œ-containerd"><a href="#1-4-å®‰è£…æœ€æ–°ç‰ˆ-docker-ceï¼Œ-containerd" class="headerlink" title="1.4 å®‰è£…æœ€æ–°ç‰ˆ docker-ceï¼Œ containerd"></a>1.4 å®‰è£…æœ€æ–°ç‰ˆ docker-ceï¼Œ containerd</h4><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> yum -y <span class="token function">install</span> docker-ce docker-ce-cli containerd.io<span class="token comment" spellcheck="true">## å¯ä»¥æŒ‡å®šç‰ˆæœ¬å®‰è£…</span><span class="token function">sudo</span> yum -y <span class="token function">install</span> docker-ce-19.03.0 docker-ce-cli-19.03.0 containerd.io<span class="token comment" spellcheck="true">## å®‰è£…è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç° containerd.io > xxx çš„æç¤ºï¼Œ å¯ä»¥å…ˆå®‰è£… containerd</span><span class="token comment" spellcheck="true">## https://download.docker.com/linux/centos/7/x86_64/stable/Packages/</span><span class="token comment" spellcheck="true">## åˆ°å®˜ç½‘æŸ¥æ‰¾ç‰ˆæœ¬åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ (centos8)</span><span class="token function">sudo</span> dnf <span class="token function">install</span> https://download.docker.com/linux/centos/7/x86_64/stable/Packages/containerd.io-1.2.6-3.3.el7.x86_64.rpm<span class="token comment" spellcheck="true">## å†å®‰è£… docker-ce å’Œ docker-ce-cli</span><span class="token function">sudo</span> yum -y <span class="token function">install</span> docker-ce docker-ce-cli</code></pre><h4 id="1-5-å¼€å¯-docker"><a href="#1-5-å¼€å¯-docker" class="headerlink" title="1.5 å¼€å¯ docker"></a>1.5 å¼€å¯ docker</h4><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl start docker</code></pre><h4 id="1-6-éªŒè¯æ˜¯å¦æˆåŠŸ"><a href="#1-6-éªŒè¯æ˜¯å¦æˆåŠŸ" class="headerlink" title="1.6 éªŒè¯æ˜¯å¦æˆåŠŸ"></a>1.6 éªŒè¯æ˜¯å¦æˆåŠŸ</h4><pre class=" language-bash"><code class="language-bash">docker run hello-world</code></pre><h4 id="1-7-ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿå™¨"><a href="#1-7-ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿå™¨" class="headerlink" title="1.7 ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿå™¨"></a>1.7 ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿå™¨</h4><p><a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors" target="_blank" rel="noopener">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a></p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 1. åˆ›å»ºç›®å½•ï¼Œ å¦‚æœå­˜åœ¨è¯·å¿½ç•¥</span><span class="token function">sudo</span> <span class="token function">mkdir</span> -p /etc/docker<span class="token comment" spellcheck="true"># 2. å†™å…¥é˜¿é‡Œäº‘ registry</span><span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;</span>-<span class="token string">'EOF'</span><span class="token punctuation">{</span>  <span class="token string">"registry-mirrors"</span><span class="token keyword">:</span> <span class="token punctuation">[</span><span class="token string">"ä½ çš„åŠ é€Ÿåœ°å€"</span><span class="token punctuation">]</span><span class="token punctuation">}</span>EOF<span class="token comment" spellcheck="true"># 3. é‡å¯</span><span class="token function">sudo</span> systemctl daemon-reload<span class="token function">sudo</span> systemctl restart docker</code></pre><h4 id="1-8-å…-sudo-ä½¿ç”¨-docker"><a href="#1-8-å…-sudo-ä½¿ç”¨-docker" class="headerlink" title="1.8 å… sudo ä½¿ç”¨ docker"></a>1.8 å… sudo ä½¿ç”¨ docker</h4><p>å½“æˆ‘ä»¬è¿è¡Œå¦‚ <code>docker info</code> æ—¶ï¼Œ ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯(é root ç”¨æˆ·)</p><pre><code>Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.39/info: dial unix /var/run/docker.sock: connect: permission denied</code></pre><p>åŸå› ï¼š</p><blockquote><p>Manage Docker as a non-root user</p><p>The docker daemon binds to a Unix socket instead of a TCP port. By default that Unix socket is owned by the user root and other users can only access it using sudo. The docker daemon always runs as the root user.</p><p>If you donâ€™t want to use sudo when you use the docker command, create a Unix group called docker and add users to it. When the docker daemon starts, it makes the ownership of the Unix socket read/writable by the docker group.</p></blockquote><p>å¤§æ„ä¸ºï¼š docker è¿›ç¨‹ä½¿ç”¨ Unix Socket è€Œä¸æ˜¯ TCP ç«¯å£ã€‚è€Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒUnix socket å±äº root ç”¨æˆ·ï¼Œéœ€è¦ root æƒé™æ‰èƒ½è®¿é—®ã€‚</p><blockquote><p><strong>docker å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šé»˜è®¤èµ‹äºˆåå­—ä¸º docker çš„ç”¨æˆ·ç»„è¯»å†™ Unix socket çš„æƒé™ï¼Œå› æ­¤åªè¦åˆ›å»º docker ç”¨æˆ·ç»„ï¼Œå¹¶å°†å½“å‰ç”¨æˆ·åŠ å…¥åˆ° docker ç”¨æˆ·ç»„ä¸­ï¼Œé‚£ä¹ˆå½“å‰ç”¨æˆ·å°±æœ‰æƒé™è®¿é—® Unix socket äº†ï¼Œè¿›è€Œä¹Ÿå°±å¯ä»¥æ‰§è¡Œ docker ç›¸å…³å‘½ä»¤</strong></p></blockquote><p>è§£å†³åŠæ³•</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æŸ¥çœ‹ docker ç”¨æˆ·ç»„æ˜¯å¦å·²å­˜åœ¨</span><span class="token function">sudo</span> <span class="token function">cat</span> /etc/group <span class="token operator">|</span> <span class="token function">grep</span> docker <span class="token comment" spellcheck="true"># æ·»åŠ dockerç”¨æˆ·ç»„ï¼Œ å¦‚æœ docker ç”¨æˆ·ç»„å·²å­˜åœ¨ï¼Œ åˆ™ä¸éœ€æ‰§è¡Œ</span><span class="token function">sudo</span> <span class="token function">groupadd</span> docker <span class="token comment" spellcheck="true"># å°†ç™»é™†ç”¨æˆ·åŠ å…¥åˆ° docker ç”¨æˆ·ç»„ä¸­ï¼Œ -a : append</span><span class="token function">sudo</span> gpasswd -a <span class="token variable">$USER</span> docker  <span class="token comment" spellcheck="true"># æ›´æ–°ç”¨æˆ·ç»„</span>newgrp docker  <span class="token comment" spellcheck="true"># æµ‹è¯• docker å‘½ä»¤æ˜¯å¦å¯ä»¥åœ¨æ—  sudo æ—¶æ­£å¸¸ä½¿ç”¨</span>docker info  </code></pre><h3 id="2-é€šè¿‡å®‰è£…åŒ…å®‰è£…"><a href="#2-é€šè¿‡å®‰è£…åŒ…å®‰è£…" class="headerlink" title="2. é€šè¿‡å®‰è£…åŒ…å®‰è£…"></a>2. é€šè¿‡å®‰è£…åŒ…å®‰è£…</h3><ol><li>é€šè¿‡ <a href="https://download.docker.com/linux/centos/7/x86_64/stable/Packages/" target="_blank" rel="noopener">https://download.docker.com/linux/centos/7/x86_64/stable/Packages/</a> è·å–ä½ éœ€è¦çš„ç‰ˆæœ¬çš„ <code>.rpm</code> å®‰è£…åŒ…æ–‡ä»¶</li><li>å®‰è£…</li></ol><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> /path/to/package.rpm</code></pre><ol start="3"><li>è¿è¡Œ docker</li></ol><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl start docker</code></pre><ol start="4"><li>éªŒè¯</li></ol><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> docker run hello-world</code></pre><h3 id="3-é€šè¿‡å®‰è£…è„šæœ¬å®‰è£…"><a href="#3-é€šè¿‡å®‰è£…è„šæœ¬å®‰è£…" class="headerlink" title="3. é€šè¿‡å®‰è£…è„šæœ¬å®‰è£…"></a>3. é€šè¿‡å®‰è£…è„šæœ¬å®‰è£…</h3><pre class=" language-bash"><code class="language-bash">curl -fsSL https://get.docker.com -o get-docker.sh<span class="token function">sudo</span> sh get-docker.sh</code></pre><h2 id="docker-uninstall-upgrade"><a href="#docker-uninstall-upgrade" class="headerlink" title="docker uninstall/upgrade"></a>docker uninstall/upgrade</h2><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å¸è½½ docker</span><span class="token function">sudo</span> yum remove docker-ce<span class="token comment" spellcheck="true"># åˆ é™¤ images/volumes/containers ç­‰</span><span class="token function">sudo</span> <span class="token function">rm</span> -rf /var/lib/docker</code></pre><p>ä¸Šé¢æ˜¯å®˜æ–¹æ–‡æ¡£çš„è¯´æ³•ï¼Œ å®é™…æ“ä½œä¸­ï¼Œå¯èƒ½ä¼šå‡ºç° client å’Œ server ç‰ˆæœ¬ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œå¯ä»¥å…ˆéƒ½åˆ é™¤æ‰</p><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æŸ¥æ‰¾å·²å®‰è£…çš„ docker ç›¸å…³è½¯ä»¶åŒ…</span>rpm -qa <span class="token operator">|</span> <span class="token function">grep</span> docker<span class="token comment" spellcheck="true"># å¸è½½åˆ—å‡ºçš„è½¯ä»¶åŒ…</span> <span class="token function">sudo</span> yum remove docker-ce-cli-19.03.0-3.el7.x86_64 docker-ce-19.03.0-3.el7.x86_64 <span class="token comment" spellcheck="true"># ä¹‹åå®‰è£…éœ€è¦çš„ç‰ˆæœ¬å³å¯</span> <span class="token function">sudo</span> yum -y <span class="token function">install</span> docker-ce-18.09.8 docker-ce-cli-18.09.8 containerd.io <span class="token comment" spellcheck="true"># å®‰è£…å®Œæˆåï¼Œ å¯åŠ¨ docker</span> <span class="token function">sudo</span> systemctl start docker <span class="token comment" spellcheck="true"># å¯åŠ¨æ‰€æœ‰å®¹å™¨</span> docker restart <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -aq<span class="token variable">)</span></span> <span class="token comment" spellcheck="true"># æ£€æŸ¥å®¹å™¨çŠ¶æ€ï¼</span> <span class="token function">sudo</span> systemctl status docker</code></pre><h3 id="é™„ï¼š-docker-clean"><a href="#é™„ï¼š-docker-clean" class="headerlink" title="é™„ï¼š docker clean"></a>é™„ï¼š docker clean</h3><pre class=" language-shell"><code class="language-shell"># ç±»ä¼¼ linux çš„ df, docker ä¼šå±•ç¤º docker çš„ç£ç›˜ä½¿ç”¨æƒ…å†µdocker system df# docker çš„é»˜è®¤å­˜ç›˜ç›®å½•ä¸€èˆ¬åœ¨ /var/lib/docker ä¸‹ï¼Œ å¯ä»¥è¿›å»çœ‹å…·ä½“æƒ…å†µ# è¯¥å‘½ä»¤å¯ä»¥ç”¨æ¥æ¸…ç†ç£ç›˜ï¼Œåˆ é™¤å…³é—­çš„å®¹å™¨ï¼Œæ— ç”¨çš„ volume å’Œ network# åŒ…æ‹¬ dangling(æ—  tag) é•œåƒ ä»¥åŠ cache# è¯¥å‘½ä»¤è¿˜å¯ä»¥åŠ  -a ï¼Œä¼šæŠŠæ‰€æœ‰æ²¡æœ‰ container å…³è”çš„ image éƒ½åˆ æ‰ï¼Œåƒä¸‡æ…ç”¨ï¼ï¼ï¼docker system prune</code></pre><h2 id="v2ray-amp-ssï¼ˆvultrï¼‰"><a href="#v2ray-amp-ssï¼ˆvultrï¼‰" class="headerlink" title="v2ray &amp; ssï¼ˆvultrï¼‰"></a>v2ray &amp; ssï¼ˆvultrï¼‰</h2><p>ä½¿ç”¨ vultr ecs æ—¶ï¼Œä¸€èˆ¬ç”¨æ¥æ­å»ºè‡ªå·±çš„æ¢¯å­ï¼Œç°åœ¨æ¯”è¾ƒå¸¸ç”¨çš„æœ‰ v2ray &amp; ss ã€‚</p><ul><li><a href="https://raw.githubusercontent.com/233boy/v2ray/master/install.sh" target="_blank" rel="noopener">https://raw.githubusercontent.com/233boy/v2ray/master/install.sh</a></li></ul><p>å¯å‚è€ƒ github ä¸Šå„ç±»ä¸€é”®å®‰è£…è„šæœ¬ã€‚</p><h2 id="NGINX"><a href="#NGINX" class="headerlink" title="NGINX"></a>NGINX</h2><p>nginx ä¸åœ¨é»˜è®¤çš„ yum æºä¸­ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥åŠ å…¥</p><h3 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1. å®‰è£…"></a>1. å®‰è£…</h3><pre class=" language-shell"><code class="language-shell">sudo rpm -ivh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm# æŸ¥çœ‹sudo yum repolist | grep nginxsudo yum -y install nginx##### å¦‚æœæ˜¯ centos 8ï¼Œ  å¯ä»¥ç›´æ¥å®‰è£…ï¼ï¼ï¼sudo yum install nginx</code></pre><h3 id="2-é…ç½®"><a href="#2-é…ç½®" class="headerlink" title="2. é…ç½®"></a>2. é…ç½®</h3><p>è®¾ç½®å¼€æœºè‡ªå¯åŠ¨ã€å¯åŠ¨ nginx</p><pre class=" language-shell"><code class="language-shell"># å¼€æœºè‡ªå¯åŠ¨sudo systemctl enable nginx# å¯åŠ¨æœåŠ¡sudo systemctl start nginx# é‡å¯æœåŠ¡sudo systemctl reload nginx# åœæ­¢æœåŠ¡sudo systemctl stop nginx</code></pre><h2 id="PostgreSQL-12"><a href="#PostgreSQL-12" class="headerlink" title="PostgreSQL 12"></a>PostgreSQL 12</h2><p><a href="https://www.postgresql.org/download/linux/redhat/" target="_blank" rel="noopener">https://www.postgresql.org/download/linux/redhat/</a></p><h3 id="1-å®‰è£…-pg12-rpm"><a href="#1-å®‰è£…-pg12-rpm" class="headerlink" title="1. å®‰è£… pg12 rpm"></a>1. å®‰è£… pg12 rpm</h3><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„ç‰ˆæœ¬æ¥ç¡®å®š rpm æº</p><p>æˆ‘å®‰è£…æ—¶ï¼Œceotos ç‰ˆæœ¬æ˜¯ 7-x86_64 çš„</p><pre class=" language-bash"><code class="language-bash">yum <span class="token function">install</span> https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm</code></pre><h3 id="2-å®‰è£…å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯"><a href="#2-å®‰è£…å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯" class="headerlink" title="2. å®‰è£…å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯"></a>2. å®‰è£…å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯</h3><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># client</span>yum <span class="token function">install</span> postgresql12<span class="token comment" spellcheck="true"># æœåŠ¡ç«¯</span>yum <span class="token function">install</span> postgresql12-server</code></pre><h3 id="é…ç½®å¼€æœºè‡ªå¯åŠ¨ç­‰æ“ä½œ-Optional"><a href="#é…ç½®å¼€æœºè‡ªå¯åŠ¨ç­‰æ“ä½œ-Optional" class="headerlink" title="é…ç½®å¼€æœºè‡ªå¯åŠ¨ç­‰æ“ä½œ(Optional)"></a>é…ç½®å¼€æœºè‡ªå¯åŠ¨ç­‰æ“ä½œ(Optional)</h3><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># åˆå§‹åŒ– pgdb</span>/usr/pgsql-12/bin/postgresql-12-setup initdb<span class="token comment" spellcheck="true"># è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</span>systemctl <span class="token function">enable</span> postgresql-12<span class="token comment" spellcheck="true"># å¼€å¯ pgdb</span>systemctl start postgresql-12</code></pre><h3 id="åˆå§‹è´¦å·å¯†ç åŠä¿®æ”¹"><a href="#åˆå§‹è´¦å·å¯†ç åŠä¿®æ”¹" class="headerlink" title="åˆå§‹è´¦å·å¯†ç åŠä¿®æ”¹"></a>åˆå§‹è´¦å·å¯†ç åŠä¿®æ”¹</h3><p>postgres/postgres</p><p>ä¿®æ”¹é…ç½®å‰ä¼šé‡åˆ°çš„é—®é¢˜åŠè§£ç­”</p><ul><li><a href="https://serverfault.com/questions/406606/postgres-error-message-fatal-ident-authentication-failed-for-user" target="_blank" rel="noopener">https://serverfault.com/questions/406606/postgres-error-message-fatal-ident-authentication-failed-for-user</a></li><li><a href="https://stackoverflow.com/questions/2942485/psql-fatal-ident-authentication-failed-for-user-postgres" target="_blank" rel="noopener">https://stackoverflow.com/questions/2942485/psql-fatal-ident-authentication-failed-for-user-postgres</a></li></ul><p>å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®å®Œæˆï¼š</p><p>vim /var/lib/pgsql/12/data/pg_hba.conf</p><pre><code># TYPE  DATABASE        USER            ADDRESS                 METHOD# "local" is for Unix domain socket connections onlylocal   all             all                                     peer# IPv4 local connections:# old line -- dylan#host    all             all             127.0.0.1/32            ident# new line -- dylanhost    all             all             127.0.0.1/32            trusthost    all             all             all                     md5# IPv6 local connections:# old line -- dylan# host    all             all             ::1/128                 ident# Allow replication connections from localhost, by a user with the# replication privilege.# old lines -- dylan#local   replication     all                                     peer#host    replication     all             127.0.0.1/32            ident#host    replication     all             ::1/128                 ident# new lines -- dylanhost    replication     all             127.0.0.1/32            trusthost    replication     all             all                     md5</code></pre><p>vim /var/lib/pgsql/12/data/postgresql.conf</p><pre><code># - Connection Settings -# -- new line start -- dylanlisten_addresses = '*'# -- new line end -- dylan#listen_addresses = 'localhost'         # what IP address(es) to listen on;</code></pre><h3 id="è¿œç¨‹è¿æ¥"><a href="#è¿œç¨‹è¿æ¥" class="headerlink" title="è¿œç¨‹è¿æ¥"></a>è¿œç¨‹è¿æ¥</h3><p>é€šè¿‡å®‰è£… pgAdmin4 è¿æ¥</p><h2 id="Java-Install"><a href="#Java-Install" class="headerlink" title="Java Install"></a>Java Install</h2><h3 id="Java-8"><a href="#Java-8" class="headerlink" title="Java 8"></a>Java 8</h3><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å®‰è£…å java &amp; javac éƒ½èƒ½æ­£å¸¸ä½¿ç”¨</span><span class="token function">sudo</span> yum <span class="token function">install</span> -y java-1.8.0-openjdk-devel.x86_64<span class="token comment" spellcheck="true"># å®‰è£…ååªæœ‰ java èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œ javac æ— ç”¨</span><span class="token function">sudo</span> yum <span class="token function">install</span> -y java-1.8.0-openjdk.x86_64</code></pre><h3 id="Java-11"><a href="#Java-11" class="headerlink" title="Java 11"></a>Java 11</h3><p>ç³»ç»Ÿä¸º centOS 8ï¼Œ å…¶ä»–ç³»ç»ŸæœªéªŒè¯(å¦‚æœå¤±è´¥ï¼Œå¯ä»¥é€šè¿‡æºç å®‰è£…ï¼Œé…ç½®ç¯å¢ƒå˜é‡)</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> dnf <span class="token function">install</span> java-11-openjdk-devel</code></pre><h2 id="Redis-å®‰è£…"><a href="#Redis-å®‰è£…" class="headerlink" title="Redis å®‰è£…"></a>Redis å®‰è£…</h2><p>åœ¨ centOS 8 ä¸‹ï¼Œ å¯ç›´æ¥ä½¿ç”¨ï¼š</p><pre class=" language-shell"><code class="language-shell">sudo dnf install redis</code></pre><p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æºç å®‰è£…ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨ <code>5.0.8</code> ç‰ˆæœ¬</p><pre class=" language-shell"><code class="language-shell">git clone https://github.com/antirez/redis.git --branch 5.0.8</code></pre><p>ä¸‹è½½å®Œæˆåï¼Œè¿›å…¥ç›®å½•ï¼Œæ‰§è¡Œ <code>make &amp;&amp; make test</code> </p><p>ä¹‹åå¯èƒ½ä¼šé‡åˆ°</p><blockquote><p>You need tcl 8.5 or newer in order to run the Redis test</p></blockquote><p>æˆ‘ä»¬å¯ä»¥å» centos å®˜ç½‘ï¼Œä¸‹è½½éœ€è¦çš„ä¾èµ–</p><pre class=" language-shell"><code class="language-shell">sudo dnf install http://mirror.centos.org/centos-8/8.1.1911/BaseOS/x86_64/os/Packages/tcl-8.6.8-2.el8.x86_64.rpm</code></pre><p>å®‰è£…å®Œæˆåå†è·‘ä¸€æ¬¡ <code>make test</code> ï¼Œok ï¼Œå®Œç¾</p><h2 id="Golang-Install"><a href="#Golang-Install" class="headerlink" title="Golang Install"></a>Golang Install</h2><h3 id="Golang-å®˜æ–¹å®‰è£…æ–‡æ¡£"><a href="#Golang-å®˜æ–¹å®‰è£…æ–‡æ¡£" class="headerlink" title="Golang å®˜æ–¹å®‰è£…æ–‡æ¡£"></a><a href="https://golang.google.cn/doc/install?download=go1.13.9.linux-amd64.tar.gz" target="_blank" rel="noopener">Golang å®˜æ–¹å®‰è£…æ–‡æ¡£</a></h3><p>å¦‚æœæœ‰è€ç‰ˆæœ¬ï¼Œå‚è€ƒ  <a href="https://golang.google.cn/doc/install?download=go1.13.9.linux-amd64.tar.gz#uninstall" target="_blank" rel="noopener">remove old golang</a> å…ˆåˆ é™¤æ‰</p><h3 id="Glang-1-13-Install"><a href="#Glang-1-13-Install" class="headerlink" title="Glang 1.13 Install"></a>Glang 1.13 Install</h3><pre class=" language-shell"><code class="language-shell"># 1. ä¸‹è½½curl -o https://dl.google.com/go/go1.13.9.linux-amd64.tar.gz# è§£å‹sudo tar -C /usr/local go1.13.9.linux-amd64.tar.gz# path## 1. åœ¨ .bash_profile ä¸­æœ€åä½ç½®æ·»åŠ   export PATH=$PATH:/usr/local/go/bin (é’ˆå¯¹å½“å‰ç”¨æˆ·)## 2. ä¿å­˜åæ‰§è¡Œ source ~/.bash_profile## 3. å¦‚æœä½¿ç”¨çš„æ˜¯ zsh ï¼Œ éœ€è¦åœ¨ ~/.zshrc ä¸­é…ç½®  source ~/.bash_profile## æˆ–è€…ç›´æ¥åœ¨ /etc/profile ä¸­é…ç½®ï¼Œ åœ¨æœ€æœ«å°¾çš„ä½ç½®è¿½åŠ  export PATH=$PATH:/usr/local/go/bin å³å¯(é’ˆå¯¹æ‰€æœ‰ç”¨æˆ·)</code></pre><h3 id="Golang-1-12-Install"><a href="#Golang-1-12-Install" class="headerlink" title="Golang 1.12 Install"></a>Golang 1.12 Install</h3><p>å¦‚æœä½ åªæƒ³å®‰è£… 1.12 (ç›®å‰ yum æºè¿˜æ²¡æœ‰ 1.13)ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ yum å®‰è£…</p><p><code>sudo yum -y install golang</code></p><h2 id="VIM"><a href="#VIM" class="headerlink" title="VIM"></a>VIM</h2><p>ç”¨ vim æœ‰ä¸€ä¸¤å¹´çš„å†å²ï¼Œè™½ç„¶ç°åœ¨åªä¼šä¸€äº›å¸¸ç”¨çš„å‘½ä»¤ï¼Œå„ç§éªšæ“ä½œåŸºæœ¬ä¸ä¼šï¼Œä½†åœ¨ Terminal ç«¯æ“ä½œæ—¶ï¼Œè¿˜æ˜¯èƒ½å¸¦æ¥ä¸å°‘çš„ä¾¿åˆ©ã€‚</p><p>å¸¸ç”¨çš„ vim plugin ç®¡ç†å·¥å…·ï¼Œæœ‰ vundle å’Œ vim-plug</p><h3 id="0-å¸è½½ä½ çš„-vim-ç®¡ç†å·¥å…·"><a href="#0-å¸è½½ä½ çš„-vim-ç®¡ç†å·¥å…·" class="headerlink" title="0. å¸è½½ä½ çš„ vim ç®¡ç†å·¥å…·"></a>0. å¸è½½ä½ çš„ vim ç®¡ç†å·¥å…·</h3><pre class=" language-bash"><code class="language-bash"><span class="token function">rm</span> -rf ~/.vim<span class="token comment" spellcheck="true"># åœ¨æ­¤ä¹‹å‰ï¼Œ ä½ å¯èƒ½éœ€è¦å…ˆå¤‡ä»½ä½ çš„ .vimrc æ–‡ä»¶,å¦‚ cp .vimrm vimrm</span><span class="token function">rm</span> .vimrc</code></pre><h3 id="1-é€šè¿‡-vundle-ç®¡ç†-vim-plugin"><a href="#1-é€šè¿‡-vundle-ç®¡ç†-vim-plugin" class="headerlink" title="1. é€šè¿‡ vundle ç®¡ç† vim plugin"></a>1. é€šè¿‡ vundle ç®¡ç† vim plugin</h3><ul><li>é€šè¿‡ <a href="https://github.com/VundleVim/Vundle.vim" target="_blank" rel="noopener">Vundle GitHub</a> ä¸­çš„æ­¥éª¤å®‰è£…</li><li>å¦‚æœæ²¡æœ‰ <code>.vimrc</code> ï¼Œç›´æ¥åˆ›å»ºå³å¯ã€‚</li><li>åœ¨ <code>call vundle#begin()</code> å’Œ <code>call vundle#end()</code> ä¹‹é—´æ·»åŠ ä½ éœ€è¦çš„ vim plugin</li><li>åœ¨æœ€åæ·»åŠ å„ç§æ’ä»¶çš„é…ç½®</li><li>ä¸€ä¸ªç¤ºä¾‹ï¼š <a href="https://gitee.com/dylan0011/codes/uoe5cm1s2j4nxkvtydh9814" target="_blank" rel="noopener">vundle example</a></li></ul><h3 id="2-é€šè¿‡-vim-plug-ç®¡ç†-vim-plugin"><a href="#2-é€šè¿‡-vim-plug-ç®¡ç†-vim-plugin" class="headerlink" title="2. é€šè¿‡ vim-plug ç®¡ç† vim plugin"></a>2. é€šè¿‡ vim-plug ç®¡ç† vim plugin</h3><p>å¯å‚è€ƒæ–‡ç«  <a href="https://vimjc.com/vim-plug.html" target="_blank" rel="noopener">vim-plug</a></p><ul><li><p>é€šè¿‡ <a href="https://github.com/junegunn/vim-plug" target="_blank" rel="noopener">Vim-plug Github</a> ä¸­çš„æ­¥éª¤å®‰è£…</p></li><li><p>ä¸€ä¸ªç¤ºä¾‹ï¼š <a href="https://gitee.com/dylan0011/codes/2owi5379ep6zymrcsj08q46" target="_blank" rel="noopener">vim-plug example</a></p></li></ul><h3 id="4-vim-è®¾ç½®å¿«æ·é”®æ—¶å€™çš„å‘"><a href="#4-vim-è®¾ç½®å¿«æ·é”®æ—¶å€™çš„å‘" class="headerlink" title="4. vim è®¾ç½®å¿«æ·é”®æ—¶å€™çš„å‘"></a>4. vim è®¾ç½®å¿«æ·é”®æ—¶å€™çš„å‘</h3><h4 id="1-è®¾ç½®å¿«æ·é”®çš„æ—¶å€™ï¼Œ-æ¯”å¦‚è®¾ç½®ä¸º-A-m-å³-Alt-m-é”®ï¼Œå¯ä¸€ç›´ä¸èµ·ä½œç”¨ï¼ï¼ï¼é‚æ”¾å¼ƒ-Alt-ã€‚"><a href="#1-è®¾ç½®å¿«æ·é”®çš„æ—¶å€™ï¼Œ-æ¯”å¦‚è®¾ç½®ä¸º-A-m-å³-Alt-m-é”®ï¼Œå¯ä¸€ç›´ä¸èµ·ä½œç”¨ï¼ï¼ï¼é‚æ”¾å¼ƒ-Alt-ã€‚" class="headerlink" title="1. è®¾ç½®å¿«æ·é”®çš„æ—¶å€™ï¼Œ æ¯”å¦‚è®¾ç½®ä¸º A-m , å³ Alt + m é”®ï¼Œå¯ä¸€ç›´ä¸èµ·ä½œç”¨ï¼ï¼ï¼é‚æ”¾å¼ƒ Alt ã€‚"></a>1. è®¾ç½®å¿«æ·é”®çš„æ—¶å€™ï¼Œ æ¯”å¦‚è®¾ç½®ä¸º <em>A-m</em> , å³ Alt + m é”®ï¼Œå¯ä¸€ç›´ä¸èµ·ä½œç”¨ï¼ï¼ï¼é‚æ”¾å¼ƒ Alt ã€‚</h4><p><a href="https://vi.stackexchange.com/questions/2350/how-to-map-alt-key" target="_blank" rel="noopener">è¿™é‡Œ</a> å‘Šè¯‰ä½ ä¸ºä»€ä¹ˆ</p><p>å„ç§ Shift/Ctrl/Alt å¯¹åº”å¦‚ä¸‹ï¼š</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401100954.png-growing" alt="vim keymap"></p><h4 id="2-YCM-éœ€è¦-cmake"><a href="#2-YCM-éœ€è¦-cmake" class="headerlink" title="2. YCM éœ€è¦ cmake"></a>2. YCM éœ€è¦ cmake</h4><p><a href="https://github.com/ycm-core/YouCompleteMe#installation" target="_blank" rel="noopener">YCM å®˜æ–¹å®‰è£…æŒ‡å—</a></p><p><a href="https://linux4one.com/how-to-install-cmake-on-centos-8/" target="_blank" rel="noopener">cmake å®‰è£…æŒ‡å—</a></p><p>æˆ‘æ˜¯ centos 8ï¼Œ é€šè¿‡ <code>yum info cmake</code> çœ‹åˆ° cmake ç‰ˆæœ¬æ˜¯ 3.11.4 ï¼Œ æ‰€ä»¥ç›´æ¥é€šè¿‡ yum å®‰è£…äº†ã€‚ åŒæ—¶è¦ä¿è¯å·²ç»å®‰è£…äº† gcc ( <code>sudo dnfinstall -y gcc-c++</code> )</p><h4 id="3-tagbar"><a href="#3-tagbar" class="headerlink" title="3. tagbar"></a>3. tagbar</h4><p>å®‰è£…ä¹‹å‰ï¼Œè¦å…ˆå®‰è£… ctagsï¼š <code>sudo yum install -y ctags</code> </p><h2 id="å°è„šæœ¬"><a href="#å°è„šæœ¬" class="headerlink" title="å°è„šæœ¬"></a>å°è„šæœ¬</h2><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#!/usr/bin/env bash</span><span class="token keyword">set</span> -eo pipefailcommand<span class="token operator">=</span><span class="token variable">$1</span>param1<span class="token operator">=</span><span class="token variable">$2</span><span class="token keyword">function</span> git_install<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    yum -y update \     <span class="token operator">&amp;&amp;</span> yum -y <span class="token function">install</span> <span class="token function">git</span><span class="token punctuation">}</span><span class="token keyword">function</span> zsh_install<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    git_install    yum -y <span class="token function">install</span> zsh<span class="token punctuation">}</span><span class="token keyword">function</span> oh_my_zsh_install<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    zsh_install   sh -c <span class="token string">"<span class="token variable"><span class="token variable">$(</span>curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh<span class="token variable">)</span></span>"</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true"># install powerline if necessary</span><span class="token keyword">function</span> powerline_install<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">git</span> clone https://github.com/powerline/fonts.git --depth<span class="token operator">=</span>1 \   <span class="token operator">&amp;&amp;</span> <span class="token function">cd</span> fonts \   <span class="token operator">&amp;&amp;</span> ./install.sh \   <span class="token operator">&amp;&amp;</span> <span class="token function">cd</span> <span class="token punctuation">..</span> \   <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> -fr ./fonts<span class="token punctuation">}</span><span class="token comment" spellcheck="true"># add user</span><span class="token keyword">function</span> add_user<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -z <span class="token variable">${param1}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>       param1<span class="token operator">=</span><span class="token string">"dylan"</span>    <span class="token keyword">fi</span>    adduser <span class="token variable">${param1}</span>    <span class="token function">passwd</span> <span class="token variable">${param1}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">## generate ssh</span><span class="token keyword">function</span> generate_ssh<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    ssh-keygen -t rsa -C <span class="token string">"peifeng"</span>    <span class="token function">touch</span> <span class="token variable">$HOME</span>/.ssh/config<span class="token punctuation">}</span><span class="token keyword">function</span> docker_install<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>yum remove -y docker docker-common docker-selinux docker-engine \<span class="token operator">&amp;&amp;</span> yum <span class="token function">install</span> -y yum-utils device-mapper-persistent-data lvm2 \<span class="token operator">&amp;&amp;</span> yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo \<span class="token operator">&amp;&amp;</span> yum makecache fast \<span class="token operator">&amp;&amp;</span> yum -y <span class="token function">install</span> docker-ce<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -z <span class="token variable">${param1}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>    param1<span class="token operator">=</span><span class="token string">"https://docker.mirrors.ustc.edu.cn"</span><span class="token keyword">fi</span><span class="token function">cat</span> <span class="token operator">></span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;</span><span class="token string">EOF{  "registry-mirrors": ["<span class="token variable">${param1}</span>"]  "exec-opts": ["native.cgroupdriver=systemd"],  "log-driver": "json-file",  "log-opts": {    "max-size": "100m"  },  "storage-driver": "overlay2",  "storage-opts": [    "overlay2.override_kernel_check=true"  ]}EOF</span>systemctl start dockersystemctl <span class="token function">enable</span> docker<span class="token punctuation">}</span><span class="token keyword">function</span> add_user_to_docker_group<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    gpasswd -a <span class="token variable">${USER}</span> docker    newgrp docker<span class="token punctuation">}</span><span class="token keyword">function</span> java_install<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   yum <span class="token function">install</span> -y java-1.8.0-openjdk-devel.x86_64<span class="token punctuation">}</span><span class="token keyword">function</span> maven_install<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">wget</span> http://mirrors.tuna.tsinghua.edu.cn/apache/maven/maven-3/3.6.1/binaries/apache-maven-3.6.1-bin.tar.gz    <span class="token function">tar</span> -zxvf apache-maven-3.6.1-bin.tar.gz    <span class="token function">sudo</span> <span class="token function">mv</span> ./apache-maven-3.6.1 /usr/share/    <span class="token keyword">echo</span> <span class="token string">"export PATH=<span class="token variable">$PATH</span>:/usr/share/apache-maven-3.6.1/bin"</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> -a /etc/profile    <span class="token function">source</span> /etc/profile    mvn --version<span class="token punctuation">}</span><span class="token keyword">function</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    usage<span class="token operator">=</span><span class="token string">"Usage: <span class="token variable">$0</span> (all|zsh|docker|java|maven)"</span>    <span class="token keyword">echo</span> <span class="token variable">${usage}</span>    <span class="token keyword">case</span> <span class="token variable">${command}</span> <span class="token keyword">in</span>    all<span class="token punctuation">)</span>         oh_my_zsh_install         powerline_install         generate_ssh         add_user         docker_install         add_user_to_docker_group         java_install    <span class="token punctuation">;</span><span class="token punctuation">;</span>    zsh<span class="token punctuation">)</span>        oh_my_zsh_install    <span class="token punctuation">;</span><span class="token punctuation">;</span>    docker<span class="token punctuation">)</span>        docker_install    <span class="token punctuation">;</span><span class="token punctuation">;</span>    java<span class="token punctuation">)</span>        java_install    <span class="token punctuation">;</span><span class="token punctuation">;</span>    maven<span class="token punctuation">)</span>        maven_install     <span class="token punctuation">;</span><span class="token punctuation">;</span>    *<span class="token punctuation">)</span>        <span class="token keyword">echo</span> <span class="token string">"unsupported command yet"</span>        <span class="token keyword">exit</span> 0    <span class="token punctuation">;</span><span class="token punctuation">;</span>    esac<span class="token punctuation">}</span>main</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVA æ’æŸ¥å§¿åŠ¿ç®€ä»‹</title>
      <link href="/tools/greys/"/>
      <url>/tools/greys/</url>
      
        <content type="html"><![CDATA[<h1 id="java-æ’æŸ¥å§¿åŠ¿ç®€ä»‹"><a href="#java-æ’æŸ¥å§¿åŠ¿ç®€ä»‹" class="headerlink" title="java æ’æŸ¥å§¿åŠ¿ç®€ä»‹"></a>java æ’æŸ¥å§¿åŠ¿ç®€ä»‹</h1><h2 id="Greys-anatomy"><a href="#Greys-anatomy" class="headerlink" title="Greys-anatomy"></a>Greys-anatomy</h2><p><a href="https://github.com/oldmanpushcart/greys-anatomy" target="_blank" rel="noopener">greys-anatomy</a> æ˜¯ä¸€æ¬¾å¾ˆä¼˜ç§€çš„ java è¯Šæ–­å·¥å…·ï¼Œ ç”±é˜¿é‡Œçš„ä¸€ä½å·¥ç¨‹å¸ˆå¼€å‘ç»´æŠ¤ï¼Œå¹¶å¼€æºåˆ° github ä¸Šã€‚</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>github ä¸Šçš„æ–‡æ¡£è¯´æ˜çš„å¾ˆè¯¦ç»†äº†ï¼Œ è€Œä¸”æ˜¯ä¸­æ–‡æ–‡æ¡£ï¼Œ é˜…è¯»åŸºæœ¬æ— éšœç¢ã€‚linux ç¯å¢ƒï¼Œ é€šè¿‡</p><pre class=" language-bash"><code class="language-bash">curl -sLk http://ompc.oss.aliyuncs.com/greys/install.sh<span class="token operator">|</span>sh</code></pre><p>æˆ–è€…çŸ­é“¾æ¥</p><pre class=" language-bash"><code class="language-bash">curl -sLk http://t.cn/R2QbHFc<span class="token operator">|</span>sh</code></pre><p>å®‰è£…å³å¯</p><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><ol><li>åœ¨ linux ç¯å¢ƒä¸‹ï¼Œ é¦–å…ˆéœ€è¦è®¾ç½® <code>JAVA_HOME</code>  è·¯å¾„ï¼Œä¸è¿‡ä¸€èˆ¬éƒ½è®¾ç½®è¿‡ã€‚ä¿®æ”¹ /etc/profile æ–‡ä»¶ï¼Œ æˆ–è€…ä¿®æ”¹ .bashrc æ–‡ä»¶ï¼Œ å½“ç„¶ï¼Œ æˆ‘ä»¬å¯èƒ½æ²¡æœ‰æƒé™ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡ export JAVA_HOME=/xxx æ¥ä¸´æ—¶è®¾ç½®è¯¥å˜é‡</li><li>é€šè¿‡ <code>jps</code> å‘½ä»¤æ¥æŸ¥æ‰¾éœ€è¦è¯Šæ–­çš„ java ç¨‹åºå¯¹åº”çš„ pid</li><li>é€šè¿‡ <code>./greys pid</code> æ¥è¿è¡Œæ ¼é›·åŒ»ç”Ÿ</li><li>å¥½äº†ï¼Œ è‡³æ­¤ï¼Œ ä½ å°±èƒ½é€šè¿‡æä¾›çš„ <a href="https://github.com/oldmanpushcart/greys-anatomy/wiki/greys-pdf" target="_blank" rel="noopener">æ–‡æ¡£</a> ï¼Œ æ¥æŸ¥æ‰¾å®šä½ä½ çš„ java é—®é¢˜äº†ã€‚</li></ol><h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><h4 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h4><p>è¯¥å‘½ä»¤èƒ½ç›‘æ§æŒ‡å®šæ–¹æ³•çš„å…¥å‚ï¼Œå‡ºå‚æ•°æ®</p><blockquote><p>watch -b com.xxx.xxx.xxx helloWorld â€˜â€œparams[0]=â€+params[0]â€™;<br>watch -s com.xxx.xxx.xxx helloWorld returnObj -x 3;</p></blockquote><h4 id="trace"><a href="#trace" class="headerlink" title="trace"></a>trace</h4><p>è¯¥å‘½ä»¤èƒ½è¿½è¸ªä¸€çº§æ–¹æ³•çš„è°ƒç”¨é“¾è·¯ï¼Œ åŒæ—¶æ‰“å°å‡ºå¯¹åº”æ–¹æ³•çš„è€—æ—¶ï¼Œ å¯ä»¥ç”¨æ¥åšæ€§èƒ½åˆ†æ</p><blockquote><p>trace com.xxx.xxx.xxx helloWorld</p></blockquote><h4 id="ptrace"><a href="#ptrace" class="headerlink" title="ptrace"></a>ptrace</h4><p>æ˜¯ <code>trace</code> å‘½ä»¤çš„å¢å¼ºç‰ˆï¼Œ å…·ä½“è¯·å‚è§ <a href="https://github.com/oldmanpushcart/greys-anatomy/wiki/greys-pdf#ptrace%E5%91%BD%E4%BB%A4" target="_blank" rel="noopener">github</a></p><h4 id="tt"><a href="#tt" class="headerlink" title="tt"></a>tt</h4><p>TimeTunnel æ—¶é—´éš§é“ã€‚ è¯¥å‘½ä»¤å¾ˆå¼ºå¤§ï¼Œ èƒ½è®°å½•æŒ‡å®šæ–¹æ³•çš„æ‰€æœ‰å…¥å‚ï¼Œå‡ºå‚å’ŒæŠ›å‡ºçš„å¼‚å¸¸ã€‚</p><p>é€šè¿‡ <code>-i index</code> å¯ä»¥æŸ¥çœ‹å…·ä½“ index çš„è¯¦ç»†ä¿¡æ¯</p><p>é€šè¿‡ <code>-i index -p</code> æ¥è‡ªä¸»å‘èµ·è°ƒç”¨</p><p>å…·ä½“è¯·å‚è§ <a href="https://github.com/oldmanpushcart/greys-anatomy/wiki/greys-pdf#tt%E5%91%BD%E4%BB%A4" target="_blank" rel="noopener">github</a></p><h4 id="others"><a href="#others" class="headerlink" title="others"></a>others</h4><ul><li>stack</li><li>sc</li><li>sm</li><li>monitor</li><li>reset</li><li>â€¦..</li></ul><h2 id="Arthas"><a href="#Arthas" class="headerlink" title="Arthas"></a>Arthas</h2><p>é“¾æ¥ <a href="https://github.com/alibaba/arthas" target="_blank" rel="noopener">https://github.com/alibaba/arthas</a></p><h2 id="çº¿ä¸Š-debug"><a href="#çº¿ä¸Š-debug" class="headerlink" title="çº¿ä¸Š debug"></a>çº¿ä¸Š debug</h2><p>æˆ‘æœ¬åœ°è·‘çš„å¥½å¥½çš„ï¼Œ æ€ä¹ˆåˆ°äº†çº¿ä¸Šå°±å‡ºäº†å„ç§é—®é¢˜äº†ï¼Ÿï¼Ÿï¼Ÿ</p><p>è«æ…Œï¼Œ è¿œç¨‹ debug æ¥åŠ©ä½ æ‰¾åˆ°å…ƒå‡¶ã€‚</p><p>è¿™é‡Œé€‰æ‹© <code>IDEA</code> ç¼–è¯‘å™¨æ¥æ¼”ç¤ºï¼Œ <code>Eclips</code> å¯è‡ªè¡Œ Google ä½¿ç”¨åŠæ³•ã€‚</p><h3 id="çº¿ä¸Š-java-æœåŠ¡é…ç½®"><a href="#çº¿ä¸Š-java-æœåŠ¡é…ç½®" class="headerlink" title="çº¿ä¸Š java æœåŠ¡é…ç½®"></a>çº¿ä¸Š java æœåŠ¡é…ç½®</h3><p>åœ¨ java ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œ æ·»åŠ å¦‚ä¸‹å¯åŠ¨å‚æ•°(è¯¥é…ç½®åªé’ˆå¯¹ jdk5-8 çš„ç‰ˆæœ¬)</p><blockquote><p><code>-agentlib:jdwp=transport=dt_socket,server=y,address=8888,suspend=n</code>  </p></blockquote><ul><li>jdwp: java debug wire protocol è‡ªå®šä¹‰çš„ä¸€å¥—è¿œç¨‹ debug åè®®</li><li>transport=dt_socket é€šè¿‡ socket ä¼ è¾“</li><li>server=y  server ç«¯ç›‘å¬å°†è¦è¿æ¥çš„ debug clientï¼Œå¦åˆ™ï¼Œå°†è¿æ¥åˆ°ç‰¹å®šåœ°å€ä¸Šçš„ debug clientã€‚</li><li>suspend=n  å‘ŠçŸ¥ jvm ç«‹å³æ‰§è¡Œï¼Œ æ— éœ€ç­‰å¾… debug client è¿æ¥(è®¾ç½®ä¸º y æ—¶ï¼Œ ä¼šç­‰å¾…é“¾æ¥)</li><li>address=8888  debug è°ƒè¯•ç«¯å£(æœ‰æ—¶è¿æ¥ä¸ä¸Šï¼Œ å¯èƒ½æœåŠ¡ç«¯æ‰€åœ¨å®¿ä¸»æœºçš„ç«¯å£æ²¡å¼€)</li></ul><p>å¯¹äºåŒºåˆ†ä¸åŒç¯å¢ƒçš„å¯åŠ¨è„šæœ¬è€Œè¨€ï¼Œ åªéœ€è¦å®šä¹‰ JAVA_OPTS å˜é‡ï¼Œ åœ¨å¼€å‘ç¯å¢ƒ(ä¸€èˆ¬æµ‹è¯•å’Œç”Ÿäº§ä¸å¯éšæ„æ·»åŠ è¿™ç§å¯åŠ¨å‚æ•°)å¯åŠ¨æ—¶ï¼Œ åŠ ä¸Šè¯¥å˜é‡å³å¯ã€‚<br>åŒæ—¶è¦æ³¨æ„ï¼Œé…ç½®çš„ç«¯å£å·ï¼Œserver ç«¯æ˜¯å¦æœ‰å¼€æ”¾ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œserver ç«¯çš„ç«¯å£éƒ½æ˜¯æœ‰é™å¼€æ”¾ã€‚æ‰€ä»¥é…ç½®å‰è¦ç¡®è®¤ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚</p><h3 id="IDEA-é…ç½®"><a href="#IDEA-é…ç½®" class="headerlink" title="IDEA é…ç½®"></a>IDEA é…ç½®</h3><p>åœ¨ idea ä¸Šæ‰¾åˆ° edit configurations</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401091235.png-growing" alt="idea configurations"></p><p>åœ¨å·¦ä¾§èœå•æ‰¾åˆ° remote é€‰é¡¹ï¼Œå¡«å†™ç›¸å…³å†…å®¹(host ä¸º server ç«¯ hostï¼Œ port ä¸ºä¸Šæ–‡ä¸­ address å¯¹åº”çš„ç«¯å£å€¼)</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401091320.png-growing" alt="remote debug configuration"></p><p>é…ç½®å®Œæ¯•ï¼Œ å¯åŠ¨æœåŠ¡ï¼Œå³å¯æ„‰å¿«çš„å¼€å§‹ remote debug äº†ã€‚</p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹ï¼Œå¦‚æœæœ‰å¤šçº¿ç¨‹ç¨‹åºéœ€è¦è°ƒè¯•ï¼Œ ä½ éœ€è¦æŠŠæ–­ç‚¹ç±»å‹è®¾ç½®ä¸º Threadã€‚</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://img.iyuhp.top/blog/20200401091429.png-growing" alt="Thread"></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools </tag>
            
            <tag> java </tag>
            
            <tag> è¿ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
